cscope 15 $HOME/os20s_lab/xv6-ssu/xv6_ssu_master               0000182215
	@asm.h

5 
	#SEG_NULLASM
 \

6 .
w‹d
 0, 0; \

7 .
byã
 0, 0, 0, 0

	)

11 
	#SEG_ASM
(
ty≥
,
ba£
,
lim
) \

12 .
	`w‹d
 (((
lim
Ë>> 12Ë& 0xffff), ((
ba£
) & 0xffff); \

13 .
	`byã
 (((
ba£
Ë>> 16Ë& 0xff), (0x90 | (
ty≥
)), \

14 (0xC0 | (((
lim
Ë>> 28Ë& 0xf)), (((
ba£
Ë>> 24Ë& 0xff)

	)

16 
	#STA_X
 0x8

17 
	#STA_W
 0x2

18 
	#STA_R
 0x2

	@bio.c

21 
	~"ty≥s.h
"

22 
	~"defs.h
"

23 
	~"∑øm.h
"

24 
	~"•ölock.h
"

25 
	~"¶ì∂ock.h
"

26 
	~"fs.h
"

27 
	~"buf.h
"

30 
•ölock
 
	mlock
;

31 
buf
 
	mbuf
[
NBUF
];

35 
buf
 
	mhód
;

36 } 
	gbˇche
;

39 
	$böô
()

41 
buf
 *
b
;

43 
	`öôlock
(&
bˇche
.
lock
, "bcache");

47 
bˇche
.
hód
.
¥ev
 = &bcache.head;

48 
bˇche
.
hód
.
√xt
 = &bcache.head;

49 
b
 = 
bˇche
.
buf
; b < bˇche.buf+
NBUF
; b++){

50 
b
->
√xt
 = 
bˇche
.
hód
.next;

51 
b
->
¥ev
 = &
bˇche
.
hód
;

52 
	`öô¶ì∂ock
(&
b
->
lock
, "buffer");

53 
bˇche
.
hód
.
√xt
->
¥ev
 = 
b
;

54 
bˇche
.
hód
.
√xt
 = 
b
;

56 
	}
}

61 
buf
*

62 
	$bgë
(
uöt
 
dev
, uöà
blockno
)

64 
buf
 *
b
;

66 
	`acquúe
(&
bˇche
.
lock
);

69 
b
 = 
bˇche
.
hód
.
√xt
; b != &bcache.head; b = b->next){

70 if(
b
->
dev
 =dev && b->
blockno
 == blockno){

71 
b
->
ªf˙t
++;

72 
	`ªÀa£
(&
bˇche
.
lock
);

73 
	`acquúe¶ìp
(&
b
->
lock
);

74  
b
;

81 
b
 = 
bˇche
.
hód
.
¥ev
; b != &bcache.head; b = b->prev){

82 if(
b
->
ªf˙t
 =0 && (b->
Êags
 & 
B_DIRTY
) == 0) {

83 
b
->
dev
 = dev;

84 
b
->
blockno
 = blockno;

85 
b
->
Êags
 = 0;

86 
b
->
ªf˙t
 = 1;

87 
	`ªÀa£
(&
bˇche
.
lock
);

88 
	`acquúe¶ìp
(&
b
->
lock
);

89  
b
;

92 
	`∑nic
("bget:Ço buffers");

93 
	}
}

96 
buf
*

97 
	$bªad
(
uöt
 
dev
, uöà
blockno
)

99 
buf
 *
b
;

101 
b
 = 
	`bgë
(
dev
, 
blockno
);

102 if((
b
->
Êags
 & 
B_VALID
) == 0) {

103 
	`idîw
(
b
);

105  
b
;

106 
	}
}

110 
	$bwrôe
(
buf
 *
b
)

112 if(!
	`hﬁdög¶ìp
(&
b
->
lock
))

113 
	`∑nic
("bwrite");

114 
b
->
Êags
 |
B_DIRTY
;

115 
	`idîw
(
b
);

116 
	}
}

121 
	$bªl£
(
buf
 *
b
)

123 if(!
	`hﬁdög¶ìp
(&
b
->
lock
))

124 
	`∑nic
("brelse");

126 
	`ªÀa£¶ìp
(&
b
->
lock
);

128 
	`acquúe
(&
bˇche
.
lock
);

129 
b
->
ªf˙t
--;

130 i‡(
b
->
ªf˙t
 == 0) {

132 
b
->
√xt
->
¥ev
 = b->prev;

133 
b
->
¥ev
->
√xt
 = b->next;

134 
b
->
√xt
 = 
bˇche
.
hód
.next;

135 
b
->
¥ev
 = &
bˇche
.
hód
;

136 
bˇche
.
hód
.
√xt
->
¥ev
 = 
b
;

137 
bˇche
.
hód
.
√xt
 = 
b
;

140 
	`ªÀa£
(&
bˇche
.
lock
);

141 
	}
}

	@bootmain.c

8 
	~"ty≥s.h
"

9 
	~"ñf.h
"

10 
	~"x86.h
"

11 
	~"memœyout.h
"

13 
	#SECTSIZE
 512

	)

15 
ªad£g
(
uch¨
*, 
uöt
, uint);

18 
	$boŸmaö
()

20 
ñfhdr
 *
ñf
;

21 
¥oghdr
 *
ph
, *
ïh
;

22 (*
íåy
)();

23 
uch¨
* 
∑
;

25 
ñf
 = (
ñfhdr
*)0x10000;

28 
	`ªad£g
((
uch¨
*)
ñf
, 4096, 0);

31 if(
ñf
->
magic
 !
ELF_MAGIC
)

35 
ph
 = (
¥oghdr
*)((
uch¨
*)
ñf
 +Élf->
phoff
);

36 
ïh
 = 
ph
 + 
ñf
->
phnum
;

37 ; 
ph
 < 
ïh
;Öh++){

38 
∑
 = (
uch¨
*)
ph
->
∑ddr
;

39 
	`ªad£g
(
∑
, 
ph
->
fûesz
,Öh->
off
);

40 if(
ph
->
memsz
 >Öh->
fûesz
)

41 
	`°osb
(
∑
 + 
ph
->
fûesz
, 0,Öh->
memsz
 -Öh->filesz);

46 
íåy
 = ((*)())(
ñf
->entry);

47 
	`íåy
();

48 
	}
}

51 
	$waôdisk
()

54 (
	`öb
(0x1F7) & 0xC0) != 0x40)

56 
	}
}

60 
	$ªad£˘
(*
d°
, 
uöt
 
off£t
)

63 
	`waôdisk
();

64 
	`outb
(0x1F2, 1);

65 
	`outb
(0x1F3, 
off£t
);

66 
	`outb
(0x1F4, 
off£t
 >> 8);

67 
	`outb
(0x1F5, 
off£t
 >> 16);

68 
	`outb
(0x1F6, (
off£t
 >> 24) | 0xE0);

69 
	`outb
(0x1F7, 0x20);

72 
	`waôdisk
();

73 
	`ö¶
(0x1F0, 
d°
, 
SECTSIZE
/4);

74 
	}
}

79 
	$ªad£g
(
uch¨
* 
∑
, 
uöt
 
cou¡
, uöà
off£t
)

81 
uch¨
* 
ïa
;

83 
ïa
 = 
∑
 + 
cou¡
;

86 
∑
 -
off£t
 % 
SECTSIZE
;

89 
off£t
 = (off£à/ 
SECTSIZE
) + 1;

94 ; 
∑
 < 
ïa
;Ö®+
SECTSIZE
, 
off£t
++)

95 
	`ªad£˘
(
∑
, 
off£t
);

96 
	}
}

	@buf.h

1 
	sbuf
 {

2 
	mÊags
;

3 
uöt
 
	mdev
;

4 
uöt
 
	mblockno
;

5 
¶ì∂ock
 
	mlock
;

6 
uöt
 
	mªf˙t
;

7 
buf
 *
	m¥ev
;

8 
buf
 *
	m√xt
;

9 
buf
 *
	mq√xt
;

10 
uch¨
 
	md©a
[
BSIZE
];

12 
	#B_VALID
 0x2

13 
	#B_DIRTY
 0x4

14 

	)

	@console.c

5 
	~"ty≥s.h
"

6 
	~"defs.h
"

7 
	~"∑øm.h
"

8 
	~"å≠s.h
"

9 
	~"•ölock.h
"

10 
	~"¶ì∂ock.h
"

11 
	~"fs.h
"

12 
	~"fûe.h
"

13 
	~"memœyout.h
"

14 
	~"mmu.h
"

15 
	~"¥oc.h
"

16 
	~"x86.h
"

18 
c⁄•utc
();

20 
	g∑nicked
 = 0;

23 
•ölock
 
	mlock
;

24 
	mlockög
;

25 } 
	gc⁄s
;

28 
	$¥ötöt
(
xx
, 
ba£
, 
sign
)

30 
digôs
[] = "0123456789abcdef";

31 
buf
[16];

32 
i
;

33 
uöt
 
x
;

35 if(
sign
 && (sig¿
xx
 < 0))

36 
x
 = -
xx
;

38 
x
 = 
xx
;

40 
i
 = 0;

42 
buf
[
i
++] = 
digôs
[
x
 % 
ba£
];

43 }(
x
 /
ba£
) != 0);

45 if(
sign
)

46 
buf
[
i
++] = '-';

48 --
i
 >= 0)

49 
	`c⁄•utc
(
buf
[
i
]);

50 
	}
}

55 
	$˝rötf
(*
fmt
, ...)

57 
i
, 
c
, 
lockög
;

58 
uöt
 *
¨gp
;

59 *
s
;

61 
lockög
 = 
c⁄s
.locking;

62 if(
lockög
)

63 
	`acquúe
(&
c⁄s
.
lock
);

65 i‡(
fmt
 == 0)

66 
	`∑nic
("null fmt");

68 
¨gp
 = (
uöt
*)(*)(&
fmt
 + 1);

69 
i
 = 0; (
c
 = 
fmt
[i] & 0xff) != 0; i++){

70 if(
c
 != '%'){

71 
	`c⁄•utc
(
c
);

74 
c
 = 
fmt
[++
i
] & 0xff;

75 if(
c
 == 0)

77 
c
){

79 
	`¥ötöt
(*
¨gp
++, 10, 1);

83 
	`¥ötöt
(*
¨gp
++, 16, 0);

86 if((
s
 = (*)*
¨gp
++) == 0)

87 
s
 = "(null)";

88 ; *
s
; s++)

89 
	`c⁄•utc
(*
s
);

92 
	`c⁄•utc
('%');

96 
	`c⁄•utc
('%');

97 
	`c⁄•utc
(
c
);

102 if(
lockög
)

103 
	`ªÀa£
(&
c⁄s
.
lock
);

104 
	}
}

107 
	$∑nic
(*
s
)

109 
i
;

110 
uöt
 
pcs
[10];

112 
	`˛i
();

113 
c⁄s
.
lockög
 = 0;

115 
	`˝rötf
("œpicid %d:Ö™ic: ", 
	`œpicid
());

116 
	`˝rötf
(
s
);

117 
	`˝rötf
("\n");

118 
	`gëˇŒîpcs
(&
s
, 
pcs
);

119 
i
=0; i<10; i++)

120 
	`˝rötf
(" %p", 
pcs
[
i
]);

121 
∑nicked
 = 1;

124 
	}
}

127 
	#BACKSPACE
 0x100

	)

128 
	#CRTPORT
 0x3d4

	)

129 
ush‹t
 *
	g¸t
 = (ush‹t*)
P2V
(0xb8000);

132 
	$cg≠utc
(
c
)

134 
pos
;

137 
	`outb
(
CRTPORT
, 14);

138 
pos
 = 
	`öb
(
CRTPORT
+1) << 8;

139 
	`outb
(
CRTPORT
, 15);

140 
pos
 |
	`öb
(
CRTPORT
+1);

142 if(
c
 == '\n')

143 
pos
 += 80 -Öos%80;

144 if(
c
 =
BACKSPACE
){

145 if(
pos
 > 0) --pos;

147 
¸t
[
pos
++] = (
c
&0xff) | 0x0700;

149 if(
pos
 < 0 ||Öos > 25*80)

150 
	`∑nic
("pos under/overflow");

152 if((
pos
/80) >= 24){

153 
	`memmove
(
¸t
, crt+80, (crt[0])*23*80);

154 
pos
 -= 80;

155 
	`mem£t
(
¸t
+
pos
, 0, (crt[0])*(24*80 -Öos));

158 
	`outb
(
CRTPORT
, 14);

159 
	`outb
(
CRTPORT
+1, 
pos
>>8);

160 
	`outb
(
CRTPORT
, 15);

161 
	`outb
(
CRTPORT
+1, 
pos
);

162 
¸t
[
pos
] = ' ' | 0x0700;

163 
	}
}

166 
	$c⁄•utc
(
c
)

168 if(
∑nicked
){

169 
	`˛i
();

174 if(
c
 =
BACKSPACE
){

175 
	`u¨çutc
('\b'); uartputc(' '); uartputc('\b');

177 
	`u¨çutc
(
c
);

178 
	`cg≠utc
(
c
);

179 
	}
}

181 
	#INPUT_BUF
 128

	)

183 
	mbuf
[
INPUT_BUF
];

184 
uöt
 
	mr
;

185 
uöt
 
	mw
;

186 
uöt
 
	me
;

187 } 
	göput
;

189 
	#C
(
x
) ((x)-'@')

190 

	)

192 
	$c⁄sﬁeöå
((*
gëc
)())

194 
c
, 
d›rocdump
 = 0;

196 
	`acquúe
(&
c⁄s
.
lock
);

197 (
c
 = 
	`gëc
()) >= 0){

198 
c
){

199 
	`C
('P'):

201 
d›rocdump
 = 1;

203 
	`C
('U'):

204 
öput
.
e
 !öput.
w
 &&

205 
öput
.
buf
[(öput.
e
-1Ë% 
INPUT_BUF
] != '\n'){

206 
öput
.
e
--;

207 
	`c⁄•utc
(
BACKSPACE
);

210 
	`C
('H'): '\x7f':

211 if(
öput
.
e
 !öput.
w
){

212 
öput
.
e
--;

213 
	`c⁄•utc
(
BACKSPACE
);

217 if(
c
 !0 && 
öput
.
e
-öput.
r
 < 
INPUT_BUF
){

218 
c
 = (c == '\r') ? '\n' : c;

219 
öput
.
buf
[öput.
e
++ % 
INPUT_BUF
] = 
c
;

220 
	`c⁄•utc
(
c
);

221 if(
c
 ='\n' || c =
	`C
('D'Ë|| 
öput
.
e
 =öput.
r
+
INPUT_BUF
){

222 
öput
.
w
 = i≈ut.
e
;

223 
	`wakeup
(&
öput
.
r
);

229 
	`ªÀa£
(&
c⁄s
.
lock
);

230 if(
d›rocdump
) {

231 
	`¥ocdump
();

233 
	}
}

236 
	$c⁄sﬁîód
(
öode
 *
ù
, *
d°
, 
n
)

238 
uöt
 
èrgë
;

239 
c
;

241 
	`iu∆ock
(
ù
);

242 
èrgë
 = 
n
;

243 
	`acquúe
(&
c⁄s
.
lock
);

244 
n
 > 0){

245 
öput
.
r
 =öput.
w
){

246 if(
	`my¥oc
()->
kûÀd
){

247 
	`ªÀa£
(&
c⁄s
.
lock
);

248 
	`ûock
(
ù
);

251 
	`¶ìp
(&
öput
.
r
, &
c⁄s
.
lock
);

253 
c
 = 
öput
.
buf
[öput.
r
++ % 
INPUT_BUF
];

254 if(
c
 =
	`C
('D')){

255 if(
n
 < 
èrgë
){

258 
öput
.
r
--;

262 *
d°
++ = 
c
;

263 --
n
;

264 if(
c
 == '\n')

267 
	`ªÀa£
(&
c⁄s
.
lock
);

268 
	`ûock
(
ù
);

270  
èrgë
 - 
n
;

271 
	}
}

274 
	$c⁄sﬁewrôe
(
öode
 *
ù
, *
buf
, 
n
)

276 
i
;

278 
	`iu∆ock
(
ù
);

279 
	`acquúe
(&
c⁄s
.
lock
);

280 
i
 = 0; i < 
n
; i++)

281 
	`c⁄•utc
(
buf
[
i
] & 0xff);

282 
	`ªÀa£
(&
c⁄s
.
lock
);

283 
	`ûock
(
ù
);

285  
n
;

286 
	}
}

289 
	$c⁄sﬁeöô
()

291 
	`öôlock
(&
c⁄s
.
lock
, "console");

293 
devsw
[
CONSOLE
].
wrôe
 = 
c⁄sﬁewrôe
;

294 
devsw
[
CONSOLE
].
ªad
 = 
c⁄sﬁîód
;

295 
c⁄s
.
lockög
 = 1;

297 
	`iﬂpi˚«bÀ
(
IRQ_KBD
, 0);

298 
	}
}

	@date.h

1 
	sπcd©e
 {

2 
uöt
 
	m£c⁄d
;

3 
uöt
 
	mmöuã
;

4 
uöt
 
	mhour
;

5 
uöt
 
	mday
;

6 
uöt
 
	mm⁄th
;

7 
uöt
 
	myór
;

	@defs.h

1 
	gbuf
;

2 
	gc⁄ãxt
;

3 
	gfûe
;

4 
	göode
;

5 
	gpùe
;

6 
	g¥oc
;

7 
	gπcd©e
;

8 
	g•ölock
;

9 
	g¶ì∂ock
;

10 
	g°©
;

11 
	gsu≥rblock
;

14 
böô
();

15 
buf
* 
bªad
(
uöt
, uint);

16 
bªl£
(
buf
*);

17 
bwrôe
(
buf
*);

20 
c⁄sﬁeöô
();

21 
˝rötf
(*, ...);

22 
c⁄sﬁeöå
((*)());

23 
	$∑nic
(*Ë
	`__©åibuã__
((
n‹ëu∫
));

26 
	`exec
(*, **);

29 
fûe
* 
	`fûóŒoc
();

30 
	`fûe˛o£
(
fûe
*);

31 
fûe
* 
	`fûedup
(file*);

32 
	`fûeöô
();

33 
	`fûîód
(
fûe
*, *, 
n
);

34 
	`fûe°©
(
fûe
*, 
°©
*);

35 
	`fûewrôe
(
fûe
*, *, 
n
);

38 
	`ªadsb
(
dev
, 
su≥rblock
 *
sb
);

39 
	`dúlök
(
öode
*, *, 
uöt
);

40 
öode
* 
	`dúlookup
(öode*, *, 
uöt
*);

41 
öode
* 
	`üŒoc
(
uöt
, );

42 
öode
* 
	`idup
(inode*);

43 
	`iöô
(
dev
);

44 
	`ûock
(
öode
*);

45 
	`ùut
(
öode
*);

46 
	`iu∆ock
(
öode
*);

47 
	`iu∆ockput
(
öode
*);

48 
	`iupd©e
(
öode
*);

49 
	`«mecmp
(const *, const *);

50 
öode
* 
	`«mei
(*);

51 
öode
* 
	`«meù¨ít
(*, *);

52 
	`ªadi
(
öode
*, *, 
uöt
, uint);

53 
	`°©i
(
öode
*, 
°©
*);

54 
	`wrôei
(
öode
*, *, 
uöt
, uint);

57 
	`ideöô
();

58 
	`ideöå
();

59 
	`idîw
(
buf
*);

62 
	`iﬂpi˚«bÀ
(
úq
, 
˝u
);

63 
uch¨
 
iﬂpicid
;

64 
	`iﬂpicöô
();

67 * 
	`kÆloc
();

68 
	`k‰ì
(*);

69 
	`köô1
(*, *);

70 
	`köô2
(*, *);

73 
	`kbdöå
();

76 
	`cmo°ime
(
πcd©e
 *
r
);

77 
	`œpicid
();

78 vﬁ©ûê
uöt
* 
œpic
;

79 
	`œpi˚oi
();

80 
	`œpicöô
();

81 
	`œpic°¨èp
(
uch¨
, 
uöt
);

82 
	`mi¸odñay
();

85 
	`öôlog
(
dev
);

86 
	`log_wrôe
(
buf
*);

87 
	`begö_›
();

88 
	`íd_›
();

91 
ismp
;

92 
	`mpöô
();

95 
	`pi˚«bÀ
();

96 
	`picöô
();

99 
	`pùóŒoc
(
fûe
**, file**);

100 
	`pùe˛o£
(
pùe
*, );

101 
	`pùîód
(
pùe
*, *, );

102 
	`pùewrôe
(
pùe
*, *, );

106 
	`˝uid
();

107 
	`exô
();

108 
	`f‹k
();

109 
	`grow¥oc
();

110 
	`kûl
();

111 
˝u
* 
	`my˝u
();

112 
¥oc
* 
	`my¥oc
();

113 
	`pöô
();

114 
	`¥ocdump
();

115 
	$scheduÀr
(Ë
	`__©åibuã__
((
n‹ëu∫
));

116 
	`sched
();

117 
	`£çroc
(
¥oc
*);

118 
	`¶ìp
(*, 
•ölock
*);

119 
	`u£röô
();

120 
	`waô
();

121 
	`wakeup
(*);

122 
	`yõld
();

125 
	`swtch
(
c⁄ãxt
**, context*);

128 
	`acquúe
(
•ölock
*);

129 
	`gëˇŒîpcs
(*, 
uöt
*);

130 
	`hﬁdög
(
•ölock
*);

131 
	`öôlock
(
•ölock
*, *);

132 
	`ªÀa£
(
•ölock
*);

133 
	`push˛i
();

134 
	`p›˛i
();

137 
	`acquúe¶ìp
(
¶ì∂ock
*);

138 
	`ªÀa£¶ìp
(
¶ì∂ock
*);

139 
	`hﬁdög¶ìp
(
¶ì∂ock
*);

140 
	`öô¶ì∂ock
(
¶ì∂ock
*, *);

143 
	`memcmp
(c⁄° *, c⁄° *, 
uöt
);

144 * 
	`memmove
(*, c⁄° *, 
uöt
);

145 * 
	`mem£t
(*, , 
uöt
);

146 * 
	`ß„°r˝y
(*, const *, );

147 
	`°æí
(const *);

148 
	`°∫cmp
(c⁄° *, c⁄° *, 
uöt
);

149 * 
	`°∫˝y
(*, const *, );

152 
	`¨göt
(, *);

153 
	`¨g±r
(, **, );

154 
	`¨g°r
(, **);

155 
	`„tchöt
(
uöt
, *);

156 
	`„tch°r
(
uöt
, **);

157 
	`sysˇŒ
();

160 
	`timîöô
();

163 
	`idtöô
();

164 
uöt
 
ticks
;

165 
	`tvöô
();

166 
•ölock
 
tick¶ock
;

169 
	`u¨töô
();

170 
	`u¨töå
();

171 
	`u¨çutc
();

174 
	`£göô
();

175 
	`kvmÆloc
();

176 
pde_t
* 
	`£tupkvm
();

177 * 
	`uva2ka
(
pde_t
*, *);

178 
	`Ælocuvm
(
pde_t
*, 
uöt
, uint);

179 
	`dóŒocuvm
(
pde_t
*, 
uöt
, uint);

180 
	`‰ìvm
(
pde_t
*);

181 
	`öôuvm
(
pde_t
*, *, 
uöt
);

182 
	`lﬂduvm
(
pde_t
*, *, 
öode
*, 
uöt
, uint);

183 
pde_t
* 
	`c›yuvm
’de_t*, 
uöt
);

184 
	`swôchuvm
(
¥oc
*);

185 
	`swôchkvm
();

186 
	`c›yout
(
pde_t
*, 
uöt
, *, uint);

187 
	`˛óΩãu
(
pde_t
 *
pgdú
, *
uva
);

190 
	#NELEM
(
x
Ë((x)/((x)[0]))

	)

	@elf.h

3 
	#ELF_MAGIC
 0x464C457FU

4 

	)

6 
	sñfhdr
 {

7 
uöt
 
	mmagic
;

8 
uch¨
 
	mñf
[12];

9 
ush‹t
 
	mty≥
;

10 
ush‹t
 
	mmachöe
;

11 
uöt
 
	mvîsi⁄
;

12 
uöt
 
	míåy
;

13 
uöt
 
	mphoff
;

14 
uöt
 
	mshoff
;

15 
uöt
 
	mÊags
;

16 
ush‹t
 
	mehsize
;

17 
ush‹t
 
	mphítsize
;

18 
ush‹t
 
	mphnum
;

19 
ush‹t
 
	mshítsize
;

20 
ush‹t
 
	mshnum
;

21 
ush‹t
 
	msh°∫dx
;

25 
	s¥oghdr
 {

26 
uöt
 
	mty≥
;

27 
uöt
 
	moff
;

28 
uöt
 
	mvaddr
;

29 
uöt
 
	m∑ddr
;

30 
uöt
 
	mfûesz
;

31 
uöt
 
	mmemsz
;

32 
uöt
 
	mÊags
;

33 
uöt
 
	mÆign
;

37 
	#ELF_PROG_LOAD
 1

	)

40 
	#ELF_PROG_FLAG_EXEC
 1

	)

41 
	#ELF_PROG_FLAG_WRITE
 2

	)

42 
	#ELF_PROG_FLAG_READ
 4

	)

	@exec.c

1 
	~"ty≥s.h
"

2 
	~"∑øm.h
"

3 
	~"memœyout.h
"

4 
	~"mmu.h
"

5 
	~"¥oc.h
"

6 
	~"defs.h
"

7 
	~"x86.h
"

8 
	~"ñf.h
"

11 
	$exec
(*
∑th
, **
¨gv
)

13 *
s
, *
œ°
;

14 
i
, 
off
;

15 
uöt
 
¨gc
, 
sz
, 
•
, 
u°ack
[3+
MAXARG
+1];

16 
ñfhdr
 
ñf
;

17 
öode
 *
ù
;

18 
¥oghdr
 
ph
;

19 
pde_t
 *
pgdú
, *
ﬁdpgdú
;

20 
¥oc
 *
cuΩroc
 = 
	`my¥oc
();

22 
	`begö_›
();

24 if((
ù
 = 
	`«mei
(
∑th
)) == 0){

25 
	`íd_›
();

26 
	`˝rötf
("exec: fail\n");

29 
	`ûock
(
ù
);

30 
pgdú
 = 0;

33 if(
	`ªadi
(
ù
, (*)&
ñf
, 0, (elf)) != (elf))

34 
bad
;

35 if(
ñf
.
magic
 !
ELF_MAGIC
)

36 
bad
;

38 if((
pgdú
 = 
	`£tupkvm
()) == 0)

39 
bad
;

42 
sz
 = 0;

43 
i
=0, 
off
=
ñf
.
phoff
; i<ñf.
phnum
; i++, off+=(
ph
)){

44 if(
	`ªadi
(
ù
, (*)&
ph
, 
off
, (ph)) != (ph))

45 
bad
;

46 if(
ph
.
ty≥
 !
ELF_PROG_LOAD
)

48 if(
ph
.
memsz
 <Öh.
fûesz
)

49 
bad
;

50 if(
ph
.
vaddr
 +Öh.
memsz
 <Öh.vaddr)

51 
bad
;

52 if((
sz
 = 
	`Ælocuvm
(
pgdú
, sz, 
ph
.
vaddr
 +Öh.
memsz
)) == 0)

53 
bad
;

54 if(
ph
.
vaddr
 % 
PGSIZE
 != 0)

55 
bad
;

56 if(
	`lﬂduvm
(
pgdú
, (*)
ph
.
vaddr
, 
ù
,Öh.
off
,Öh.
fûesz
) < 0)

57 
bad
;

59 
	`iu∆ockput
(
ù
);

60 
	`íd_›
();

61 
ù
 = 0;

65 
sz
 = 
	`PGROUNDUP
(sz);

66 if((
sz
 = 
	`Ælocuvm
(
pgdú
, sz, sz + 2*
PGSIZE
)) == 0)

67 
bad
;

68 
	`˛óΩãu
(
pgdú
, (*)(
sz
 - 2*
PGSIZE
));

69 
•
 = 
sz
;

72 
¨gc
 = 0; 
¨gv
[argc];árgc++) {

73 if(
¨gc
 >
MAXARG
)

74 
bad
;

75 
•
 = (• - (
	`°æí
(
¨gv
[
¨gc
]) + 1)) & ~3;

76 if(
	`c›yout
(
pgdú
, 
•
, 
¨gv
[
¨gc
], 
	`°æí
(argv[argc]) + 1) < 0)

77 
bad
;

78 
u°ack
[3+
¨gc
] = 
•
;

80 
u°ack
[3+
¨gc
] = 0;

82 
u°ack
[0] = 0xffffffff;

83 
u°ack
[1] = 
¨gc
;

84 
u°ack
[2] = 
•
 - (
¨gc
+1)*4;

86 
•
 -(3+
¨gc
+1) * 4;

87 if(
	`c›yout
(
pgdú
, 
•
, 
u°ack
, (3+
¨gc
+1)*4) < 0)

88 
bad
;

91 
œ°
=
s
=
∑th
; *s; s++)

92 if(*
s
 == '/')

93 
œ°
 = 
s
+1;

94 
	`ß„°r˝y
(
cuΩroc
->
«me
, 
œ°
, (curproc->name));

97 
ﬁdpgdú
 = 
cuΩroc
->
pgdú
;

98 
cuΩroc
->
pgdú
 =Ögdir;

99 
cuΩroc
->
sz
 = sz;

100 
cuΩroc
->
tf
->
eù
 = 
ñf
.
íåy
;

101 
cuΩroc
->
tf
->
e•
 = 
•
;

102 
	`swôchuvm
(
cuΩroc
);

103 
	`‰ìvm
(
ﬁdpgdú
);

106 
bad
:

107 if(
pgdú
)

108 
	`‰ìvm
(
pgdú
);

109 if(
ù
){

110 
	`iu∆ockput
(
ù
);

111 
	`íd_›
();

114 
	}
}

	@fcntl.h

1 
	#O_RDONLY
 0x000

	)

2 
	#O_WRONLY
 0x001

	)

3 
	#O_RDWR
 0x002

	)

4 
	#O_CREATE
 0x200

	)

	@file.c

5 
	~"ty≥s.h
"

6 
	~"defs.h
"

7 
	~"∑øm.h
"

8 
	~"fs.h
"

9 
	~"•ölock.h
"

10 
	~"¶ì∂ock.h
"

11 
	~"fûe.h
"

13 
devsw
 
	gdevsw
[
NDEV
];

15 
•ölock
 
	mlock
;

16 
fûe
 
	mfûe
[
NFILE
];

17 } 
	g·abÀ
;

20 
	$fûeöô
()

22 
	`öôlock
(&
·abÀ
.
lock
, "ftable");

23 
	}
}

26 
fûe
*

27 
	$fûóŒoc
()

29 
fûe
 *
f
;

31 
	`acquúe
(&
·abÀ
.
lock
);

32 
f
 = 
·abÀ
.
fûe
; f < fèbÀ.fûê+ 
NFILE
; f++){

33 if(
f
->
ªf
 == 0){

34 
f
->
ªf
 = 1;

35 
	`ªÀa£
(&
·abÀ
.
lock
);

36  
f
;

39 
	`ªÀa£
(&
·abÀ
.
lock
);

41 
	}
}

44 
fûe
*

45 
	$fûedup
(
fûe
 *
f
)

47 
	`acquúe
(&
·abÀ
.
lock
);

48 if(
f
->
ªf
 < 1)

49 
	`∑nic
("filedup");

50 
f
->
ªf
++;

51 
	`ªÀa£
(&
·abÀ
.
lock
);

52  
f
;

53 
	}
}

57 
	$fûe˛o£
(
fûe
 *
f
)

59 
fûe
 
ff
;

61 
	`acquúe
(&
·abÀ
.
lock
);

62 if(
f
->
ªf
 < 1)

63 
	`∑nic
("fileclose");

64 if(--
f
->
ªf
 > 0){

65 
	`ªÀa£
(&
·abÀ
.
lock
);

68 
ff
 = *
f
;

69 
f
->
ªf
 = 0;

70 
f
->
ty≥
 = 
FD_NONE
;

71 
	`ªÀa£
(&
·abÀ
.
lock
);

73 if(
ff
.
ty≥
 =
FD_PIPE
)

74 
	`pùe˛o£
(
ff
.
pùe
, ff.
wrôabÀ
);

75 if(
ff
.
ty≥
 =
FD_INODE
){

76 
	`begö_›
();

77 
	`ùut
(
ff
.
ù
);

78 
	`íd_›
();

80 
	}
}

84 
	$fûe°©
(
fûe
 *
f
, 
°©
 *
°
)

86 if(
f
->
ty≥
 =
FD_INODE
){

87 
	`ûock
(
f
->
ù
);

88 
	`°©i
(
f
->
ù
, 
°
);

89 
	`iu∆ock
(
f
->
ù
);

93 
	}
}

97 
	$fûîód
(
fûe
 *
f
, *
addr
, 
n
)

99 
r
;

101 if(
f
->
ªadabÀ
 == 0)

103 if(
f
->
ty≥
 =
FD_PIPE
)

104  
	`pùîód
(
f
->
pùe
, 
addr
, 
n
);

105 if(
f
->
ty≥
 =
FD_INODE
){

106 
	`ûock
(
f
->
ù
);

107 if((
r
 = 
	`ªadi
(
f
->
ù
, 
addr
, f->
off
, 
n
)) > 0)

108 
f
->
off
 +
r
;

109 
	`iu∆ock
(
f
->
ù
);

110  
r
;

112 
	`∑nic
("fileread");

113 
	}
}

118 
	$fûewrôe
(
fûe
 *
f
, *
addr
, 
n
)

120 
r
;

122 if(
f
->
wrôabÀ
 == 0)

124 if(
f
->
ty≥
 =
FD_PIPE
)

125  
	`pùewrôe
(
f
->
pùe
, 
addr
, 
n
);

126 if(
f
->
ty≥
 =
FD_INODE
){

133 
max
 = ((
MAXOPBLOCKS
-1-1-2) / 2) * 512;

134 
i
 = 0;

135 
i
 < 
n
){

136 
n1
 = 
n
 - 
i
;

137 if(
n1
 > 
max
)

138 
n1
 = 
max
;

140 
	`begö_›
();

141 
	`ûock
(
f
->
ù
);

142 i‡((
r
 = 
	`wrôei
(
f
->
ù
, 
addr
 + 
i
, f->
off
, 
n1
)) > 0)

143 
f
->
off
 +
r
;

144 
	`iu∆ock
(
f
->
ù
);

145 
	`íd_›
();

147 if(
r
 < 0)

149 if(
r
 !
n1
)

150 
	`∑nic
("short filewrite");

151 
i
 +
r
;

153  
i
 =
n
 ?Ç : -1;

155 
	`∑nic
("filewrite");

156 
	}
}

	@file.h

1 
	sfûe
 {

2 íum { 
	mFD_NONE
, 
	mFD_PIPE
, 
	mFD_INODE
 } 
	mty≥
;

3 
	mªf
;

4 
	mªadabÀ
;

5 
	mwrôabÀ
;

6 
pùe
 *
	mpùe
;

7 
öode
 *
	mù
;

8 
uöt
 
	moff
;

13 
	söode
 {

14 
uöt
 
	mdev
;

15 
uöt
 
	möum
;

16 
	mªf
;

17 
¶ì∂ock
 
	mlock
;

18 
	mvÆid
;

20 
	mty≥
;

21 
	mmaj‹
;

22 
	mmö‹
;

23 
	m∆ök
;

24 
uöt
 
	msize
;

25 
uöt
 
	maddrs
[
NDIRECT
+1];

30 
	sdevsw
 {

31 (*
	mªad
)(
	möode
*, *, );

32 (*
	mwrôe
)(
	möode
*, *, );

35 
devsw
 devsw[];

37 
	#CONSOLE
 1

	)

	@fs.c

12 
	~"ty≥s.h
"

13 
	~"defs.h
"

14 
	~"∑øm.h
"

15 
	~"°©.h
"

16 
	~"mmu.h
"

17 
	~"¥oc.h
"

18 
	~"•ölock.h
"

19 
	~"¶ì∂ock.h
"

20 
	~"fs.h
"

21 
	~"buf.h
"

22 
	~"fûe.h
"

24 
	#mö
(
a
, 
b
Ë(◊Ë< (bË? (aË: (b))

	)

25 
ôrunc
(
öode
*);

28 
su≥rblock
 
	gsb
;

32 
	$ªadsb
(
dev
, 
su≥rblock
 *
sb
)

34 
buf
 *
bp
;

36 
bp
 = 
	`bªad
(
dev
, 1);

37 
	`memmove
(
sb
, 
bp
->
d©a
, (*sb));

38 
	`bªl£
(
bp
);

39 
	}
}

43 
	$bzîo
(
dev
, 
bno
)

45 
buf
 *
bp
;

47 
bp
 = 
	`bªad
(
dev
, 
bno
);

48 
	`mem£t
(
bp
->
d©a
, 0, 
BSIZE
);

49 
	`log_wrôe
(
bp
);

50 
	`bªl£
(
bp
);

51 
	}
}

56 
uöt


57 
	$bÆloc
(
uöt
 
dev
)

59 
b
, 
bi
, 
m
;

60 
buf
 *
bp
;

62 
bp
 = 0;

63 
b
 = 0; b < 
sb
.
size
; b +
BPB
){

64 
bp
 = 
	`bªad
(
dev
, 
	`BBLOCK
(
b
, 
sb
));

65 
bi
 = 0; bò< 
BPB
 && 
b
 + bò< 
sb
.
size
; bi++){

66 
m
 = 1 << (
bi
 % 8);

67 if((
bp
->
d©a
[
bi
/8] & 
m
) == 0){

68 
bp
->
d©a
[
bi
/8] |
m
;

69 
	`log_wrôe
(
bp
);

70 
	`bªl£
(
bp
);

71 
	`bzîo
(
dev
, 
b
 + 
bi
);

72  
b
 + 
bi
;

75 
	`bªl£
(
bp
);

77 
	`∑nic
("balloc: out of blocks");

78 
	}
}

82 
	$b‰ì
(
dev
, 
uöt
 
b
)

84 
buf
 *
bp
;

85 
bi
, 
m
;

87 
bp
 = 
	`bªad
(
dev
, 
	`BBLOCK
(
b
, 
sb
));

88 
bi
 = 
b
 % 
BPB
;

89 
m
 = 1 << (
bi
 % 8);

90 if((
bp
->
d©a
[
bi
/8] & 
m
) == 0)

91 
	`∑nic
("freeing free block");

92 
bp
->
d©a
[
bi
/8] &~
m
;

93 
	`log_wrôe
(
bp
);

94 
	`bªl£
(
bp
);

95 
	}
}

167 
•ölock
 
	mlock
;

168 
öode
 
	möode
[
NINODE
];

169 } 
	giˇche
;

172 
	$iöô
(
dev
)

174 
i
 = 0;

176 
	`öôlock
(&
iˇche
.
lock
, "icache");

177 
i
 = 0; i < 
NINODE
; i++) {

178 
	`öô¶ì∂ock
(&
iˇche
.
öode
[
i
].
lock
, "inode");

181 
	`ªadsb
(
dev
, &
sb
);

182 
	`˝rötf
("sb: sizê%dÇblock†%dÇöode†%dÇlog %dÜog°¨à%d\
 %d bm≠ sèπ %d\n", 
sb
.
size
, sb.
nblocks
,

184 
sb
.
nöodes
, sb.
∆og
, sb.
log°¨t
, sb.
öode°¨t
,

185 
sb
.
bm≠°¨t
);

186 
	}
}

188 
öode
* 
igë
(
uöt
 
dev
, uöà
öum
);

194 
öode
*

195 
	$üŒoc
(
uöt
 
dev
, 
ty≥
)

197 
öum
;

198 
buf
 *
bp
;

199 
döode
 *
dù
;

201 
öum
 = 1; inum < 
sb
.
nöodes
; inum++){

202 
bp
 = 
	`bªad
(
dev
, 
	`IBLOCK
(
öum
, 
sb
));

203 
dù
 = (
döode
*)
bp
->
d©a
 + 
öum
%
IPB
;

204 if(
dù
->
ty≥
 == 0){

205 
	`mem£t
(
dù
, 0, (*dip));

206 
dù
->
ty≥
 =Åype;

207 
	`log_wrôe
(
bp
);

208 
	`bªl£
(
bp
);

209  
	`igë
(
dev
, 
öum
);

211 
	`bªl£
(
bp
);

213 
	`∑nic
("ialloc:Ço inodes");

214 
	}
}

221 
	$iupd©e
(
öode
 *
ù
)

223 
buf
 *
bp
;

224 
döode
 *
dù
;

226 
bp
 = 
	`bªad
(
ù
->
dev
, 
	`IBLOCK
(ù->
öum
, 
sb
));

227 
dù
 = (
döode
*)
bp
->
d©a
 + 
ù
->
öum
%
IPB
;

228 
dù
->
ty≥
 = 
ù
->type;

229 
dù
->
maj‹
 = 
ù
->major;

230 
dù
->
mö‹
 = 
ù
->minor;

231 
dù
->
∆ök
 = 
ù
->nlink;

232 
dù
->
size
 = 
ù
->size;

233 
	`memmove
(
dù
->
addrs
, 
ù
->addrs, (ip->addrs));

234 
	`log_wrôe
(
bp
);

235 
	`bªl£
(
bp
);

236 
	}
}

241 
öode
*

242 
	$igë
(
uöt
 
dev
, uöà
öum
)

244 
öode
 *
ù
, *
em±y
;

246 
	`acquúe
(&
iˇche
.
lock
);

249 
em±y
 = 0;

250 
ù
 = &
iˇche
.
öode
[0]; i∞< &iˇche.öode[
NINODE
]; ip++){

251 if(
ù
->
ªf
 > 0 && ip->
dev
 =dev && ip->
öum
 == inum){

252 
ù
->
ªf
++;

253 
	`ªÀa£
(&
iˇche
.
lock
);

254  
ù
;

256 if(
em±y
 =0 && 
ù
->
ªf
 == 0)

257 
em±y
 = 
ù
;

261 if(
em±y
 == 0)

262 
	`∑nic
("iget:Ço inodes");

264 
ù
 = 
em±y
;

265 
ù
->
dev
 = dev;

266 
ù
->
öum
 = inum;

267 
ù
->
ªf
 = 1;

268 
ù
->
vÆid
 = 0;

269 
	`ªÀa£
(&
iˇche
.
lock
);

271  
ù
;

272 
	}
}

276 
öode
*

277 
	$idup
(
öode
 *
ù
)

279 
	`acquúe
(&
iˇche
.
lock
);

280 
ù
->
ªf
++;

281 
	`ªÀa£
(&
iˇche
.
lock
);

282  
ù
;

283 
	}
}

288 
	$ûock
(
öode
 *
ù
)

290 
buf
 *
bp
;

291 
döode
 *
dù
;

293 if(
ù
 =0 || ip->
ªf
 < 1)

294 
	`∑nic
("ilock");

296 
	`acquúe¶ìp
(&
ù
->
lock
);

298 if(
ù
->
vÆid
 == 0){

299 
bp
 = 
	`bªad
(
ù
->
dev
, 
	`IBLOCK
(ù->
öum
, 
sb
));

300 
dù
 = (
döode
*)
bp
->
d©a
 + 
ù
->
öum
%
IPB
;

301 
ù
->
ty≥
 = 
dù
->type;

302 
ù
->
maj‹
 = 
dù
->major;

303 
ù
->
mö‹
 = 
dù
->minor;

304 
ù
->
∆ök
 = 
dù
->nlink;

305 
ù
->
size
 = 
dù
->size;

306 
	`memmove
(
ù
->
addrs
, 
dù
->addrs, (ip->addrs));

307 
	`bªl£
(
bp
);

308 
ù
->
vÆid
 = 1;

309 if(
ù
->
ty≥
 == 0)

310 
	`∑nic
("ilock:ÇoÅype");

312 
	}
}

316 
	$iu∆ock
(
öode
 *
ù
)

318 if(
ù
 =0 || !
	`hﬁdög¶ìp
(&ù->
lock
Ë|| ip->
ªf
 < 1)

319 
	`∑nic
("iunlock");

321 
	`ªÀa£¶ìp
(&
ù
->
lock
);

322 
	}
}

332 
	$ùut
(
öode
 *
ù
)

334 
	`acquúe¶ìp
(&
ù
->
lock
);

335 if(
ù
->
vÆid
 && ip->
∆ök
 == 0){

336 
	`acquúe
(&
iˇche
.
lock
);

337 
r
 = 
ù
->
ªf
;

338 
	`ªÀa£
(&
iˇche
.
lock
);

339 if(
r
 == 1){

341 
	`ôrunc
(
ù
);

342 
ù
->
ty≥
 = 0;

343 
	`iupd©e
(
ù
);

344 
ù
->
vÆid
 = 0;

347 
	`ªÀa£¶ìp
(&
ù
->
lock
);

349 
	`acquúe
(&
iˇche
.
lock
);

350 
ù
->
ªf
--;

351 
	`ªÀa£
(&
iˇche
.
lock
);

352 
	}
}

356 
	$iu∆ockput
(
öode
 *
ù
)

358 
	`iu∆ock
(
ù
);

359 
	`ùut
(
ù
);

360 
	}
}

372 
uöt


373 
	$bm≠
(
öode
 *
ù
, 
uöt
 
bn
)

375 
uöt
 
addr
, *
a
;

376 
buf
 *
bp
;

378 if(
bn
 < 
NDIRECT
){

379 if((
addr
 = 
ù
->
addrs
[
bn
]) == 0)

380 
ù
->
addrs
[
bn
] = 
addr
 = 
	`bÆloc
(ù->
dev
);

381  
addr
;

383 
bn
 -
NDIRECT
;

385 if(
bn
 < 
NINDIRECT
){

387 if((
addr
 = 
ù
->
addrs
[
NDIRECT
]) == 0)

388 
ù
->
addrs
[
NDIRECT
] = 
addr
 = 
	`bÆloc
(ù->
dev
);

389 
bp
 = 
	`bªad
(
ù
->
dev
, 
addr
);

390 
a
 = (
uöt
*)
bp
->
d©a
;

391 if((
addr
 = 
a
[
bn
]) == 0){

392 
a
[
bn
] = 
addr
 = 
	`bÆloc
(
ù
->
dev
);

393 
	`log_wrôe
(
bp
);

395 
	`bªl£
(
bp
);

396  
addr
;

399 
	`∑nic
("bmap: out ofÑange");

400 
	}
}

408 
	$ôrunc
(
öode
 *
ù
)

410 
i
, 
j
;

411 
buf
 *
bp
;

412 
uöt
 *
a
;

414 
i
 = 0; i < 
NDIRECT
; i++){

415 if(
ù
->
addrs
[
i
]){

416 
	`b‰ì
(
ù
->
dev
, ip->
addrs
[
i
]);

417 
ù
->
addrs
[
i
] = 0;

421 if(
ù
->
addrs
[
NDIRECT
]){

422 
bp
 = 
	`bªad
(
ù
->
dev
, ip->
addrs
[
NDIRECT
]);

423 
a
 = (
uöt
*)
bp
->
d©a
;

424 
j
 = 0; j < 
NINDIRECT
; j++){

425 if(
a
[
j
])

426 
	`b‰ì
(
ù
->
dev
, 
a
[
j
]);

428 
	`bªl£
(
bp
);

429 
	`b‰ì
(
ù
->
dev
, ip->
addrs
[
NDIRECT
]);

430 
ù
->
addrs
[
NDIRECT
] = 0;

433 
ù
->
size
 = 0;

434 
	`iupd©e
(
ù
);

435 
	}
}

440 
	$°©i
(
öode
 *
ù
, 
°©
 *
°
)

442 
°
->
dev
 = 
ù
->dev;

443 
°
->
öo
 = 
ù
->
öum
;

444 
°
->
ty≥
 = 
ù
->type;

445 
°
->
∆ök
 = 
ù
->nlink;

446 
°
->
size
 = 
ù
->size;

447 
	}
}

453 
	$ªadi
(
öode
 *
ù
, *
d°
, 
uöt
 
off
, uöà
n
)

455 
uöt
 
tŸ
, 
m
;

456 
buf
 *
bp
;

458 if(
ù
->
ty≥
 =
T_DEV
){

459 if(
ù
->
maj‹
 < 0 || ip->maj‹ >
NDEV
 || !
devsw
[ù->maj‹].
ªad
)

461  
devsw
[
ù
->
maj‹
].
	`ªad
(ù, 
d°
, 
n
);

464 if(
off
 > 
ù
->
size
 || of‡+ 
n
 < off)

466 if(
off
 + 
n
 > 
ù
->
size
)

467 
n
 = 
ù
->
size
 - 
off
;

469 
tŸ
=0;ÅŸ<
n
;ÅŸ+=
m
, 
off
+=m, 
d°
+=m){

470 
bp
 = 
	`bªad
(
ù
->
dev
, 
	`bm≠
(ù, 
off
/
BSIZE
));

471 
m
 = 
	`mö
(
n
 - 
tŸ
, 
BSIZE
 - 
off
%BSIZE);

472 
	`memmove
(
d°
, 
bp
->
d©a
 + 
off
%
BSIZE
, 
m
);

473 
	`bªl£
(
bp
);

475  
n
;

476 
	}
}

482 
	$wrôei
(
öode
 *
ù
, *
§c
, 
uöt
 
off
, uöà
n
)

484 
uöt
 
tŸ
, 
m
;

485 
buf
 *
bp
;

487 if(
ù
->
ty≥
 =
T_DEV
){

488 if(
ù
->
maj‹
 < 0 || ip->maj‹ >
NDEV
 || !
devsw
[ù->maj‹].
wrôe
)

490  
devsw
[
ù
->
maj‹
].
	`wrôe
(ù, 
§c
, 
n
);

493 if(
off
 > 
ù
->
size
 || of‡+ 
n
 < off)

495 if(
off
 + 
n
 > 
MAXFILE
*
BSIZE
)

498 
tŸ
=0;ÅŸ<
n
;ÅŸ+=
m
, 
off
+=m, 
§c
+=m){

499 
bp
 = 
	`bªad
(
ù
->
dev
, 
	`bm≠
(ù, 
off
/
BSIZE
));

500 
m
 = 
	`mö
(
n
 - 
tŸ
, 
BSIZE
 - 
off
%BSIZE);

501 
	`memmove
(
bp
->
d©a
 + 
off
%
BSIZE
, 
§c
, 
m
);

502 
	`log_wrôe
(
bp
);

503 
	`bªl£
(
bp
);

506 if(
n
 > 0 && 
off
 > 
ù
->
size
){

507 
ù
->
size
 = 
off
;

508 
	`iupd©e
(
ù
);

510  
n
;

511 
	}
}

517 
	$«mecmp
(c⁄° *
s
, c⁄° *
t
)

519  
	`°∫cmp
(
s
, 
t
, 
DIRSIZ
);

520 
	}
}

524 
öode
*

525 
	$dúlookup
(
öode
 *
dp
, *
«me
, 
uöt
 *
poff
)

527 
uöt
 
off
, 
öum
;

528 
dúít
 
de
;

530 if(
dp
->
ty≥
 !
T_DIR
)

531 
	`∑nic
("dirlookupÇot DIR");

533 
off
 = 0; of‡< 
dp
->
size
; of‡+(
de
)){

534 if(
	`ªadi
(
dp
, (*)&
de
, 
off
, (de)) != (de))

535 
	`∑nic
("dirlookupÑead");

536 if(
de
.
öum
 == 0)

538 if(
	`«mecmp
(
«me
, 
de
.name) == 0){

540 if(
poff
)

541 *
poff
 = 
off
;

542 
öum
 = 
de
.inum;

543  
	`igë
(
dp
->
dev
, 
öum
);

548 
	}
}

552 
	$dúlök
(
öode
 *
dp
, *
«me
, 
uöt
 
öum
)

554 
off
;

555 
dúít
 
de
;

556 
öode
 *
ù
;

559 if((
ù
 = 
	`dúlookup
(
dp
, 
«me
, 0)) != 0){

560 
	`ùut
(
ù
);

565 
off
 = 0; of‡< 
dp
->
size
; of‡+(
de
)){

566 if(
	`ªadi
(
dp
, (*)&
de
, 
off
, (de)) != (de))

567 
	`∑nic
("dirlinkÑead");

568 if(
de
.
öum
 == 0)

572 
	`°∫˝y
(
de
.
«me
,Çame, 
DIRSIZ
);

573 
de
.
öum
 = inum;

574 if(
	`wrôei
(
dp
, (*)&
de
, 
off
, (de)) != (de))

575 
	`∑nic
("dirlink");

578 
	}
}

596 
	$skùñem
(*
∑th
, *
«me
)

598 *
s
;

599 
Àn
;

601 *
∑th
 == '/')

602 
∑th
++;

603 if(*
∑th
 == 0)

605 
s
 = 
∑th
;

606 *
∑th
 != '/' && *path != 0)

607 
∑th
++;

608 
Àn
 = 
∑th
 - 
s
;

609 if(
Àn
 >
DIRSIZ
)

610 
	`memmove
(
«me
, 
s
, 
DIRSIZ
);

612 
	`memmove
(
«me
, 
s
, 
Àn
);

613 
«me
[
Àn
] = 0;

615 *
∑th
 == '/')

616 
∑th
++;

617  
∑th
;

618 
	}
}

624 
öode
*

625 
	$«mex
(*
∑th
, 
«meù¨ít
, *
«me
)

627 
öode
 *
ù
, *
√xt
;

629 if(*
∑th
 == '/')

630 
ù
 = 
	`igë
(
ROOTDEV
, 
ROOTINO
);

632 
ù
 = 
	`idup
(
	`my¥oc
()->
cwd
);

634 (
∑th
 = 
	`skùñem
’©h, 
«me
)) != 0){

635 
	`ûock
(
ù
);

636 if(
ù
->
ty≥
 !
T_DIR
){

637 
	`iu∆ockput
(
ù
);

640 if(
«meù¨ít
 && *
∑th
 == '\0'){

642 
	`iu∆ock
(
ù
);

643  
ù
;

645 if((
√xt
 = 
	`dúlookup
(
ù
, 
«me
, 0)) == 0){

646 
	`iu∆ockput
(
ù
);

649 
	`iu∆ockput
(
ù
);

650 
ù
 = 
√xt
;

652 if(
«meù¨ít
){

653 
	`ùut
(
ù
);

656  
ù
;

657 
	}
}

659 
öode
*

660 
	$«mei
(*
∑th
)

662 
«me
[
DIRSIZ
];

663  
	`«mex
(
∑th
, 0, 
«me
);

664 
	}
}

666 
öode
*

667 
	$«meù¨ít
(*
∑th
, *
«me
)

669  
	`«mex
(
∑th
, 1, 
«me
);

670 
	}
}

	@fs.h

5 
	#ROOTINO
 1

6 
	#BSIZE
 512

7 

	)

14 
	ssu≥rblock
 {

15 
uöt
 
	msize
;

16 
uöt
 
	mnblocks
;

17 
uöt
 
	mnöodes
;

18 
uöt
 
	m∆og
;

19 
uöt
 
	mlog°¨t
;

20 
uöt
 
	möode°¨t
;

21 
uöt
 
	mbm≠°¨t
;

24 
	#NDIRECT
 12

	)

25 
	#NINDIRECT
 (
BSIZE
 / (
uöt
))

	)

26 
	#MAXFILE
 (
NDIRECT
 + 
NINDIRECT
)

	)

29 
	sdöode
 {

30 
	mty≥
;

31 
	mmaj‹
;

32 
	mmö‹
;

33 
	m∆ök
;

34 
uöt
 
	msize
;

35 
uöt
 
	maddrs
[
NDIRECT
+1];

39 
	#IPB
 (
BSIZE
 / (
döode
))

	)

42 
	#IBLOCK
(
i
, 
sb
Ë((iË/ 
IPB
 + sb.
öode°¨t
)

	)

45 
	#BPB
 (
BSIZE
*8)

	)

48 
	#BBLOCK
(
b
, 
sb
Ë(b/
BPB
 + sb.
bm≠°¨t
)

	)

51 
	#DIRSIZ
 14

	)

53 
	sdúít
 {

54 
ush‹t
 
	möum
;

55 
	m«me
[
DIRSIZ
];

	@ide.c

3 
	~"ty≥s.h
"

4 
	~"defs.h
"

5 
	~"∑øm.h
"

6 
	~"memœyout.h
"

7 
	~"mmu.h
"

8 
	~"¥oc.h
"

9 
	~"x86.h
"

10 
	~"å≠s.h
"

11 
	~"•ölock.h
"

12 
	~"¶ì∂ock.h
"

13 
	~"fs.h
"

14 
	~"buf.h
"

16 
	#SECTOR_SIZE
 512

	)

17 
	#IDE_BSY
 0x80

	)

18 
	#IDE_DRDY
 0x40

	)

19 
	#IDE_DF
 0x20

	)

20 
	#IDE_ERR
 0x01

	)

22 
	#IDE_CMD_READ
 0x20

	)

23 
	#IDE_CMD_WRITE
 0x30

	)

24 
	#IDE_CMD_RDMUL
 0xc4

	)

25 
	#IDE_CMD_WRMUL
 0xc5

	)

31 
•ölock
 
	gidñock
;

32 
buf
 *
	gidequeue
;

34 
	ghavedisk1
;

35 
ide°¨t
(
buf
*);

39 
	$idewaô
(
checkîr
)

41 
r
;

43 ((
r
 = 
	`öb
(0x1f7)Ë& (
IDE_BSY
|
IDE_DRDY
)) != IDE_DRDY)

45 if(
checkîr
 && (
r
 & (
IDE_DF
|
IDE_ERR
)) != 0)

48 
	}
}

51 
	$ideöô
()

53 
i
;

55 
	`öôlock
(&
idñock
, "ide");

56 
	`iﬂpi˚«bÀ
(
IRQ_IDE
, 
n˝u
 - 1);

57 
	`idewaô
(0);

60 
	`outb
(0x1f6, 0xe0 | (1<<4));

61 
i
=0; i<1000; i++){

62 if(
	`öb
(0x1f7) != 0){

63 
havedisk1
 = 1;

69 
	`outb
(0x1f6, 0xe0 | (0<<4));

70 
	}
}

74 
	$ide°¨t
(
buf
 *
b
)

76 if(
b
 == 0)

77 
	`∑nic
("idestart");

78 if(
b
->
blockno
 >
FSSIZE
)

79 
	`∑nic
("incorrect blockno");

80 
£˘‹_≥r_block
 = 
BSIZE
/
SECTOR_SIZE
;

81 
£˘‹
 = 
b
->
blockno
 * 
£˘‹_≥r_block
;

82 
ªad_cmd
 = (
£˘‹_≥r_block
 =1Ë? 
IDE_CMD_READ
 : 
IDE_CMD_RDMUL
;

83 
wrôe_cmd
 = (
£˘‹_≥r_block
 =1Ë? 
IDE_CMD_WRITE
 : 
IDE_CMD_WRMUL
;

85 i‡(
£˘‹_≥r_block
 > 7Ë
	`∑nic
("idestart");

87 
	`idewaô
(0);

88 
	`outb
(0x3f6, 0);

89 
	`outb
(0x1f2, 
£˘‹_≥r_block
);

90 
	`outb
(0x1f3, 
£˘‹
 & 0xff);

91 
	`outb
(0x1f4, (
£˘‹
 >> 8) & 0xff);

92 
	`outb
(0x1f5, (
£˘‹
 >> 16) & 0xff);

93 
	`outb
(0x1f6, 0xe0 | ((
b
->
dev
&1)<<4Ë| ((
£˘‹
>>24)&0x0f));

94 if(
b
->
Êags
 & 
B_DIRTY
){

95 
	`outb
(0x1f7, 
wrôe_cmd
);

96 
	`out¶
(0x1f0, 
b
->
d©a
, 
BSIZE
/4);

98 
	`outb
(0x1f7, 
ªad_cmd
);

100 
	}
}

104 
	$ideöå
()

106 
buf
 *
b
;

109 
	`acquúe
(&
idñock
);

111 if((
b
 = 
idequeue
) == 0){

112 
	`ªÀa£
(&
idñock
);

115 
idequeue
 = 
b
->
q√xt
;

118 if(!(
b
->
Êags
 & 
B_DIRTY
Ë&& 
	`idewaô
(1) >= 0)

119 
	`ö¶
(0x1f0, 
b
->
d©a
, 
BSIZE
/4);

122 
b
->
Êags
 |
B_VALID
;

123 
b
->
Êags
 &~
B_DIRTY
;

124 
	`wakeup
(
b
);

127 if(
idequeue
 != 0)

128 
	`ide°¨t
(
idequeue
);

130 
	`ªÀa£
(&
idñock
);

131 
	}
}

138 
	$idîw
(
buf
 *
b
)

140 
buf
 **
µ
;

142 if(!
	`hﬁdög¶ìp
(&
b
->
lock
))

143 
	`∑nic
("iderw: bufÇotÜocked");

144 if((
b
->
Êags
 & (
B_VALID
|
B_DIRTY
)) == B_VALID)

145 
	`∑nic
("iderw:ÇothingÅo do");

146 if(
b
->
dev
 !0 && !
havedisk1
)

147 
	`∑nic
("iderw: ide disk 1ÇotÖresent");

149 
	`acquúe
(&
idñock
);

152 
b
->
q√xt
 = 0;

153 
µ
=&
idequeue
; *µ;Öp=&(*µ)->
q√xt
)

155 *
µ
 = 
b
;

158 if(
idequeue
 =
b
)

159 
	`ide°¨t
(
b
);

162 (
b
->
Êags
 & (
B_VALID
|
B_DIRTY
)) != B_VALID){

163 
	`¶ìp
(
b
, &
idñock
);

167 
	`ªÀa£
(&
idñock
);

168 
	}
}

	@ioapic.c

5 
	~"ty≥s.h
"

6 
	~"defs.h
"

7 
	~"å≠s.h
"

9 
	#IOAPIC
 0xFEC00000

10 

	)

11 
	#REG_ID
 0x00

12 
	#REG_VER
 0x01

13 
	#REG_TABLE
 0x10

14 

	)

20 
	#INT_DISABLED
 0x00010000

21 
	#INT_LEVEL
 0x00008000

22 
	#INT_ACTIVELOW
 0x00002000

23 
	#INT_LOGICAL
 0x00000800

24 

	)

25 vﬁ©ûê
iﬂpic
 *
	giﬂpic
;

28 
	siﬂpic
 {

29 
uöt
 
	mªg
;

30 
uöt
 
	m∑d
[3];

31 
uöt
 
	md©a
;

34 
uöt


35 
	$iﬂpi¸ód
(
ªg
)

37 
iﬂpic
->
ªg
 =Ñeg;

38  
iﬂpic
->
d©a
;

39 
	}
}

42 
	$iﬂpicwrôe
(
ªg
, 
uöt
 
d©a
)

44 
iﬂpic
->
ªg
 =Ñeg;

45 
iﬂpic
->
d©a
 = data;

46 
	}
}

49 
	$iﬂpicöô
()

51 
i
, 
id
, 
maxöå
;

53 
iﬂpic
 = (vﬁ©ûêiﬂpic*)
IOAPIC
;

54 
maxöå
 = (
	`iﬂpi¸ód
(
REG_VER
) >> 16) & 0xFF;

55 
id
 = 
	`iﬂpi¸ód
(
REG_ID
) >> 24;

56 if(
id
 !
iﬂpicid
)

57 
	`˝rötf
("ioapicinit: id isn'tÉqualÅo ioapicid;Çotá MP\n");

61 
i
 = 0; i <
maxöå
; i++){

62 
	`iﬂpicwrôe
(
REG_TABLE
+2*
i
, 
INT_DISABLED
 | (
T_IRQ0
 + i));

63 
	`iﬂpicwrôe
(
REG_TABLE
+2*
i
+1, 0);

65 
	}
}

68 
	$iﬂpi˚«bÀ
(
úq
, 
˝unum
)

73 
	`iﬂpicwrôe
(
REG_TABLE
+2*
úq
, 
T_IRQ0
 + irq);

74 
	`iﬂpicwrôe
(
REG_TABLE
+2*
úq
+1, 
˝unum
 << 24);

75 
	}
}

	@kalloc.c

5 
	~"ty≥s.h
"

6 
	~"defs.h
"

7 
	~"∑øm.h
"

8 
	~"memœyout.h
"

9 
	~"mmu.h
"

10 
	~"•ölock.h
"

12 
‰ìønge
(*
v°¨t
, *
víd
);

13 
íd
[];

16 
	srun
 {

17 
run
 *
	m√xt
;

21 
•ölock
 
	mlock
;

22 
	mu£_lock
;

23 
run
 *
	m‰ìli°
;

24 } 
	gkmem
;

32 
	$köô1
(*
v°¨t
, *
víd
)

34 
	`öôlock
(&
kmem
.
lock
, "kmem");

35 
kmem
.
u£_lock
 = 0;

36 
	`‰ìønge
(
v°¨t
, 
víd
);

37 
	}
}

40 
	$köô2
(*
v°¨t
, *
víd
)

42 
	`‰ìønge
(
v°¨t
, 
víd
);

43 
kmem
.
u£_lock
 = 1;

44 
	}
}

47 
	$‰ìønge
(*
v°¨t
, *
víd
)

49 *
p
;

50 
p
 = (*)
	`PGROUNDUP
((
uöt
)
v°¨t
);

51 ; 
p
 + 
PGSIZE
 <(*)
víd
;Ö += PGSIZE)

52 
	`k‰ì
(
p
);

53 
	}
}

60 
	$k‰ì
(*
v
)

62 
run
 *
r
;

64 if((
uöt
)
v
 % 
PGSIZE
 || v < 
íd
 || 
	`V2P
(vË>
PHYSTOP
)

65 
	`∑nic
("kfree");

68 
	`mem£t
(
v
, 1, 
PGSIZE
);

70 if(
kmem
.
u£_lock
)

71 
	`acquúe
(&
kmem
.
lock
);

72 
r
 = (
run
*)
v
;

73 
r
->
√xt
 = 
kmem
.
‰ìli°
;

74 
kmem
.
‰ìli°
 = 
r
;

75 if(
kmem
.
u£_lock
)

76 
	`ªÀa£
(&
kmem
.
lock
);

77 
	}
}

83 
	$kÆloc
()

85 
run
 *
r
;

87 if(
kmem
.
u£_lock
)

88 
	`acquúe
(&
kmem
.
lock
);

89 
r
 = 
kmem
.
‰ìli°
;

90 if(
r
)

91 
kmem
.
‰ìli°
 = 
r
->
√xt
;

92 if(
kmem
.
u£_lock
)

93 
	`ªÀa£
(&
kmem
.
lock
);

94  (*)
r
;

95 
	}
}

	@kbd.c

1 
	~"ty≥s.h
"

2 
	~"x86.h
"

3 
	~"defs.h
"

4 
	~"kbd.h
"

7 
	$kbdgëc
()

9 
uöt
 
shi·
;

10 
uch¨
 *
ch¨code
[4] = {

11 
n‹mÆm≠
, 
shi·m≠
, 
˘lm≠
, ctlmap

13 
uöt
 
°
, 
d©a
, 
c
;

15 
°
 = 
	`öb
(
KBSTATP
);

16 if((
°
 & 
KBS_DIB
) == 0)

18 
d©a
 = 
	`öb
(
KBDATAP
);

20 if(
d©a
 == 0xE0){

21 
shi·
 |
E0ESC
;

23 } if(
d©a
 & 0x80){

25 
d©a
 = (
shi·
 & 
E0ESC
 ? data : data & 0x7F);

26 
shi·
 &~(
shi·code
[
d©a
] | 
E0ESC
);

28 } if(
shi·
 & 
E0ESC
){

30 
d©a
 |= 0x80;

31 
shi·
 &~
E0ESC
;

34 
shi·
 |
shi·code
[
d©a
];

35 
shi·
 ^
toggÀcode
[
d©a
];

36 
c
 = 
ch¨code
[
shi·
 & (
CTL
 | 
SHIFT
)][
d©a
];

37 if(
shi·
 & 
CAPSLOCK
){

38 if('a' <
c
 && c <= 'z')

39 
c
 += 'A' - 'a';

40 if('A' <
c
 && c <= 'Z')

41 
c
 += 'a' - 'A';

43  
c
;

44 
	}
}

47 
	$kbdöå
()

49 
	`c⁄sﬁeöå
(
kbdgëc
);

50 
	}
}

	@kbd.h

3 
	#KBSTATP
 0x64

4 
	#KBS_DIB
 0x01

5 
	#KBDATAP
 0x60

6 

	)

7 
	#NO
 0

	)

9 
	#SHIFT
 (1<<0)

	)

10 
	#CTL
 (1<<1)

	)

11 
	#ALT
 (1<<2)

	)

13 
	#CAPSLOCK
 (1<<3)

	)

14 
	#NUMLOCK
 (1<<4)

	)

15 
	#SCROLLLOCK
 (1<<5)

	)

17 
	#E0ESC
 (1<<6)

	)

20 
	#KEY_HOME
 0xE0

	)

21 
	#KEY_END
 0xE1

	)

22 
	#KEY_UP
 0xE2

	)

23 
	#KEY_DN
 0xE3

	)

24 
	#KEY_LF
 0xE4

	)

25 
	#KEY_RT
 0xE5

	)

26 
	#KEY_PGUP
 0xE6

	)

27 
	#KEY_PGDN
 0xE7

	)

28 
	#KEY_INS
 0xE8

	)

29 
	#KEY_DEL
 0xE9

	)

32 
	#C
(
x
Ë(x - '@')

	)

34 
uch¨
 
	gshi·code
[256] =

36 [0x1D] 
CTL
,

37 [0x2A] 
SHIFT
,

38 [0x36] 
SHIFT
,

39 [0x38] 
ALT
,

40 [0x9D] 
CTL
,

41 [0xB8] 
ALT


44 
uch¨
 
	gtoggÀcode
[256] =

46 [0x3A] 
CAPSLOCK
,

47 [0x45] 
NUMLOCK
,

48 [0x46] 
SCROLLLOCK


51 
uch¨
 
	gn‹mÆm≠
[256] =

53 
NO
, 0x1B, '1', '2', '3', '4', '5', '6',

56 'o', 'p', '[', ']', '\n', 
NO
, 'a', 's',

58 '\'', '`', 
NO
, '\\', 'z', 'x', 'c', 'v',

59 'b', 'n', 'm', ',', '.', '/', 
NO
, '*',

60 
NO
, ' ', NO, NO, NO, NO, NO, NO,

61 
NO
, NO, NO, NO, NO, NO, NO, '7',

63 '2', '3', '0', '.', 
NO
, NO, NO, NO,

66 [0xC8] 
KEY_UP
, [0xD0] 
KEY_DN
,

67 [0xC9] 
KEY_PGUP
, [0xD1] 
KEY_PGDN
,

68 [0xCB] 
KEY_LF
, [0xCD] 
KEY_RT
,

69 [0x97] 
KEY_HOME
, [0xCF] 
KEY_END
,

70 [0xD2] 
KEY_INS
, [0xD3] 
KEY_DEL


73 
uch¨
 
	gshi·m≠
[256] =

75 
NO
, 033, '!', '@', '#', '$', '%', '^',

78 'O', 'P', '{', '}', '\n', 
NO
, 'A', 'S',

80 '"', '~', 
NO
, '|', 'Z', 'X', 'C', 'V',

81 'B', 'N', 'M', '<', '>', '?', 
NO
, '*',

82 
NO
, ' ', NO, NO, NO, NO, NO, NO,

83 
NO
, NO, NO, NO, NO, NO, NO, '7',

85 '2', '3', '0', '.', 
NO
, NO, NO, NO,

88 [0xC8] 
KEY_UP
, [0xD0] 
KEY_DN
,

89 [0xC9] 
KEY_PGUP
, [0xD1] 
KEY_PGDN
,

90 [0xCB] 
KEY_LF
, [0xCD] 
KEY_RT
,

91 [0x97] 
KEY_HOME
, [0xCF] 
KEY_END
,

92 [0xD2] 
KEY_INS
, [0xD3] 
KEY_DEL


95 
uch¨
 
	g˘lm≠
[256] =

97 
NO
, NO, NO, NO, NO, NO, NO, NO,

98 
NO
, NO, NO, NO, NO, NO, NO, NO,

99 
C
('Q'), C('W'), C('E'), C('R'), C('T'), C('Y'), C('U'), C('I'),

100 
C
('O'), C('P'), 
NO
, NO, '\r', NO, C('A'), C('S'),

101 
C
('D'), C('F'), C('G'), C('H'), C('J'), C('K'), C('L'), 
NO
,

102 
NO
, NO, NO, 
C
('\\'), C('Z'), C('X'), C('C'), C('V'),

103 
C
('B'), C('N'), C('M'), 
NO
, NO, C('/'), NO, NO,

105 [0xB5] 
C
('/'),

106 [0xC8] 
KEY_UP
, [0xD0] 
KEY_DN
,

107 [0xC9] 
KEY_PGUP
, [0xD1] 
KEY_PGDN
,

108 [0xCB] 
KEY_LF
, [0xCD] 
KEY_RT
,

109 [0x97] 
KEY_HOME
, [0xCF] 
KEY_END
,

110 [0xD2] 
KEY_INS
, [0xD3] 
KEY_DEL


	@lapic.c

4 
	~"∑øm.h
"

5 
	~"ty≥s.h
"

6 
	~"defs.h
"

7 
	~"d©e.h
"

8 
	~"memœyout.h
"

9 
	~"å≠s.h
"

10 
	~"mmu.h
"

11 
	~"x86.h
"

14 
	#ID
 (0x0020/4)

15 
	#VER
 (0x0030/4)

16 
	#TPR
 (0x0080/4)

17 
	#EOI
 (0x00B0/4)

18 
	#SVR
 (0x00F0/4)

19 
	#ENABLE
 0x00000100

20 
	#ESR
 (0x0280/4)

21 
	#ICRLO
 (0x0300/4)

22 
	#INIT
 0x00000500

23 
	#STARTUP
 0x00000600

24 
	#DELIVS
 0x00001000

25 
	#ASSERT
 0x00004000

26 
	#DEASSERT
 0x00000000

	)

27 
	#LEVEL
 0x00008000

28 
	#BCAST
 0x00080000

29 
	#BUSY
 0x00001000

	)

30 
	#FIXED
 0x00000000

	)

31 
	#ICRHI
 (0x0310/4)

32 
	#TIMER
 (0x0320/4)

33 
	#X1
 0x0000000B

34 
	#PERIODIC
 0x00020000

35 
	#PCINT
 (0x0340/4)

36 
	#LINT0
 (0x0350/4)

37 
	#LINT1
 (0x0360/4)

38 
	#ERROR
 (0x0370/4)

39 
	#MASKED
 0x00010000

40 
	#TICR
 (0x0380/4)

41 
	#TCCR
 (0x0390/4)

42 
	#TDCR
 (0x03E0/4)

43 

	)

44 vﬁ©ûê
uöt
 *
	gœpic
;

48 
	$œpicw
(
ödex
, 
vÆue
)

50 
œpic
[
ödex
] = 
vÆue
;

51 
œpic
[
ID
];

52 
	}
}

55 
	$œpicöô
()

57 if(!
œpic
)

61 
	`œpicw
(
SVR
, 
ENABLE
 | (
T_IRQ0
 + 
IRQ_SPURIOUS
));

67 
	`œpicw
(
TDCR
, 
X1
);

68 
	`œpicw
(
TIMER
, 
PERIODIC
 | (
T_IRQ0
 + 
IRQ_TIMER
));

69 
	`œpicw
(
TICR
, 10000000);

72 
	`œpicw
(
LINT0
, 
MASKED
);

73 
	`œpicw
(
LINT1
, 
MASKED
);

77 if(((
œpic
[
VER
]>>16) & 0xFF) >= 4)

78 
	`œpicw
(
PCINT
, 
MASKED
);

81 
	`œpicw
(
ERROR
, 
T_IRQ0
 + 
IRQ_ERROR
);

84 
	`œpicw
(
ESR
, 0);

85 
	`œpicw
(
ESR
, 0);

88 
	`œpicw
(
EOI
, 0);

91 
	`œpicw
(
ICRHI
, 0);

92 
	`œpicw
(
ICRLO
, 
BCAST
 | 
INIT
 | 
LEVEL
);

93 
œpic
[
ICRLO
] & 
DELIVS
)

97 
	`œpicw
(
TPR
, 0);

98 
	}
}

101 
	$œpicid
()

103 i‡(!
œpic
)

105  
œpic
[
ID
] >> 24;

106 
	}
}

110 
	$œpi˚oi
()

112 if(
œpic
)

113 
	`œpicw
(
EOI
, 0);

114 
	}
}

119 
	$mi¸odñay
(
us
)

121 
	}
}

123 
	#CMOS_PORT
 0x70

	)

124 
	#CMOS_RETURN
 0x71

	)

129 
	$œpic°¨èp
(
uch¨
 
≠icid
, 
uöt
 
addr
)

131 
i
;

132 
ush‹t
 *
wrv
;

137 
	`outb
(
CMOS_PORT
, 0xF);

138 
	`outb
(
CMOS_PORT
+1, 0x0A);

139 
wrv
 = (
ush‹t
*)
	`P2V
((0x40<<4 | 0x67));

140 
wrv
[0] = 0;

141 
wrv
[1] = 
addr
 >> 4;

145 
	`œpicw
(
ICRHI
, 
≠icid
<<24);

146 
	`œpicw
(
ICRLO
, 
INIT
 | 
LEVEL
 | 
ASSERT
);

147 
	`mi¸odñay
(200);

148 
	`œpicw
(
ICRLO
, 
INIT
 | 
LEVEL
);

149 
	`mi¸odñay
(100);

156 
i
 = 0; i < 2; i++){

157 
	`œpicw
(
ICRHI
, 
≠icid
<<24);

158 
	`œpicw
(
ICRLO
, 
STARTUP
 | (
addr
>>12));

159 
	`mi¸odñay
(200);

161 
	}
}

163 
	#CMOS_STATA
 0x0a

	)

164 
	#CMOS_STATB
 0x0b

	)

165 
	#CMOS_UIP
 (1 << 7)

166 

	)

167 
	#SECS
 0x00

	)

168 
	#MINS
 0x02

	)

169 
	#HOURS
 0x04

	)

170 
	#DAY
 0x07

	)

171 
	#MONTH
 0x08

	)

172 
	#YEAR
 0x09

	)

174 
uöt


175 
	$cmos_ªad
(
uöt
 
ªg
)

177 
	`outb
(
CMOS_PORT
, 
ªg
);

178 
	`mi¸odñay
(200);

180  
	`öb
(
CMOS_RETURN
);

181 
	}
}

184 
	$fûl_πcd©e
(
πcd©e
 *
r
)

186 
r
->
£c⁄d
 = 
	`cmos_ªad
(
SECS
);

187 
r
->
möuã
 = 
	`cmos_ªad
(
MINS
);

188 
r
->
hour
 = 
	`cmos_ªad
(
HOURS
);

189 
r
->
day
 = 
	`cmos_ªad
(
DAY
);

190 
r
->
m⁄th
 = 
	`cmos_ªad
(
MONTH
);

191 
r
->
yór
 = 
	`cmos_ªad
(
YEAR
);

192 
	}
}

196 
	$cmo°ime
(
πcd©e
 *
r
)

198 
πcd©e
 
t1
, 
t2
;

199 
sb
, 
bcd
;

201 
sb
 = 
	`cmos_ªad
(
CMOS_STATB
);

203 
bcd
 = (
sb
 & (1 << 2)) == 0;

207 
	`fûl_πcd©e
(&
t1
);

208 if(
	`cmos_ªad
(
CMOS_STATA
Ë& 
CMOS_UIP
)

210 
	`fûl_πcd©e
(&
t2
);

211 if(
	`memcmp
(&
t1
, &
t2
, (t1)) == 0)

216 if(
bcd
) {

217 
	#CONV
(
x
Ë(
t1
.x = (—1.x >> 4Ë* 10Ë+ (t1.x & 0xf))

	)

218 
	`CONV
(
£c⁄d
);

219 
	`CONV
(
möuã
);

220 
	`CONV
(
hour
 );

221 
	`CONV
(
day
 );

222 
	`CONV
(
m⁄th
 );

223 
	`CONV
(
yór
 );

224 #unde‡
CONV


227 *
r
 = 
t1
;

228 
r
->
yór
 += 2000;

229 
	}
}

	@log.c

1 
	~"ty≥s.h
"

2 
	~"defs.h
"

3 
	~"∑øm.h
"

4 
	~"•ölock.h
"

5 
	~"¶ì∂ock.h
"

6 
	~"fs.h
"

7 
	~"buf.h
"

34 
	sloghódî
 {

35 
	mn
;

36 
	mblock
[
LOGSIZE
];

39 
	slog
 {

40 
•ölock
 
	mlock
;

41 
	m°¨t
;

42 
	msize
;

43 
	mout°™dög
;

44 
	mcommôtög
;

45 
	mdev
;

46 
loghódî
 
	mlh
;

48 
log
 
	glog
;

50 
ªcovî_‰om_log
();

51 
commô
();

54 
	$öôlog
(
dev
)

56 i‡((
loghódî
Ë>
BSIZE
)

57 
	`∑nic
("initlog:Åoo bigÜogheader");

59 
su≥rblock
 
sb
;

60 
	`öôlock
(&
log
.
lock
, "log");

61 
	`ªadsb
(
dev
, &
sb
);

62 
log
.
°¨t
 = 
sb
.
log°¨t
;

63 
log
.
size
 = 
sb
.
∆og
;

64 
log
.
dev
 = dev;

65 
	`ªcovî_‰om_log
();

66 
	}
}

70 
	$ö°Æl_å™s
()

72 
èû
;

74 
èû
 = 0;Åaû < 
log
.
lh
.
n
;Åail++) {

75 
buf
 *
lbuf
 = 
	`bªad
(
log
.
dev
,Üog.
°¨t
+
èû
+1);

76 
buf
 *
dbuf
 = 
	`bªad
(
log
.
dev
,Üog.
lh
.
block
[
èû
]);

77 
	`memmove
(
dbuf
->
d©a
, 
lbuf
->d©a, 
BSIZE
);

78 
	`bwrôe
(
dbuf
);

79 
	`bªl£
(
lbuf
);

80 
	`bªl£
(
dbuf
);

82 
	}
}

86 
	$ªad_hód
()

88 
buf
 *bu‡
	`bªad
(
log
.
dev
,Üog.
°¨t
);

89 
loghódî
 *
lh
 = (loghódî *Ë(
buf
->
d©a
);

90 
i
;

91 
log
.
lh
.
n
 =Üh->n;

92 
i
 = 0; i < 
log
.
lh
.
n
; i++) {

93 
log
.
lh
.
block
[
i
] =Üh->block[i];

95 
	`bªl£
(
buf
);

96 
	}
}

102 
	$wrôe_hód
()

104 
buf
 *bu‡
	`bªad
(
log
.
dev
,Üog.
°¨t
);

105 
loghódî
 *
hb
 = (loghódî *Ë(
buf
->
d©a
);

106 
i
;

107 
hb
->
n
 = 
log
.
lh
.n;

108 
i
 = 0; i < 
log
.
lh
.
n
; i++) {

109 
hb
->
block
[
i
] = 
log
.
lh
.block[i];

111 
	`bwrôe
(
buf
);

112 
	`bªl£
(
buf
);

113 
	}
}

116 
	$ªcovî_‰om_log
()

118 
	`ªad_hód
();

119 
	`ö°Æl_å™s
();

120 
log
.
lh
.
n
 = 0;

121 
	`wrôe_hód
();

122 
	}
}

126 
	$begö_›
()

128 
	`acquúe
(&
log
.
lock
);

130 if(
log
.
commôtög
){

131 
	`¶ìp
(&
log
, &log.
lock
);

132 } if(
log
.
lh
.
n
 + (log.
out°™dög
+1)*
MAXOPBLOCKS
 > 
LOGSIZE
){

134 
	`¶ìp
(&
log
, &log.
lock
);

136 
log
.
out°™dög
 += 1;

137 
	`ªÀa£
(&
log
.
lock
);

141 
	}
}

146 
	$íd_›
()

148 
do_commô
 = 0;

150 
	`acquúe
(&
log
.
lock
);

151 
log
.
out°™dög
 -= 1;

152 if(
log
.
commôtög
)

153 
	`∑nic
("log.committing");

154 if(
log
.
out°™dög
 == 0){

155 
do_commô
 = 1;

156 
log
.
commôtög
 = 1;

161 
	`wakeup
(&
log
);

163 
	`ªÀa£
(&
log
.
lock
);

165 if(
do_commô
){

168 
	`commô
();

169 
	`acquúe
(&
log
.
lock
);

170 
log
.
commôtög
 = 0;

171 
	`wakeup
(&
log
);

172 
	`ªÀa£
(&
log
.
lock
);

174 
	}
}

178 
	$wrôe_log
()

180 
èû
;

182 
èû
 = 0;Åaû < 
log
.
lh
.
n
;Åail++) {

183 
buf
 *
to
 = 
	`bªad
(
log
.
dev
,Üog.
°¨t
+
èû
+1);

184 
buf
 *
‰om
 = 
	`bªad
(
log
.
dev
,Üog.
lh
.
block
[
èû
]);

185 
	`memmove
(
to
->
d©a
, 
‰om
->d©a, 
BSIZE
);

186 
	`bwrôe
(
to
);

187 
	`bªl£
(
‰om
);

188 
	`bªl£
(
to
);

190 
	}
}

193 
	$commô
()

195 i‡(
log
.
lh
.
n
 > 0) {

196 
	`wrôe_log
();

197 
	`wrôe_hód
();

198 
	`ö°Æl_å™s
();

199 
log
.
lh
.
n
 = 0;

200 
	`wrôe_hód
();

202 
	}
}

214 
	$log_wrôe
(
buf
 *
b
)

216 
i
;

218 i‡(
log
.
lh
.
n
 >
LOGSIZE
 ||Üog.lh.¿>log.
size
 - 1)

219 
	`∑nic
("too bigáÅransaction");

220 i‡(
log
.
out°™dög
 < 1)

221 
	`∑nic
("log_write outside ofÅrans");

223 
	`acquúe
(&
log
.
lock
);

224 
i
 = 0; i < 
log
.
lh
.
n
; i++) {

225 i‡(
log
.
lh
.
block
[
i
] =
b
->
blockno
)

228 
log
.
lh
.
block
[
i
] = 
b
->
blockno
;

229 i‡(
i
 =
log
.
lh
.
n
)

230 
log
.
lh
.
n
++;

231 
b
->
Êags
 |
B_DIRTY
;

232 
	`ªÀa£
(&
log
.
lock
);

233 
	}
}

	@main.c

1 
	~"ty≥s.h
"

2 
	~"defs.h
"

3 
	~"∑øm.h
"

4 
	~"memœyout.h
"

5 
	~"mmu.h
"

6 
	~"¥oc.h
"

7 
	~"x86.h
"

9 
°¨tŸhîs
();

10 
	$mpmaö
(Ë
	`__©åibuã__
((
n‹ëu∫
));

11 
pde_t
 *
kpgdú
;

12 
íd
[];

18 
	$maö
()

20 
	`köô1
(
íd
, 
	`P2V
(4*1024*1024));

21 
	`kvmÆloc
();

22 
	`mpöô
();

23 
	`œpicöô
();

24 
	`£göô
();

25 
	`picöô
();

26 
	`iﬂpicöô
();

27 
	`c⁄sﬁeöô
();

28 
	`u¨töô
();

29 
	`pöô
();

30 
	`tvöô
();

31 
	`böô
();

32 
	`fûeöô
();

33 
	`ideöô
();

34 
	`°¨tŸhîs
();

35 
	`köô2
(
	`P2V
(4*1024*1024), P2V(
PHYSTOP
));

36 
	`u£röô
();

37 
	`mpmaö
();

38 
	}
}

42 
	$m≥¡î
()

44 
	`swôchkvm
();

45 
	`£göô
();

46 
	`œpicöô
();

47 
	`mpmaö
();

48 
	}
}

52 
	$mpmaö
()

54 
	`˝rötf
("˝u%d: sèπög %d\n", 
	`˝uid
(), cpuid());

55 
	`idtöô
();

56 
	`xchg
(&(
	`my˝u
()->
°¨ãd
), 1);

57 
	`scheduÀr
();

58 
	}
}

60 
pde_t
 
	gíåypgdú
[];

64 
	$°¨tŸhîs
()

66 
uch¨
 
_bö¨y_íåyŸhî_°¨t
[], 
_bö¨y_íåyŸhî_size
[];

67 
uch¨
 *
code
;

68 
˝u
 *
c
;

69 *
°ack
;

74 
code
 = 
	`P2V
(0x7000);

75 
	`memmove
(
code
, 
_bö¨y_íåyŸhî_°¨t
, (
uöt
)
_bö¨y_íåyŸhî_size
);

77 
c
 = 
˝us
; c < cpus+
n˝u
; c++){

78 if(
c
 =
	`my˝u
())

84 
°ack
 = 
	`kÆloc
();

85 *(**)(
code
-4Ë
°ack
 + 
KSTACKSIZE
;

86 *((**)())(
code
-8Ë
m≥¡î
;

87 *(**)(
code
-12Ë(*Ë
	`V2P
(
íåypgdú
);

89 
	`œpic°¨èp
(
c
->
≠icid
, 
	`V2P
(
code
));

92 
c
->
°¨ãd
 == 0)

95 
	}
}

102 
__©åibuã__
((
	$__Æig√d__
(
PGSIZE
)))

103 
pde_t
 
íåypgdú
[
NPDENTRIES
] = {

105 [0] = (0Ë| 
PTE_P
 | 
PTE_W
 | 
PTE_PS
,

107 [
KERNBASE
>>
PDXSHIFT
] = (0Ë| 
PTE_P
 | 
PTE_W
 | 
PTE_PS
,

108 
	}
};

	@memide.c

4 
	~"ty≥s.h
"

5 
	~"defs.h
"

6 
	~"∑øm.h
"

7 
	~"mmu.h
"

8 
	~"¥oc.h
"

9 
	~"x86.h
"

10 
	~"å≠s.h
"

11 
	~"•ölock.h
"

12 
	~"¶ì∂ock.h
"

13 
	~"fs.h
"

14 
	~"buf.h
"

16 
uch¨
 
_bö¨y_fs_img_°¨t
[], 
_bö¨y_fs_img_size
[];

18 
	gdisksize
;

19 
uch¨
 *
	gmemdisk
;

22 
	$ideöô
()

24 
memdisk
 = 
_bö¨y_fs_img_°¨t
;

25 
disksize
 = (
uöt
)
_bö¨y_fs_img_size
/
BSIZE
;

26 
	}
}

30 
	$ideöå
()

33 
	}
}

39 
	$idîw
(
buf
 *
b
)

41 
uch¨
 *
p
;

43 if(!
	`hﬁdög¶ìp
(&
b
->
lock
))

44 
	`∑nic
("iderw: bufÇotÜocked");

45 if((
b
->
Êags
 & (
B_VALID
|
B_DIRTY
)) == B_VALID)

46 
	`∑nic
("iderw:ÇothingÅo do");

47 if(
b
->
dev
 != 1)

48 
	`∑nic
("iderw:ÑequestÇot for disk 1");

49 if(
b
->
blockno
 >
disksize
)

50 
	`∑nic
("iderw: block out ofÑange");

52 
p
 = 
memdisk
 + 
b
->
blockno
*
BSIZE
;

54 if(
b
->
Êags
 & 
B_DIRTY
){

55 
b
->
Êags
 &~
B_DIRTY
;

56 
	`memmove
(
p
, 
b
->
d©a
, 
BSIZE
);

58 
	`memmove
(
b
->
d©a
, 
p
, 
BSIZE
);

59 
b
->
Êags
 |
B_VALID
;

60 
	}
}

	@memlayout.h

3 
	#EXTMEM
 0x100000

4 
	#PHYSTOP
 0xE000000

5 
	#DEVSPACE
 0xFE000000

6 

	)

8 
	#KERNBASE
 0x80000000

9 
	#KERNLINK
 (
KERNBASE
+
EXTMEM
)

10 

	)

11 
	#V2P
(
a
Ë(((
uöt
Ë◊)Ë- 
KERNBASE
)

	)

12 
	#P2V
(
a
Ë((*)(((*Ë◊)Ë+ 
KERNBASE
))

	)

14 
	#V2P_WO
(
x
Ë((xË- 
KERNBASE
)

15 
	#P2V_WO
(
x
Ë((xË+ 
KERNBASE
)

	@mkfs.c

1 
	~<°dio.h
>

2 
	~<uni°d.h
>

3 
	~<°dlib.h
>

4 
	~<°rög.h
>

5 
	~<f˙é.h
>

6 
	~<as£π.h
>

8 
	#°©
 
xv6_°©


9 
	~"ty≥s.h
"

	)

10 
	~"fs.h
"

11 
	~"°©.h
"

12 
	~"∑øm.h
"

14 #i‚de‡
°©ic_as£π


15 
	#°©ic_as£π
(
a
, 
b
Ëdÿ{ 0Ë0: ◊): ; } 0)

	)

18 
	#NINODES
 200

	)

23 
	gnbôm≠
 = 
FSSIZE
/(
BSIZE
*8) + 1;

24 
	gnöodeblocks
 = 
NINODES
 / 
IPB
 + 1;

25 
	g∆og
 = 
LOGSIZE
;

26 
	gnmëa
;

27 
	gnblocks
;

29 
	gfsfd
;

30 
su≥rblock
 
	gsb
;

31 
	gzî€s
[
BSIZE
];

32 
uöt
 
	g‰ìöode
 = 1;

33 
uöt
 
	g‰ìblock
;

36 
bÆloc
();

37 
w£˘
(
uöt
, *);

38 
wöode
(
uöt
, 
döode
*);

39 
röode
(
uöt
 
öum
, 
döode
 *
ù
);

40 
r£˘
(
uöt
 
£c
, *
buf
);

41 
uöt
 
üŒoc
(
ush‹t
 
ty≥
);

42 
üµíd
(
uöt
 
öum
, *
p
, 
n
);

45 
ush‹t


46 
	$xsh‹t
(
ush‹t
 
x
)

48 
ush‹t
 
y
;

49 
uch¨
 *
a
 = (uch¨*)&
y
;

50 
a
[0] = 
x
;

51 
a
[1] = 
x
 >> 8;

52  
y
;

53 
	}
}

55 
uöt


56 
	$xöt
(
uöt
 
x
)

58 
uöt
 
y
;

59 
uch¨
 *
a
 = (uch¨*)&
y
;

60 
a
[0] = 
x
;

61 
a
[1] = 
x
 >> 8;

62 
a
[2] = 
x
 >> 16;

63 
a
[3] = 
x
 >> 24;

64  
y
;

65 
	}
}

68 
	$maö
(
¨gc
, *
¨gv
[])

70 
i
, 
cc
, 
fd
;

71 
uöt
 
roŸöo
, 
öum
, 
off
;

72 
dúít
 
de
;

73 
buf
[
BSIZE
];

74 
döode
 
dö
;

77 
	`°©ic_as£π
(() == 4, "Integers must be 4 bytes!");

79 if(
¨gc
 < 2){

80 
	`Ârötf
(
°dîr
, "Usage: mkfs fs.img files...\n");

81 
	`exô
(1);

84 
	`as£π
((
BSIZE
 % (
döode
)) == 0);

85 
	`as£π
((
BSIZE
 % (
dúít
)) == 0);

87 
fsfd
 = 
	`›í
(
¨gv
[1], 
O_RDWR
|
O_CREAT
|
O_TRUNC
, 0666);

88 if(
fsfd
 < 0){

89 
	`≥º‹
(
¨gv
[1]);

90 
	`exô
(1);

94 
nmëa
 = 2 + 
∆og
 + 
nöodeblocks
 + 
nbôm≠
;

95 
nblocks
 = 
FSSIZE
 - 
nmëa
;

97 
sb
.
size
 = 
	`xöt
(
FSSIZE
);

98 
sb
.
nblocks
 = 
	`xöt
(nblocks);

99 
sb
.
nöodes
 = 
	`xöt
(
NINODES
);

100 
sb
.
∆og
 = 
	`xöt
(nlog);

101 
sb
.
log°¨t
 = 
	`xöt
(2);

102 
sb
.
öode°¨t
 = 
	`xöt
(2+
∆og
);

103 
sb
.
bm≠°¨t
 = 
	`xöt
(2+
∆og
+
nöodeblocks
);

105 
	`¥ötf
("nmeta %d (boot, super,Üog blocks %u inode blocks %u, bitmap blocks %u) blocks %dÅotal %d\n",

106 
nmëa
, 
∆og
, 
nöodeblocks
, 
nbôm≠
, 
nblocks
, 
FSSIZE
);

108 
‰ìblock
 = 
nmëa
;

110 
i
 = 0; i < 
FSSIZE
; i++)

111 
	`w£˘
(
i
, 
zî€s
);

113 
	`mem£t
(
buf
, 0, (buf));

114 
	`memmove
(
buf
, &
sb
, (sb));

115 
	`w£˘
(1, 
buf
);

117 
roŸöo
 = 
	`üŒoc
(
T_DIR
);

118 
	`as£π
(
roŸöo
 =
ROOTINO
);

120 
	`bzîo
(&
de
, (de));

121 
de
.
öum
 = 
	`xsh‹t
(
roŸöo
);

122 
	`°r˝y
(
de
.
«me
, ".");

123 
	`üµíd
(
roŸöo
, &
de
, (de));

125 
	`bzîo
(&
de
, (de));

126 
de
.
öum
 = 
	`xsh‹t
(
roŸöo
);

127 
	`°r˝y
(
de
.
«me
, "..");

128 
	`üµíd
(
roŸöo
, &
de
, (de));

130 
i
 = 2; i < 
¨gc
; i++){

131 *
sh‹äame
;

132 if(
	`°∫cmp
(
¨gv
[
i
], "user/", 5) == 0)

133 
sh‹äame
 = 
¨gv
[
i
] + 5;

135 
sh‹äame
 = 
¨gv
[
i
];

137 
	`as£π
(
	`ödex
(
sh‹äame
, '/') == 0);

141 if((
fd
 = 
	`›í
(
¨gv
[
i
], 0)) < 0){

142 
	`≥º‹
(
¨gv
[
i
]);

143 
	`exô
(1);

153 if(
sh‹äame
[0] == '_')

154 
sh‹äame
 += 1;

156 
öum
 = 
	`üŒoc
(
T_FILE
);

158 
	`bzîo
(&
de
, (de));

159 
de
.
öum
 = 
	`xsh‹t
(inum);

160 
	`°∫˝y
(
de
.
«me
, 
sh‹äame
, 
DIRSIZ
);

162 
	`üµíd
(
roŸöo
, &
de
, (de));

164 (
cc
 = 
	`ªad
(
fd
, 
buf
, (buf))) > 0)

165 
	`üµíd
(
öum
, 
buf
, 
cc
);

167 
	`˛o£
(
fd
);

171 
	`röode
(
roŸöo
, &
dö
);

172 
off
 = 
	`xöt
(
dö
.
size
);

173 
off
 = ((off/
BSIZE
) + 1) * BSIZE;

174 
dö
.
size
 = 
	`xöt
(
off
);

175 
	`wöode
(
roŸöo
, &
dö
);

177 
	`bÆloc
(
‰ìblock
);

179 
	`exô
(0);

180 
	}
}

183 
	$w£˘
(
uöt
 
£c
, *
buf
)

185 if(
	`l£ek
(
fsfd
, 
£c
 * 
BSIZE
, 0) != sec * BSIZE){

186 
	`≥º‹
("lseek");

187 
	`exô
(1);

189 if(
	`wrôe
(
fsfd
, 
buf
, 
BSIZE
) != BSIZE){

190 
	`≥º‹
("write");

191 
	`exô
(1);

193 
	}
}

196 
	$wöode
(
uöt
 
öum
, 
döode
 *
ù
)

198 
buf
[
BSIZE
];

199 
uöt
 
bn
;

200 
döode
 *
dù
;

202 
bn
 = 
	`IBLOCK
(
öum
, 
sb
);

203 
	`r£˘
(
bn
, 
buf
);

204 
dù
 = ((
döode
*)
buf
Ë+ (
öum
 % 
IPB
);

205 *
dù
 = *
ù
;

206 
	`w£˘
(
bn
, 
buf
);

207 
	}
}

210 
	$röode
(
uöt
 
öum
, 
döode
 *
ù
)

212 
buf
[
BSIZE
];

213 
uöt
 
bn
;

214 
döode
 *
dù
;

216 
bn
 = 
	`IBLOCK
(
öum
, 
sb
);

217 
	`r£˘
(
bn
, 
buf
);

218 
dù
 = ((
döode
*)
buf
Ë+ (
öum
 % 
IPB
);

219 *
ù
 = *
dù
;

220 
	}
}

223 
	$r£˘
(
uöt
 
£c
, *
buf
)

225 if(
	`l£ek
(
fsfd
, 
£c
 * 
BSIZE
, 0) != sec * BSIZE){

226 
	`≥º‹
("lseek");

227 
	`exô
(1);

229 if(
	`ªad
(
fsfd
, 
buf
, 
BSIZE
) != BSIZE){

230 
	`≥º‹
("read");

231 
	`exô
(1);

233 
	}
}

235 
uöt


236 
	$üŒoc
(
ush‹t
 
ty≥
)

238 
uöt
 
öum
 = 
‰ìöode
++;

239 
döode
 
dö
;

241 
	`bzîo
(&
dö
, (din));

242 
dö
.
ty≥
 = 
	`xsh‹t
(type);

243 
dö
.
∆ök
 = 
	`xsh‹t
(1);

244 
dö
.
size
 = 
	`xöt
(0);

245 
	`wöode
(
öum
, &
dö
);

246  
öum
;

247 
	}
}

250 
	$bÆloc
(
u£d
)

252 
uch¨
 
buf
[
BSIZE
];

253 
i
;

255 
	`¥ötf
("bÆloc: fú° %d block†havêbì¿Æloˇãd\n", 
u£d
);

256 
	`as£π
(
u£d
 < 
BSIZE
*8);

257 
	`bzîo
(
buf
, 
BSIZE
);

258 
i
 = 0; i < 
u£d
; i++){

259 
buf
[
i
/8] = buf[i/8] | (0x1 << (i%8));

261 
	`¥ötf
("bÆloc: wrôêbôm≠ blockáà£˘‹ %d\n", 
sb
.
bm≠°¨t
);

262 
	`w£˘
(
sb
.
bm≠°¨t
, 
buf
);

263 
	}
}

265 
	#mö
(
a
, 
b
Ë(◊Ë< (bË? (aË: (b))

	)

268 
	$üµíd
(
uöt
 
öum
, *
xp
, 
n
)

270 *
p
 = (*)
xp
;

271 
uöt
 
fbn
, 
off
, 
n1
;

272 
döode
 
dö
;

273 
buf
[
BSIZE
];

274 
uöt
 
ödúe˘
[
NINDIRECT
];

275 
uöt
 
x
;

277 
	`röode
(
öum
, &
dö
);

278 
off
 = 
	`xöt
(
dö
.
size
);

280 
n
 > 0){

281 
fbn
 = 
off
 / 
BSIZE
;

282 
	`as£π
(
fbn
 < 
MAXFILE
);

283 if(
fbn
 < 
NDIRECT
){

284 if(
	`xöt
(
dö
.
addrs
[
fbn
]) == 0){

285 
dö
.
addrs
[
fbn
] = 
	`xöt
(
‰ìblock
++);

287 
x
 = 
	`xöt
(
dö
.
addrs
[
fbn
]);

289 if(
	`xöt
(
dö
.
addrs
[
NDIRECT
]) == 0){

290 
dö
.
addrs
[
NDIRECT
] = 
	`xöt
(
‰ìblock
++);

292 
	`r£˘
(
	`xöt
(
dö
.
addrs
[
NDIRECT
]), (*)
ödúe˘
);

293 if(
ödúe˘
[
fbn
 - 
NDIRECT
] == 0){

294 
ödúe˘
[
fbn
 - 
NDIRECT
] = 
	`xöt
(
‰ìblock
++);

295 
	`w£˘
(
	`xöt
(
dö
.
addrs
[
NDIRECT
]), (*)
ödúe˘
);

297 
x
 = 
	`xöt
(
ödúe˘
[
fbn
-
NDIRECT
]);

299 
n1
 = 
	`mö
(
n
, (
fbn
 + 1Ë* 
BSIZE
 - 
off
);

300 
	`r£˘
(
x
, 
buf
);

301 
	`bc›y
(
p
, 
buf
 + 
off
 - (
fbn
 * 
BSIZE
), 
n1
);

302 
	`w£˘
(
x
, 
buf
);

303 
n
 -
n1
;

304 
off
 +
n1
;

305 
p
 +
n1
;

307 
dö
.
size
 = 
	`xöt
(
off
);

308 
	`wöode
(
öum
, &
dö
);

309 
	}
}

	@mmu.h

5 
	#FL_IF
 0x00000200

6 

	)

8 
	#CR0_PE
 0x00000001

9 
	#CR0_WP
 0x00010000

10 
	#CR0_PG
 0x80000000

11 

	)

12 
	#CR4_PSE
 0x00000010

13 

	)

15 
	#SEG_KCODE
 1

16 
	#SEG_KDATA
 2

17 
	#SEG_UCODE
 3

18 
	#SEG_UDATA
 4

19 
	#SEG_TSS
 5

20 

	)

22 
	#NSEGS
 6

	)

24 #i‚de‡
__ASSEMBLER__


26 
	s£gdesc
 {

27 
uöt
 
	mlim_15_0
 : 16;

28 
uöt
 
	mba£_15_0
 : 16;

29 
uöt
 
	mba£_23_16
 : 8;

30 
uöt
 
	mty≥
 : 4;

31 
uöt
 
	ms
 : 1;

32 
uöt
 
	md∂
 : 2;

33 
uöt
 
	mp
 : 1;

34 
uöt
 
	mlim_19_16
 : 4;

35 
uöt
 
	mavl
 : 1;

36 
uöt
 
	mrsv1
 : 1;

37 
uöt
 
	mdb
 : 1;

38 
uöt
 
	mg
 : 1;

39 
uöt
 
	mba£_31_24
 : 8;

43 
	#SEG
(
ty≥
, 
ba£
, 
lim
, 
d∂
Ë(
£gdesc
) \

44 { ((
lim
Ë>> 12Ë& 0xffff, (
uöt
)(
ba£
) & 0xffff, \

45 ((
uöt
)(
ba£
Ë>> 16Ë& 0xff, 
ty≥
, 1, 
d∂
, 1, \

46 (
uöt
)(
lim
Ë>> 28, 0, 0, 1, 1, (uöt)(
ba£
Ë>> 24 }

	)

47 
	#SEG16
(
ty≥
, 
ba£
, 
lim
, 
d∂
Ë(
£gdesc
) \

48 { (
lim
Ë& 0xffff, (
uöt
)(
ba£
) & 0xffff, \

49 ((
uöt
)(
ba£
Ë>> 16Ë& 0xff, 
ty≥
, 1, 
d∂
, 1, \

50 (
uöt
)(
lim
Ë>> 16, 0, 0, 1, 0, (uöt)(
ba£
Ë>> 24 }

	)

53 
	#DPL_USER
 0x3

54 

	)

56 
	#STA_X
 0x8

57 
	#STA_W
 0x2

58 
	#STA_R
 0x2

59 

	)

61 
	#STS_T32A
 0x9

62 
	#STS_IG32
 0xE

63 
	#STS_TG32
 0xF

64 

	)

74 
	#PDX
(
va
Ë(((
uöt
)(vaË>> 
PDXSHIFT
Ë& 0x3FF)

	)

77 
	#PTX
(
va
Ë(((
uöt
)(vaË>> 
PTXSHIFT
Ë& 0x3FF)

	)

80 
	#PGADDR
(
d
, 
t
, 
o
Ë((
uöt
)((dË<< 
PDXSHIFT
 | (tË<< 
PTXSHIFT
 | (o)))

	)

83 
	#NPDENTRIES
 1024

84 
	#NPTENTRIES
 1024

85 
	#PGSIZE
 4096

86 

	)

87 
	#PTXSHIFT
 12

88 
	#PDXSHIFT
 22

89 

	)

90 
	#PGROUNDUP
(
sz
Ë(((sz)+
PGSIZE
-1Ë& ~(PGSIZE-1))

	)

91 
	#PGROUNDDOWN
(
a
Ë((◊)Ë& ~(
PGSIZE
-1))

	)

94 
	#PTE_P
 0x001

95 
	#PTE_W
 0x002

96 
	#PTE_U
 0x004

97 
	#PTE_PS
 0x080

98 

	)

100 
	#PTE_ADDR
(
±e
Ë((
uöt
)’ãË& ~0xFFF)

	)

101 
	#PTE_FLAGS
(
±e
Ë((
uöt
)’ãË& 0xFFF)

	)

103 #i‚de‡
__ASSEMBLER__


104 
uöt
 
	t±e_t
;

107 
	sèsk°©e
 {

108 
uöt
 
	mlök
;

109 
uöt
 
	me•0
;

110 
ush‹t
 
	mss0
;

111 
ush‹t
 
	m∑ddög1
;

112 
uöt
 *
	me•1
;

113 
ush‹t
 
	mss1
;

114 
ush‹t
 
	m∑ddög2
;

115 
uöt
 *
	me•2
;

116 
ush‹t
 
	mss2
;

117 
ush‹t
 
	m∑ddög3
;

118 *
	m¸3
;

119 
uöt
 *
	meù
;

120 
uöt
 
	meÊags
;

121 
uöt
 
	móx
;

122 
uöt
 
	mecx
;

123 
uöt
 
	medx
;

124 
uöt
 
	mebx
;

125 
uöt
 *
	me•
;

126 
uöt
 *
	mebp
;

127 
uöt
 
	mesi
;

128 
uöt
 
	medi
;

129 
ush‹t
 
	mes
;

130 
ush‹t
 
	m∑ddög4
;

131 
ush‹t
 
	mcs
;

132 
ush‹t
 
	m∑ddög5
;

133 
ush‹t
 
	mss
;

134 
ush‹t
 
	m∑ddög6
;

135 
ush‹t
 
	mds
;

136 
ush‹t
 
	m∑ddög7
;

137 
ush‹t
 
	mfs
;

138 
ush‹t
 
	m∑ddög8
;

139 
ush‹t
 
	mgs
;

140 
ush‹t
 
	m∑ddög9
;

141 
ush‹t
 
	mldt
;

142 
ush‹t
 
	m∑ddög10
;

143 
ush‹t
 
	mt
;

144 
ush‹t
 
	miomb
;

148 
	sg©edesc
 {

149 
uöt
 
	moff_15_0
 : 16;

150 
uöt
 
	mcs
 : 16;

151 
uöt
 
	m¨gs
 : 5;

152 
uöt
 
	mrsv1
 : 3;

153 
uöt
 
	mty≥
 : 4;

154 
uöt
 
	ms
 : 1;

155 
uöt
 
	md∂
 : 2;

156 
uöt
 
	mp
 : 1;

157 
uöt
 
	moff_31_16
 : 16;

168 
	#SETGATE
(
g©e
, 
i°øp
, 
£l
, 
off
, 
d
) \

170 (
g©e
).
off_15_0
 = (
uöt
)(
off
) & 0xffff; \

171 (
g©e
).
cs
 = (
£l
); \

172 (
g©e
).
¨gs
 = 0; \

173 (
g©e
).
rsv1
 = 0; \

174 (
g©e
).
ty≥
 = (
i°øp
Ë? 
STS_TG32
 : 
STS_IG32
; \

175 (
g©e
).
s
 = 0; \

176 (
g©e
).
d∂
 = (
d
); \

177 (
g©e
).
p
 = 1; \

178 (
g©e
).
off_31_16
 = (
uöt
)(
off
) >> 16; \

179 }

	)

	@mp.c

5 
	~"ty≥s.h
"

6 
	~"defs.h
"

7 
	~"∑øm.h
"

8 
	~"memœyout.h
"

9 
	~"mp.h
"

10 
	~"x86.h
"

11 
	~"mmu.h
"

12 
	~"¥oc.h
"

14 
˝u
 
	g˝us
[
NCPU
];

15 
	gn˝u
;

16 
uch¨
 
	giﬂpicid
;

18 
uch¨


19 
	$sum
(
uch¨
 *
addr
, 
Àn
)

21 
i
, 
sum
;

23 
sum
 = 0;

24 
i
=0; i<
Àn
; i++)

25 
sum
 +
addr
[
i
];

26  
sum
;

27 
	}
}

30 
mp
*

31 
	$mp£¨ch1
(
uöt
 
a
, 
Àn
)

33 
uch¨
 *
e
, *
p
, *
addr
;

35 
addr
 = 
	`P2V
(
a
);

36 
e
 = 
addr
+
Àn
;

37 
p
 = 
addr
;Ö < 
e
;Ö +(
mp
))

38 if(
	`memcmp
(
p
, "_MP_", 4Ë=0 && 
	`sum
’, (
mp
)) == 0)

39  (
mp
*)
p
;

41 
	}
}

48 
mp
*

49 
	$mp£¨ch
()

51 
uch¨
 *
bda
;

52 
uöt
 
p
;

53 
mp
 *mp;

55 
bda
 = (
uch¨
 *Ë
	`P2V
(0x400);

56 if((
p
 = ((
bda
[0x0F]<<8)| bda[0x0E]) << 4)){

57 if((
mp
 = 
	`mp£¨ch1
(
p
, 1024)))

58  
mp
;

60 
p
 = ((
bda
[0x14]<<8)|bda[0x13])*1024;

61 if((
mp
 = 
	`mp£¨ch1
(
p
-1024, 1024)))

62  
mp
;

64  
	`mp£¨ch1
(0xF0000, 0x10000);

65 
	}
}

72 
mpc⁄f
*

73 
	$mpc⁄fig
(
mp
 **
pmp
)

75 
mpc⁄f
 *
c⁄f
;

76 
mp
 *mp;

78 if((
mp
 = 
	`mp£¨ch
()Ë=0 || mp->
phyßddr
 == 0)

80 
c⁄f
 = (
mpc⁄f
*Ë
	`P2V
((
uöt
Ë
mp
->
phyßddr
);

81 if(
	`memcmp
(
c⁄f
, "PCMP", 4) != 0)

83 if(
c⁄f
->
vîsi⁄
 != 1 && conf->version != 4)

85 if(
	`sum
((
uch¨
*)
c⁄f
, c⁄f->
Àngth
) != 0)

87 *
pmp
 = 
mp
;

88  
c⁄f
;

89 
	}
}

92 
	$mpöô
()

94 
uch¨
 *
p
, *
e
;

95 
ismp
;

96 
mp
 *mp;

97 
mpc⁄f
 *
c⁄f
;

98 
mµroc
 *
¥oc
;

99 
mpiﬂpic
 *
iﬂpic
;

101 if((
c⁄f
 = 
	`mpc⁄fig
(&
mp
)) == 0)

102 
	`∑nic
("ExpectÅoÑun onán SMP");

103 
ismp
 = 1;

104 
œpic
 = (
uöt
*)
c⁄f
->
œpiˇddr
;

105 
p
=(
uch¨
*)(
c⁄f
+1), 
e
=(uch¨*)c⁄f+c⁄f->
Àngth
;Ö<e; ){

106 *
p
){

107 
MPPROC
:

108 
¥oc
 = (
mµroc
*)
p
;

109 if(
n˝u
 < 
NCPU
) {

110 
˝us
[
n˝u
].
≠icid
 = 
¥oc
->apicid;

111 
n˝u
++;

113 
p
 +(
mµroc
);

115 
MPIOAPIC
:

116 
iﬂpic
 = (
mpiﬂpic
*)
p
;

117 
iﬂpicid
 = 
iﬂpic
->
≠i˙o
;

118 
p
 +(
mpiﬂpic
);

120 
MPBUS
:

121 
MPIOINTR
:

122 
MPLINTR
:

123 
p
 += 8;

126 
ismp
 = 0;

130 if(!
ismp
)

131 
	`∑nic
("Didn't findá suitable machine");

133 if(
mp
->
im¸p
){

136 
	`outb
(0x22, 0x70);

137 
	`outb
(0x23, 
	`öb
(0x23) | 1);

139 
	}
}

	@mp.h

3 
	smp
 {

4 
uch¨
 
	msig«tuª
[4];

5 *
	mphyßddr
;

6 
uch¨
 
	mÀngth
;

7 
uch¨
 
	m•e¸ev
;

8 
uch¨
 
	mchecksum
;

9 
uch¨
 
	mty≥
;

10 
uch¨
 
	mim¸p
;

11 
uch¨
 
	mª£rved
[3];

14 
	smpc⁄f
 {

15 
uch¨
 
	msig«tuª
[4];

16 
ush‹t
 
	mÀngth
;

17 
uch¨
 
	mvîsi⁄
;

18 
uch¨
 
	mchecksum
;

19 
uch¨
 
	m¥odu˘
[20];

20 
uöt
 *
	m€mèbÀ
;

21 
ush‹t
 
	m€mÀngth
;

22 
ush‹t
 
	míåy
;

23 
uöt
 *
	mœpiˇddr
;

24 
ush‹t
 
	mxÀngth
;

25 
uch¨
 
	mxchecksum
;

26 
uch¨
 
	mª£rved
;

29 
	smµroc
 {

30 
uch¨
 
	mty≥
;

31 
uch¨
 
	m≠icid
;

32 
uch¨
 
	mvîsi⁄
;

33 
uch¨
 
	mÊags
;

34 
	#MPBOOT
 0x02

35 
uch¨
 
sig«tuª
[4];

36 
uöt
 
„©uª
;

37 
uch¨
 
ª£rved
[8];

	)

40 
	smpiﬂpic
 {

41 
uch¨
 
	mty≥
;

42 
uch¨
 
	m≠i˙o
;

43 
uch¨
 
	mvîsi⁄
;

44 
uch¨
 
	mÊags
;

45 
uöt
 *
	maddr
;

49 
	#MPPROC
 0x00

50 
	#MPBUS
 0x01

51 
	#MPIOAPIC
 0x02

52 
	#MPIOINTR
 0x03

53 
	#MPLINTR
 0x04

54 

	)

	@param.h

1 
	#NPROC
 64

2 
	#KSTACKSIZE
 4096

3 
	#NCPU
 8

4 
	#NOFILE
 16

5 
	#NFILE
 100

6 
	#NINODE
 50

7 
	#NDEV
 10

8 
	#ROOTDEV
 1

9 
	#MAXARG
 32

10 
	#MAXOPBLOCKS
 10

11 
	#LOGSIZE
 (
MAXOPBLOCKS
*3)

12 
	#NBUF
 (
MAXOPBLOCKS
*3)

13 
	#FSSIZE
 1000

14 

	)

	@picirq.c

1 
	~"ty≥s.h
"

2 
	~"x86.h
"

3 
	~"å≠s.h
"

6 
	#IO_PIC1
 0x20

7 
	#IO_PIC2
 0xA0

8 

	)

11 
	$picöô
()

14 
	`outb
(
IO_PIC1
+1, 0xFF);

15 
	`outb
(
IO_PIC2
+1, 0xFF);

16 
	}
}

	@pipe.c

1 
	~"ty≥s.h
"

2 
	~"defs.h
"

3 
	~"∑øm.h
"

4 
	~"mmu.h
"

5 
	~"¥oc.h
"

6 
	~"fs.h
"

7 
	~"•ölock.h
"

8 
	~"¶ì∂ock.h
"

9 
	~"fûe.h
"

11 
	#PIPESIZE
 512

	)

13 
	spùe
 {

14 
•ölock
 
	mlock
;

15 
	md©a
[
PIPESIZE
];

16 
uöt
 
	mƒód
;

17 
uöt
 
	mnwrôe
;

18 
	mªad›í
;

19 
	mwrôe›í
;

23 
	$pùóŒoc
(
fûe
 **
f0
, fûê**
f1
)

25 
pùe
 *
p
;

27 
p
 = 0;

28 *
f0
 = *
f1
 = 0;

29 if((*
f0
 = 
	`fûóŒoc
()Ë=0 || (*
f1
 = filealloc()) == 0)

30 
bad
;

31 if((
p
 = (
pùe
*)
	`kÆloc
()) == 0)

32 
bad
;

33 
p
->
ªad›í
 = 1;

34 
p
->
wrôe›í
 = 1;

35 
p
->
nwrôe
 = 0;

36 
p
->
ƒód
 = 0;

37 
	`öôlock
(&
p
->
lock
, "pipe");

38 (*
f0
)->
ty≥
 = 
FD_PIPE
;

39 (*
f0
)->
ªadabÀ
 = 1;

40 (*
f0
)->
wrôabÀ
 = 0;

41 (*
f0
)->
pùe
 = 
p
;

42 (*
f1
)->
ty≥
 = 
FD_PIPE
;

43 (*
f1
)->
ªadabÀ
 = 0;

44 (*
f1
)->
wrôabÀ
 = 1;

45 (*
f1
)->
pùe
 = 
p
;

49 
bad
:

50 if(
p
)

51 
	`k‰ì
((*)
p
);

52 if(*
f0
)

53 
	`fûe˛o£
(*
f0
);

54 if(*
f1
)

55 
	`fûe˛o£
(*
f1
);

57 
	}
}

60 
	$pùe˛o£
(
pùe
 *
p
, 
wrôabÀ
)

62 
	`acquúe
(&
p
->
lock
);

63 if(
wrôabÀ
){

64 
p
->
wrôe›í
 = 0;

65 
	`wakeup
(&
p
->
ƒód
);

67 
p
->
ªad›í
 = 0;

68 
	`wakeup
(&
p
->
nwrôe
);

70 if(
p
->
ªad›í
 =0 &&Ö->
wrôe›í
 == 0){

71 
	`ªÀa£
(&
p
->
lock
);

72 
	`k‰ì
((*)
p
);

74 
	`ªÀa£
(&
p
->
lock
);

75 
	}
}

79 
	$pùewrôe
(
pùe
 *
p
, *
addr
, 
n
)

81 
i
;

83 
	`acquúe
(&
p
->
lock
);

84 
i
 = 0; i < 
n
; i++){

85 
p
->
nwrôe
 =p->
ƒód
 + 
PIPESIZE
){

86 if(
p
->
ªad›í
 =0 || 
	`my¥oc
()->
kûÀd
){

87 
	`ªÀa£
(&
p
->
lock
);

90 
	`wakeup
(&
p
->
ƒód
);

91 
	`¶ìp
(&
p
->
nwrôe
, &p->
lock
);

93 
p
->
d©a
[p->
nwrôe
++ % 
PIPESIZE
] = 
addr
[
i
];

95 
	`wakeup
(&
p
->
ƒód
);

96 
	`ªÀa£
(&
p
->
lock
);

97  
n
;

98 
	}
}

101 
	$pùîód
(
pùe
 *
p
, *
addr
, 
n
)

103 
i
;

105 
	`acquúe
(&
p
->
lock
);

106 
p
->
ƒód
 =p->
nwrôe
 &&Ö->
wrôe›í
){

107 if(
	`my¥oc
()->
kûÀd
){

108 
	`ªÀa£
(&
p
->
lock
);

111 
	`¶ìp
(&
p
->
ƒód
, &p->
lock
);

113 
i
 = 0; i < 
n
; i++){

114 if(
p
->
ƒód
 =p->
nwrôe
)

116 
addr
[
i
] = 
p
->
d©a
[p->
ƒód
++ % 
PIPESIZE
];

118 
	`wakeup
(&
p
->
nwrôe
);

119 
	`ªÀa£
(&
p
->
lock
);

120  
i
;

121 
	}
}

	@printf.c

1 
	~"ty≥s.h
"

2 
	~"°©.h
"

3 
	~"u£r.h
"

6 
	$putc
(
fd
, 
c
)

8 
	`wrôe
(
fd
, &
c
, 1);

9 
	}
}

12 
	$¥ötöt
(
fd
, 
xx
, 
ba£
, 
sgn
)

14 
digôs
[] = "0123456789ABCDEF";

15 
buf
[16];

16 
i
, 
√g
;

17 
uöt
 
x
;

19 
√g
 = 0;

20 if(
sgn
 && 
xx
 < 0){

21 
√g
 = 1;

22 
x
 = -
xx
;

24 
x
 = 
xx
;

27 
i
 = 0;

29 
buf
[
i
++] = 
digôs
[
x
 % 
ba£
];

30 }(
x
 /
ba£
) != 0);

31 if(
√g
)

32 
buf
[
i
++] = '-';

34 --
i
 >= 0)

35 
	`putc
(
fd
, 
buf
[
i
]);

36 
	}
}

40 
	$¥ötf
(
fd
, c⁄° *
fmt
, ...)

42 *
s
;

43 
c
, 
i
, 
°©e
;

44 
uöt
 *
≠
;

46 
°©e
 = 0;

47 
≠
 = (
uöt
*)(*)&
fmt
 + 1;

48 
i
 = 0; 
fmt
[i]; i++){

49 
c
 = 
fmt
[
i
] & 0xff;

50 if(
°©e
 == 0){

51 if(
c
 == '%'){

52 
°©e
 = '%';

54 
	`putc
(
fd
, 
c
);

56 } if(
°©e
 == '%'){

57 if(
c
 == 'd'){

58 
	`¥ötöt
(
fd
, *
≠
, 10, 1);

59 
≠
++;

60 } if(
c
 == 'x' || c == 'p'){

61 
	`¥ötöt
(
fd
, *
≠
, 16, 0);

62 
≠
++;

63 } if(
c
 == 's'){

64 
s
 = (*)*
≠
;

65 
≠
++;

66 if(
s
 == 0)

67 
s
 = "(null)";

68 *
s
 != 0){

69 
	`putc
(
fd
, *
s
);

70 
s
++;

72 } if(
c
 == 'c'){

73 
	`putc
(
fd
, *
≠
);

74 
≠
++;

75 } if(
c
 == '%'){

76 
	`putc
(
fd
, 
c
);

79 
	`putc
(
fd
, '%');

80 
	`putc
(
fd
, 
c
);

82 
°©e
 = 0;

85 
	}
}

	@proc.c

1 
	~"ty≥s.h
"

2 
	~"defs.h
"

3 
	~"∑øm.h
"

4 
	~"memœyout.h
"

5 
	~"mmu.h
"

6 
	~"x86.h
"

7 
	~"¥oc.h
"

8 
	~"•ölock.h
"

11 
•ölock
 
	mlock
;

12 
¥oc
 
	m¥oc
[
NPROC
];

13 } 
	g±abÀ
;

15 
¥oc
 *
	göô¥oc
;

17 
	g√xçid
 = 1;

18 
f‹kªt
();

19 
å≠ªt
();

21 
wakeup1
(*
ch™
);

24 
	$pöô
()

26 
	`öôlock
(&
±abÀ
.
lock
, "ptable");

27 
	}
}

31 
	$˝uid
() {

32  
	`my˝u
()-
˝us
;

33 
	}
}

37 
˝u
*

38 
	$my˝u
()

40 
≠icid
, 
i
;

42 if(
	`ªadeÊags
()&
FL_IF
)

43 
	`∑nic
("mycpu called with interruptsÉnabled\n");

45 
≠icid
 = 
	`œpicid
();

48 
i
 = 0; i < 
n˝u
; ++i) {

49 i‡(
˝us
[
i
].
≠icid
 ==ápicid)

50  &
˝us
[
i
];

52 
	`∑nic
("unknownápicid\n");

53 
	}
}

57 
¥oc
*

58 
	$my¥oc
() {

59 
˝u
 *
c
;

60 
¥oc
 *
p
;

61 
	`push˛i
();

62 
c
 = 
	`my˝u
();

63 
p
 = 
c
->
¥oc
;

64 
	`p›˛i
();

65  
p
;

66 
	}
}

73 
¥oc
*

74 
	$Ælo˝roc
()

76 
¥oc
 *
p
;

77 *
•
;

79 
	`acquúe
(&
±abÀ
.
lock
);

81 
p
 = 
±abÀ
.
¥oc
;Ö < &±abÀ.¥oc[
NPROC
];Ö++)

82 if(
p
->
°©e
 =
UNUSED
)

83 
found
;

85 
	`ªÀa£
(&
±abÀ
.
lock
);

88 
found
:

89 
p
->
°©e
 = 
EMBRYO
;

90 
p
->
pid
 = 
√xçid
++;

92 
	`ªÀa£
(&
±abÀ
.
lock
);

95 if((
p
->
k°ack
 = 
	`kÆloc
()) == 0){

96 
p
->
°©e
 = 
UNUSED
;

99 
•
 = 
p
->
k°ack
 + 
KSTACKSIZE
;

102 
•
 - *
p
->
tf
;

103 
p
->
tf
 = (
å≠‰ame
*)
•
;

107 
•
 -= 4;

108 *(
uöt
*)
•
 = (uöt)
å≠ªt
;

110 
•
 - *
p
->
c⁄ãxt
;

111 
p
->
c⁄ãxt
 = (c⁄ãxt*)
•
;

112 
	`mem£t
(
p
->
c⁄ãxt
, 0,  *p->context);

113 
p
->
c⁄ãxt
->
eù
 = (
uöt
)
f‹kªt
;

115  
p
;

116 
	}
}

121 
	$u£röô
()

123 
¥oc
 *
p
;

124 
_bö¨y_öôcode_°¨t
[], 
_bö¨y_öôcode_size
[];

126 
p
 = 
	`Ælo˝roc
();

128 
öô¥oc
 = 
p
;

129 if((
p
->
pgdú
 = 
	`£tupkvm
()) == 0)

130 
	`∑nic
("userinit: out of memory?");

131 
	`öôuvm
(
p
->
pgdú
, 
_bö¨y_öôcode_°¨t
, ()
_bö¨y_öôcode_size
);

132 
p
->
sz
 = 
PGSIZE
;

133 
	`mem£t
(
p
->
tf
, 0, (*p->tf));

134 
p
->
tf
->
cs
 = (
SEG_UCODE
 << 3Ë| 
DPL_USER
;

135 
p
->
tf
->
ds
 = (
SEG_UDATA
 << 3Ë| 
DPL_USER
;

136 
p
->
tf
->
es
 =Ö->tf->
ds
;

137 
p
->
tf
->
ss
 =Ö->tf->
ds
;

138 
p
->
tf
->
eÊags
 = 
FL_IF
;

139 
p
->
tf
->
e•
 = 
PGSIZE
;

140 
p
->
tf
->
eù
 = 0;

142 
	`ß„°r˝y
(
p
->
«me
, "initcode", (p->name));

143 
p
->
cwd
 = 
	`«mei
("/");

149 
	`acquúe
(&
±abÀ
.
lock
);

151 
p
->
°©e
 = 
RUNNABLE
;

153 
	`ªÀa£
(&
±abÀ
.
lock
);

154 
	}
}

159 
	$grow¥oc
(
n
)

161 
uöt
 
sz
;

162 
¥oc
 *
cuΩroc
 = 
	`my¥oc
();

164 
sz
 = 
cuΩroc
->sz;

165 if(
n
 > 0){

166 if((
sz
 = 
	`Ælocuvm
(
cuΩroc
->
pgdú
, sz, sz + 
n
)) == 0)

168 } if(
n
 < 0){

169 if((
sz
 = 
	`dóŒocuvm
(
cuΩroc
->
pgdú
, sz, sz + 
n
)) == 0)

172 
cuΩroc
->
sz
 = sz;

173 
	`swôchuvm
(
cuΩroc
);

175 
	}
}

181 
	$f‹k
()

183 
i
, 
pid
;

184 
¥oc
 *
≈
;

185 
¥oc
 *
cuΩroc
 = 
	`my¥oc
();

188 if((
≈
 = 
	`Ælo˝roc
()) == 0){

193 if((
≈
->
pgdú
 = 
	`c›yuvm
(
cuΩroc
->pgdú, cuΩroc->
sz
)) == 0){

194 
	`k‰ì
(
≈
->
k°ack
);

195 
≈
->
k°ack
 = 0;

196 
≈
->
°©e
 = 
UNUSED
;

199 
≈
->
sz
 = 
cuΩroc
->sz;

200 
≈
->
∑ª¡
 = 
cuΩroc
;

201 *
≈
->
tf
 = *
cuΩroc
->tf;

204 
≈
->
tf
->
óx
 = 0;

206 
i
 = 0; i < 
NOFILE
; i++)

207 if(
cuΩroc
->
ofûe
[
i
])

208 
≈
->
ofûe
[
i
] = 
	`fûedup
(
cuΩroc
->ofile[i]);

209 
≈
->
cwd
 = 
	`idup
(
cuΩroc
->cwd);

211 
	`ß„°r˝y
(
≈
->
«me
, 
cuΩroc
->name, (curproc->name));

213 
pid
 = 
≈
->pid;

215 
	`acquúe
(&
±abÀ
.
lock
);

217 
≈
->
°©e
 = 
RUNNABLE
;

219 
	`ªÀa£
(&
±abÀ
.
lock
);

221  
pid
;

222 
	}
}

228 
	$exô
()

230 
¥oc
 *
cuΩroc
 = 
	`my¥oc
();

231 
¥oc
 *
p
;

232 
fd
;

234 if(
cuΩroc
 =
öô¥oc
)

235 
	`∑nic
("initÉxiting");

238 
fd
 = 0; fd < 
NOFILE
; fd++){

239 if(
cuΩroc
->
ofûe
[
fd
]){

240 
	`fûe˛o£
(
cuΩroc
->
ofûe
[
fd
]);

241 
cuΩroc
->
ofûe
[
fd
] = 0;

245 
	`begö_›
();

246 
	`ùut
(
cuΩroc
->
cwd
);

247 
	`íd_›
();

248 
cuΩroc
->
cwd
 = 0;

250 
	`acquúe
(&
±abÀ
.
lock
);

253 
	`wakeup1
(
cuΩroc
->
∑ª¡
);

256 
p
 = 
±abÀ
.
¥oc
;Ö < &±abÀ.¥oc[
NPROC
];Ö++){

257 if(
p
->
∑ª¡
 =
cuΩroc
){

258 
p
->
∑ª¡
 = 
öô¥oc
;

259 if(
p
->
°©e
 =
ZOMBIE
)

260 
	`wakeup1
(
öô¥oc
);

265 
cuΩroc
->
°©e
 = 
ZOMBIE
;

266 
	`sched
();

267 
	`∑nic
("zombieÉxit");

268 
	}
}

273 
	$waô
()

275 
¥oc
 *
p
;

276 
havekids
, 
pid
;

277 
¥oc
 *
cuΩroc
 = 
	`my¥oc
();

279 
	`acquúe
(&
±abÀ
.
lock
);

282 
havekids
 = 0;

283 
p
 = 
±abÀ
.
¥oc
;Ö < &±abÀ.¥oc[
NPROC
];Ö++){

284 if(
p
->
∑ª¡
 !
cuΩroc
)

286 
havekids
 = 1;

287 if(
p
->
°©e
 =
ZOMBIE
){

289 
pid
 = 
p
->pid;

290 
	`k‰ì
(
p
->
k°ack
);

291 
p
->
k°ack
 = 0;

292 
	`‰ìvm
(
p
->
pgdú
);

293 
p
->
pid
 = 0;

294 
p
->
∑ª¡
 = 0;

295 
p
->
«me
[0] = 0;

296 
p
->
kûÀd
 = 0;

297 
p
->
°©e
 = 
UNUSED
;

298 
	`ªÀa£
(&
±abÀ
.
lock
);

299  
pid
;

304 if(!
havekids
 || 
cuΩroc
->
kûÀd
){

305 
	`ªÀa£
(&
±abÀ
.
lock
);

310 
	`¶ìp
(
cuΩroc
, &
±abÀ
.
lock
);

312 
	}
}

323 
	$scheduÀr
()

325 
¥oc
 *
p
;

326 
˝u
 *
c
 = 
	`my˝u
();

327 
c
->
¥oc
 = 0;

331 
	`°i
();

334 
	`acquúe
(&
±abÀ
.
lock
);

335 
p
 = 
±abÀ
.
¥oc
;Ö < &±abÀ.¥oc[
NPROC
];Ö++){

336 if(
p
->
°©e
 !
RUNNABLE
)

342 
c
->
¥oc
 = 
p
;

343 
	`swôchuvm
(
p
);

344 
p
->
°©e
 = 
RUNNING
;

346 
	`swtch
(&(
c
->
scheduÀr
), 
p
->
c⁄ãxt
);

347 
	`swôchkvm
();

351 
c
->
¥oc
 = 0;

353 
	`ªÀa£
(&
±abÀ
.
lock
);

356 
	}
}

366 
	$sched
()

368 
öã«
;

369 
¥oc
 *
p
 = 
	`my¥oc
();

371 if(!
	`hﬁdög
(&
±abÀ
.
lock
))

372 
	`∑nic
("schedÖtable.lock");

373 if(
	`my˝u
()->
n˛i
 != 1)

374 
	`∑nic
("schedÜocks");

375 if(
p
->
°©e
 =
RUNNING
)

376 
	`∑nic
("schedÑunning");

377 if(
	`ªadeÊags
()&
FL_IF
)

378 
	`∑nic
("sched interruptible");

379 
öã«
 = 
	`my˝u
()->intena;

380 
	`swtch
(&
p
->
c⁄ãxt
, 
	`my˝u
()->
scheduÀr
);

381 
	`my˝u
()->
öã«
 = intena;

382 
	}
}

386 
	$yõld
()

388 
	`acquúe
(&
±abÀ
.
lock
);

389 
	`my¥oc
()->
°©e
 = 
RUNNABLE
;

390 
	`sched
();

391 
	`ªÀa£
(&
±abÀ
.
lock
);

392 
	}
}

397 
	$f‹kªt
()

399 
fú°
 = 1;

401 
	`ªÀa£
(&
±abÀ
.
lock
);

403 i‡(
fú°
) {

407 
fú°
 = 0;

408 
	`iöô
(
ROOTDEV
);

409 
	`öôlog
(
ROOTDEV
);

413 
	}
}

418 
	$¶ìp
(*
ch™
, 
•ölock
 *
lk
)

420 
¥oc
 *
p
 = 
	`my¥oc
();

422 if(
p
 == 0)

423 
	`∑nic
("sleep");

425 if(
lk
 == 0)

426 
	`∑nic
("sleep withoutÜk");

434 if(
lk
 !&
±abÀ
.
lock
){

435 
	`acquúe
(&
±abÀ
.
lock
);

436 
	`ªÀa£
(
lk
);

439 
p
->
ch™
 = chan;

440 
p
->
°©e
 = 
SLEEPING
;

442 
	`sched
();

445 
p
->
ch™
 = 0;

448 if(
lk
 !&
±abÀ
.
lock
){

449 
	`ªÀa£
(&
±abÀ
.
lock
);

450 
	`acquúe
(
lk
);

452 
	}
}

458 
	$wakeup1
(*
ch™
)

460 
¥oc
 *
p
;

462 
p
 = 
±abÀ
.
¥oc
;Ö < &±abÀ.¥oc[
NPROC
];Ö++)

463 if(
p
->
°©e
 =
SLEEPING
 &&Ö->
ch™
 == chan)

464 
p
->
°©e
 = 
RUNNABLE
;

465 
	}
}

469 
	$wakeup
(*
ch™
)

471 
	`acquúe
(&
±abÀ
.
lock
);

472 
	`wakeup1
(
ch™
);

473 
	`ªÀa£
(&
±abÀ
.
lock
);

474 
	}
}

480 
	$kûl
(
pid
)

482 
¥oc
 *
p
;

484 
	`acquúe
(&
±abÀ
.
lock
);

485 
p
 = 
±abÀ
.
¥oc
;Ö < &±abÀ.¥oc[
NPROC
];Ö++){

486 if(
p
->
pid
 ==Öid){

487 
p
->
kûÀd
 = 1;

489 if(
p
->
°©e
 =
SLEEPING
)

490 
p
->
°©e
 = 
RUNNABLE
;

491 
	`ªÀa£
(&
±abÀ
.
lock
);

495 
	`ªÀa£
(&
±abÀ
.
lock
);

497 
	}
}

504 
	$¥ocdump
()

506 *
°©es
[] = {

507 [
UNUSED
] "unused",

508 [
EMBRYO
] "embryo",

509 [
SLEEPING
] "sleep ",

510 [
RUNNABLE
] "runble",

511 [
RUNNING
] "run ",

512 [
ZOMBIE
] "zombie"

514 
i
;

515 
¥oc
 *
p
;

516 *
°©e
;

517 
uöt
 
pc
[10];

519 
p
 = 
±abÀ
.
¥oc
;Ö < &±abÀ.¥oc[
NPROC
];Ö++){

520 if(
p
->
°©e
 =
UNUSED
)

522 if(
p
->
°©e
 >0 &&Ö->°©ê< 
	`NELEM
(
°©es
) && states[p->state])

523 
°©e
 = 
°©es
[
p
->state];

525 
°©e
 = "???";

526 
	`˝rötf
("%d %†%s", 
p
->
pid
, 
°©e
,Ö->
«me
);

527 if(
p
->
°©e
 =
SLEEPING
){

528 
	`gëˇŒîpcs
((
uöt
*)
p
->
c⁄ãxt
->
ebp
+2, 
pc
);

529 
i
=0; i<10 && 
pc
[i] != 0; i++)

530 
	`˝rötf
(" %p", 
pc
[
i
]);

532 
	`˝rötf
("\n");

534 
	}
}

	@proc.h

2 
	s˝u
 {

3 
uch¨
 
	m≠icid
;

4 
c⁄ãxt
 *
	mscheduÀr
;

5 
èsk°©e
 
	mts
;

6 
£gdesc
 
	mgdt
[
NSEGS
];

7 vﬁ©ûê
uöt
 
	m°¨ãd
;

8 
	mn˛i
;

9 
	möã«
;

10 
¥oc
 *
	m¥oc
;

13 
˝u
 
˝us
[
NCPU
];

14 
n˝u
;

27 
	sc⁄ãxt
 {

28 
uöt
 
	medi
;

29 
uöt
 
	mesi
;

30 
uöt
 
	mebx
;

31 
uöt
 
	mebp
;

32 
uöt
 
	meù
;

35 
	e¥oc°©e
 { 
	mUNUSED
, 
	mEMBRYO
, 
	mSLEEPING
, 
	mRUNNABLE
, 
	mRUNNING
, 
	mZOMBIE
 };

38 
	s¥oc
 {

39 
uöt
 
	msz
;

40 
pde_t
* 
	mpgdú
;

41 *
	mk°ack
;

42 
¥oc°©e
 
	m°©e
;

43 
	mpid
;

44 
¥oc
 *
	m∑ª¡
;

45 
å≠‰ame
 *
	mtf
;

46 
c⁄ãxt
 *
	mc⁄ãxt
;

47 *
	mch™
;

48 
	mkûÀd
;

49 
fûe
 *
	mofûe
[
NOFILE
];

50 
öode
 *
	mcwd
;

51 
	m«me
[16];

	@sleeplock.c

3 
	~"ty≥s.h
"

4 
	~"defs.h
"

5 
	~"∑øm.h
"

6 
	~"x86.h
"

7 
	~"memœyout.h
"

8 
	~"mmu.h
"

9 
	~"¥oc.h
"

10 
	~"•ölock.h
"

11 
	~"¶ì∂ock.h
"

14 
	$öô¶ì∂ock
(
¶ì∂ock
 *
lk
, *
«me
)

16 
	`öôlock
(&
lk
->lk, "sleepÜock");

17 
lk
->
«me
 =Çame;

18 
lk
->
locked
 = 0;

19 
lk
->
pid
 = 0;

20 
	}
}

23 
	$acquúe¶ìp
(
¶ì∂ock
 *
lk
)

25 
	`acquúe
(&
lk
->lk);

26 
lk
->
locked
) {

27 
	`¶ìp
(
lk
, &lk->lk);

29 
lk
->
locked
 = 1;

30 
lk
->
pid
 = 
	`my¥oc
()->pid;

31 
	`ªÀa£
(&
lk
->lk);

32 
	}
}

35 
	$ªÀa£¶ìp
(
¶ì∂ock
 *
lk
)

37 
	`acquúe
(&
lk
->lk);

38 
lk
->
locked
 = 0;

39 
lk
->
pid
 = 0;

40 
	`wakeup
(
lk
);

41 
	`ªÀa£
(&
lk
->lk);

42 
	}
}

45 
	$hﬁdög¶ìp
(
¶ì∂ock
 *
lk
)

47 
r
;

49 
	`acquúe
(&
lk
->lk);

50 
r
 = 
lk
->
locked
 && (lk->
pid
 =
	`my¥oc
()->pid);

51 
	`ªÀa£
(&
lk
->lk);

52  
r
;

53 
	}
}

	@sleeplock.h

2 
	s¶ì∂ock
 {

3 
uöt
 
	mlocked
;

4 
•ölock
 
	mlk
;

7 *
	m«me
;

8 
	mpid
;

	@spinlock.c

3 
	~"ty≥s.h
"

4 
	~"defs.h
"

5 
	~"∑øm.h
"

6 
	~"x86.h
"

7 
	~"memœyout.h
"

8 
	~"mmu.h
"

9 
	~"¥oc.h
"

10 
	~"•ölock.h
"

13 
	$öôlock
(
•ölock
 *
lk
, *
«me
)

15 
lk
->
«me
 =Çame;

16 
lk
->
locked
 = 0;

17 
lk
->
˝u
 = 0;

18 
	}
}

25 
	$acquúe
(
•ölock
 *
lk
)

27 
	`push˛i
();

28 if(
	`hﬁdög
(
lk
))

29 
	`∑nic
("acquire");

32 
	`xchg
(&
lk
->
locked
, 1) != 0)

38 
	`__sync_synchr⁄ize
();

41 
lk
->
˝u
 = 
	`my˝u
();

42 
	`gëˇŒîpcs
(&
lk
,Ük->
pcs
);

43 
	}
}

47 
	$ªÀa£
(
•ölock
 *
lk
)

49 if(!
	`hﬁdög
(
lk
))

50 
	`∑nic
("release");

52 
lk
->
pcs
[0] = 0;

53 
lk
->
˝u
 = 0;

60 
	`__sync_synchr⁄ize
();

65 
asm
 vﬁ©ûe("mov»$0, %0" : "+m" (
lk
->
locked
) : );

67 
	`p›˛i
();

68 
	}
}

72 
	$gëˇŒîpcs
(*
v
, 
uöt
 
pcs
[])

74 
uöt
 *
ebp
;

75 
i
;

77 
ebp
 = (
uöt
*)
v
 - 2;

78 
i
 = 0; i < 10; i++){

79 if(
ebp
 =0 ||Éb∞< (
uöt
*)
KERNBASE
 ||Ébp == (uint*)0xffffffff)

81 
pcs
[
i
] = 
ebp
[1];

82 
ebp
 = (
uöt
*)ebp[0];

84 ; 
i
 < 10; i++)

85 
pcs
[
i
] = 0;

86 
	}
}

90 
	$hﬁdög
(
•ölock
 *
lock
)

92 
r
;

93 
	`push˛i
();

94 
r
 = 
lock
->
locked
 &&Üock->
˝u
 =
	`my˝u
();

95 
	`p›˛i
();

96  
r
;

97 
	}
}

105 
	$push˛i
()

107 
eÊags
;

109 
eÊags
 = 
	`ªadeÊags
();

110 
	`˛i
();

111 if(
	`my˝u
()->
n˛i
 == 0)

112 
	`my˝u
()->
öã«
 = 
eÊags
 & 
FL_IF
;

113 
	`my˝u
()->
n˛i
 += 1;

114 
	}
}

117 
	$p›˛i
()

119 if(
	`ªadeÊags
()&
FL_IF
)

120 
	`∑nic
("popcli - interruptible");

121 if(--
	`my˝u
()->
n˛i
 < 0)

122 
	`∑nic
("popcli");

123 if(
	`my˝u
()->
n˛i
 =0 && my˝u()->
öã«
)

124 
	`°i
();

125 
	}
}

	@spinlock.h

2 
	s•ölock
 {

3 
uöt
 
	mlocked
;

6 *
	m«me
;

7 
˝u
 *
	m˝u
;

8 
uöt
 
	mpcs
[10];

	@stat.h

1 
	#T_DIR
 1

2 
	#T_FILE
 2

3 
	#T_DEV
 3

4 

	)

5 
	s°©
 {

6 
	mty≥
;

7 
	mdev
;

8 
uöt
 
	möo
;

9 
	m∆ök
;

10 
uöt
 
	msize
;

	@string.c

1 
	~"ty≥s.h
"

2 
	~"x86.h
"

5 
	$mem£t
(*
d°
, 
c
, 
uöt
 
n
)

7 i‡(()
d°
%4 =0 && 
n
%4 == 0){

8 
c
 &= 0xFF;

9 
	`°o¶
(
d°
, (
c
<<24)|(c<<16)|(c<<8)|c, 
n
/4);

11 
	`°osb
(
d°
, 
c
, 
n
);

12  
d°
;

13 
	}
}

16 
	$memcmp
(c⁄° *
v1
, c⁄° *
v2
, 
uöt
 
n
)

18 c⁄° 
uch¨
 *
s1
, *
s2
;

20 
s1
 = 
v1
;

21 
s2
 = 
v2
;

22 
n
-- > 0){

23 if(*
s1
 !*
s2
)

24  *
s1
 - *
s2
;

25 
s1
++, 
s2
++;

29 
	}
}

32 
	$memmove
(*
d°
, c⁄° *
§c
, 
uöt
 
n
)

34 c⁄° *
s
;

35 *
d
;

37 
s
 = 
§c
;

38 
d
 = 
d°
;

39 if(
s
 < 
d
 && s + 
n
 > d){

40 
s
 +
n
;

41 
d
 +
n
;

42 
n
-- > 0)

43 *--
d
 = *--
s
;

45 
n
-- > 0)

46 *
d
++ = *
s
++;

48  
d°
;

49 
	}
}

53 
	$mem˝y
(*
d°
, c⁄° *
§c
, 
uöt
 
n
)

55  
	`memmove
(
d°
, 
§c
, 
n
);

56 
	}
}

59 
	$°∫cmp
(c⁄° *
p
, c⁄° *
q
, 
uöt
 
n
)

61 
n
 > 0 && *
p
 && *∞=*
q
)

62 
n
--, 
p
++, 
q
++;

63 if(
n
 == 0)

65  (
uch¨
)*
p
 - (uch¨)*
q
;

66 
	}
}

69 
	$°∫˝y
(*
s
, c⁄° *
t
, 
n
)

71 *
os
;

73 
os
 = 
s
;

74 
n
-- > 0 && (*
s
++ = *
t
++) != 0)

76 
n
-- > 0)

77 *
s
++ = 0;

78  
os
;

79 
	}
}

83 
	$ß„°r˝y
(*
s
, c⁄° *
t
, 
n
)

85 *
os
;

87 
os
 = 
s
;

88 if(
n
 <= 0)

89  
os
;

90 --
n
 > 0 && (*
s
++ = *
t
++) != 0)

92 *
s
 = 0;

93  
os
;

94 
	}
}

97 
	$°æí
(c⁄° *
s
)

99 
n
;

101 
n
 = 0; 
s
[n];Ç++)

103  
n
;

104 
	}
}

	@syscall.c

1 
	~"ty≥s.h
"

2 
	~"defs.h
"

3 
	~"∑øm.h
"

4 
	~"memœyout.h
"

5 
	~"mmu.h
"

6 
	~"¥oc.h
"

7 
	~"x86.h
"

8 
	~"sysˇŒ.h
"

18 
	$„tchöt
(
uöt
 
addr
, *
ù
)

20 
¥oc
 *
cuΩroc
 = 
	`my¥oc
();

22 if(
addr
 >
cuΩroc
->
sz
 ||áddr+4 > curproc->sz)

24 *
ù
 = *(*)(
addr
);

26 
	}
}

32 
	$„tch°r
(
uöt
 
addr
, **
µ
)

34 *
s
, *
ï
;

35 
¥oc
 *
cuΩroc
 = 
	`my¥oc
();

37 if(
addr
 >
cuΩroc
->
sz
)

39 *
µ
 = (*)
addr
;

40 
ï
 = (*)
cuΩroc
->
sz
;

41 
s
 = *
µ
; s < 
ï
; s++){

42 if(*
s
 == 0)

43  
s
 - *
µ
;

46 
	}
}

50 
	$¨göt
(
n
, *
ù
)

52  
	`„tchöt
((
	`my¥oc
()->
tf
->
e•
Ë+ 4 + 4*
n
, 
ù
);

53 
	}
}

59 
	$¨g±r
(
n
, **
µ
, 
size
)

61 
i
;

62 
¥oc
 *
cuΩroc
 = 
	`my¥oc
();

64 if(
	`¨göt
(
n
, &
i
) < 0)

66 if(
size
 < 0 || (
uöt
)
i
 >
cuΩroc
->
sz
 || (uint)i+size > curproc->sz)

68 *
µ
 = (*)
i
;

70 
	}
}

77 
	$¨g°r
(
n
, **
µ
)

79 
addr
;

80 if(
	`¨göt
(
n
, &
addr
) < 0)

82  
	`„tch°r
(
addr
, 
µ
);

83 
	}
}

85 
sys_chdú
();

86 
sys_˛o£
();

87 
sys_dup
();

88 
sys_exec
();

89 
sys_exô
();

90 
sys_f‹k
();

91 
sys_f°©
();

92 
sys_gëpid
();

93 
sys_kûl
();

94 
sys_lök
();

95 
sys_mkdú
();

96 
sys_mknod
();

97 
sys_›í
();

98 
sys_pùe
();

99 
sys_ªad
();

100 
sys_sbrk
();

101 
sys_¶ìp
();

102 
sys_u∆ök
();

103 
sys_waô
();

104 
sys_wrôe
();

105 
sys_u±ime
();

107 (*
sysˇŒs
[])() = {

108 [
SYS_f‹k
] 
sys_f‹k
,

109 [
SYS_exô
] 
sys_exô
,

110 [
SYS_waô
] 
sys_waô
,

111 [
SYS_pùe
] 
sys_pùe
,

112 [
SYS_ªad
] 
sys_ªad
,

113 [
SYS_kûl
] 
sys_kûl
,

114 [
SYS_exec
] 
sys_exec
,

115 [
SYS_f°©
] 
sys_f°©
,

116 [
SYS_chdú
] 
sys_chdú
,

117 [
SYS_dup
] 
sys_dup
,

118 [
SYS_gëpid
] 
sys_gëpid
,

119 [
SYS_sbrk
] 
sys_sbrk
,

120 [
SYS_¶ìp
] 
sys_¶ìp
,

121 [
SYS_u±ime
] 
sys_u±ime
,

122 [
SYS_›í
] 
sys_›í
,

123 [
SYS_wrôe
] 
sys_wrôe
,

124 [
SYS_mknod
] 
sys_mknod
,

125 [
SYS_u∆ök
] 
sys_u∆ök
,

126 [
SYS_lök
] 
sys_lök
,

127 [
SYS_mkdú
] 
sys_mkdú
,

128 [
SYS_˛o£
] 
sys_˛o£
,

129 
	}
};

132 
	$sysˇŒ
()

134 
num
;

135 
¥oc
 *
cuΩroc
 = 
	`my¥oc
();

137 
num
 = 
cuΩroc
->
tf
->
óx
;

138 if(
num
 > 0 &&Çum < 
	`NELEM
(
sysˇŒs
) && syscalls[num]) {

139 
cuΩroc
->
tf
->
óx
 = 
sysˇŒs
[
num
]();

141 
	`˝rötf
("%d %s: unknown sys call %d\n",

142 
cuΩroc
->
pid
, cuΩroc->
«me
, 
num
);

143 
cuΩroc
->
tf
->
óx
 = -1;

145 
	}
}

	@syscall.h

2 
	#SYS_f‹k
 1

	)

3 
	#SYS_exô
 2

	)

4 
	#SYS_waô
 3

	)

5 
	#SYS_pùe
 4

	)

6 
	#SYS_ªad
 5

	)

7 
	#SYS_kûl
 6

	)

8 
	#SYS_exec
 7

	)

9 
	#SYS_f°©
 8

	)

10 
	#SYS_chdú
 9

	)

11 
	#SYS_dup
 10

	)

12 
	#SYS_gëpid
 11

	)

13 
	#SYS_sbrk
 12

	)

14 
	#SYS_¶ìp
 13

	)

15 
	#SYS_u±ime
 14

	)

16 
	#SYS_›í
 15

	)

17 
	#SYS_wrôe
 16

	)

18 
	#SYS_mknod
 17

	)

19 
	#SYS_u∆ök
 18

	)

20 
	#SYS_lök
 19

	)

21 
	#SYS_mkdú
 20

	)

22 
	#SYS_˛o£
 21

	)

	@sysfile.c

7 
	~"ty≥s.h
"

8 
	~"defs.h
"

9 
	~"∑øm.h
"

10 
	~"°©.h
"

11 
	~"mmu.h
"

12 
	~"¥oc.h
"

13 
	~"fs.h
"

14 
	~"•ölock.h
"

15 
	~"¶ì∂ock.h
"

16 
	~"fûe.h
"

17 
	~"f˙é.h
"

22 
	$¨gfd
(
n
, *
pfd
, 
fûe
 **
pf
)

24 
fd
;

25 
fûe
 *
f
;

27 if(
	`¨göt
(
n
, &
fd
) < 0)

29 if(
fd
 < 0 || fd >
NOFILE
 || (
f
=
	`my¥oc
()->
ofûe
[fd]) == 0)

31 if(
pfd
)

32 *
pfd
 = 
fd
;

33 if(
pf
)

34 *
pf
 = 
f
;

36 
	}
}

41 
	$fdÆloc
(
fûe
 *
f
)

43 
fd
;

44 
¥oc
 *
cuΩroc
 = 
	`my¥oc
();

46 
fd
 = 0; fd < 
NOFILE
; fd++){

47 if(
cuΩroc
->
ofûe
[
fd
] == 0){

48 
cuΩroc
->
ofûe
[
fd
] = 
f
;

49  
fd
;

53 
	}
}

56 
	$sys_dup
()

58 
fûe
 *
f
;

59 
fd
;

61 if(
	`¨gfd
(0, 0, &
f
) < 0)

63 if((
fd
=
	`fdÆloc
(
f
)) < 0)

65 
	`fûedup
(
f
);

66  
fd
;

67 
	}
}

70 
	$sys_ªad
()

72 
fûe
 *
f
;

73 
n
;

74 *
p
;

76 if(
	`¨gfd
(0, 0, &
f
Ë< 0 || 
	`¨göt
(2, &
n
Ë< 0 || 
	`¨g±r
(1, &
p
,Ç) < 0)

78  
	`fûîód
(
f
, 
p
, 
n
);

79 
	}
}

82 
	$sys_wrôe
()

84 
fûe
 *
f
;

85 
n
;

86 *
p
;

88 if(
	`¨gfd
(0, 0, &
f
Ë< 0 || 
	`¨göt
(2, &
n
Ë< 0 || 
	`¨g±r
(1, &
p
,Ç) < 0)

90  
	`fûewrôe
(
f
, 
p
, 
n
);

91 
	}
}

94 
	$sys_˛o£
()

96 
fd
;

97 
fûe
 *
f
;

99 if(
	`¨gfd
(0, &
fd
, &
f
) < 0)

101 
	`my¥oc
()->
ofûe
[
fd
] = 0;

102 
	`fûe˛o£
(
f
);

104 
	}
}

107 
	$sys_f°©
()

109 
fûe
 *
f
;

110 
°©
 *
°
;

112 if(
	`¨gfd
(0, 0, &
f
Ë< 0 || 
	`¨g±r
(1, (*)&
°
, (*st)) < 0)

114  
	`fûe°©
(
f
, 
°
);

115 
	}
}

119 
	$sys_lök
()

121 
«me
[
DIRSIZ
], *
√w
, *
ﬁd
;

122 
öode
 *
dp
, *
ù
;

124 if(
	`¨g°r
(0, &
ﬁd
Ë< 0 ||árg°r(1, &
√w
) < 0)

127 
	`begö_›
();

128 if((
ù
 = 
	`«mei
(
ﬁd
)) == 0){

129 
	`íd_›
();

133 
	`ûock
(
ù
);

134 if(
ù
->
ty≥
 =
T_DIR
){

135 
	`iu∆ockput
(
ù
);

136 
	`íd_›
();

140 
ù
->
∆ök
++;

141 
	`iupd©e
(
ù
);

142 
	`iu∆ock
(
ù
);

144 if((
dp
 = 
	`«meù¨ít
(
√w
, 
«me
)) == 0)

145 
bad
;

146 
	`ûock
(
dp
);

147 if(
dp
->
dev
 !
ù
->dev || 
	`dúlök
(dp, 
«me
, ip->
öum
) < 0){

148 
	`iu∆ockput
(
dp
);

149 
bad
;

151 
	`iu∆ockput
(
dp
);

152 
	`ùut
(
ù
);

154 
	`íd_›
();

158 
bad
:

159 
	`ûock
(
ù
);

160 
ù
->
∆ök
--;

161 
	`iupd©e
(
ù
);

162 
	`iu∆ockput
(
ù
);

163 
	`íd_›
();

165 
	}
}

169 
	$isdúem±y
(
öode
 *
dp
)

171 
off
;

172 
dúít
 
de
;

174 
off
=2*(
de
); off<
dp
->
size
; off+=(de)){

175 if(
	`ªadi
(
dp
, (*)&
de
, 
off
, (de)) != (de))

176 
	`∑nic
("isdirempty:Ñeadi");

177 if(
de
.
öum
 != 0)

181 
	}
}

185 
	$sys_u∆ök
()

187 
öode
 *
ù
, *
dp
;

188 
dúít
 
de
;

189 
«me
[
DIRSIZ
], *
∑th
;

190 
uöt
 
off
;

192 if(
	`¨g°r
(0, &
∑th
) < 0)

195 
	`begö_›
();

196 if((
dp
 = 
	`«meù¨ít
(
∑th
, 
«me
)) == 0){

197 
	`íd_›
();

201 
	`ûock
(
dp
);

204 if(
	`«mecmp
(
«me
, ".") == 0 ||Çamecmp(name, "..") == 0)

205 
bad
;

207 if((
ù
 = 
	`dúlookup
(
dp
, 
«me
, &
off
)) == 0)

208 
bad
;

209 
	`ûock
(
ù
);

211 if(
ù
->
∆ök
 < 1)

212 
	`∑nic
("unlink:Çlink < 1");

213 if(
ù
->
ty≥
 =
T_DIR
 && !
	`isdúem±y
(ip)){

214 
	`iu∆ockput
(
ù
);

215 
bad
;

218 
	`mem£t
(&
de
, 0, (de));

219 if(
	`wrôei
(
dp
, (*)&
de
, 
off
, (de)) != (de))

220 
	`∑nic
("unlink: writei");

221 if(
ù
->
ty≥
 =
T_DIR
){

222 
dp
->
∆ök
--;

223 
	`iupd©e
(
dp
);

225 
	`iu∆ockput
(
dp
);

227 
ù
->
∆ök
--;

228 
	`iupd©e
(
ù
);

229 
	`iu∆ockput
(
ù
);

231 
	`íd_›
();

235 
bad
:

236 
	`iu∆ockput
(
dp
);

237 
	`íd_›
();

239 
	}
}

241 
öode
*

242 
	$¸óã
(*
∑th
, 
ty≥
, 
maj‹
, 
mö‹
)

244 
öode
 *
ù
, *
dp
;

245 
«me
[
DIRSIZ
];

247 if((
dp
 = 
	`«meù¨ít
(
∑th
, 
«me
)) == 0)

249 
	`ûock
(
dp
);

251 if((
ù
 = 
	`dúlookup
(
dp
, 
«me
, 0)) != 0){

252 
	`iu∆ockput
(
dp
);

253 
	`ûock
(
ù
);

254 if(
ty≥
 =
T_FILE
 && 
ù
->type == T_FILE)

255  
ù
;

256 
	`iu∆ockput
(
ù
);

260 if((
ù
 = 
	`üŒoc
(
dp
->
dev
, 
ty≥
)) == 0)

261 
	`∑nic
("create: ialloc");

263 
	`ûock
(
ù
);

264 
ù
->
maj‹
 = major;

265 
ù
->
mö‹
 = minor;

266 
ù
->
∆ök
 = 1;

267 
	`iupd©e
(
ù
);

269 if(
ty≥
 =
T_DIR
){

270 
dp
->
∆ök
++;

271 
	`iupd©e
(
dp
);

273 if(
	`dúlök
(
ù
, ".", ip->
öum
Ë< 0 || dúlök(ù, "..", 
dp
->inum) < 0)

274 
	`∑nic
("create dots");

277 if(
	`dúlök
(
dp
, 
«me
, 
ù
->
öum
) < 0)

278 
	`∑nic
("create: dirlink");

280 
	`iu∆ockput
(
dp
);

282  
ù
;

283 
	}
}

286 
	$sys_›í
()

288 *
∑th
;

289 
fd
, 
omode
;

290 
fûe
 *
f
;

291 
öode
 *
ù
;

293 if(
	`¨g°r
(0, &
∑th
Ë< 0 || 
	`¨göt
(1, &
omode
) < 0)

296 
	`begö_›
();

298 if(
omode
 & 
O_CREATE
){

299 
ù
 = 
	`¸óã
(
∑th
, 
T_FILE
, 0, 0);

300 if(
ù
 == 0){

301 
	`íd_›
();

305 if((
ù
 = 
	`«mei
(
∑th
)) == 0){

306 
	`íd_›
();

309 
	`ûock
(
ù
);

310 if(
ù
->
ty≥
 =
T_DIR
 && 
omode
 !
O_RDONLY
){

311 
	`iu∆ockput
(
ù
);

312 
	`íd_›
();

317 if((
f
 = 
	`fûóŒoc
()Ë=0 || (
fd
 = 
	`fdÆloc
(f)) < 0){

318 if(
f
)

319 
	`fûe˛o£
(
f
);

320 
	`iu∆ockput
(
ù
);

321 
	`íd_›
();

324 
	`iu∆ock
(
ù
);

325 
	`íd_›
();

327 
f
->
ty≥
 = 
FD_INODE
;

328 
f
->
ù
 = ip;

329 
f
->
off
 = 0;

330 
f
->
ªadabÀ
 = !(
omode
 & 
O_WRONLY
);

331 
f
->
wrôabÀ
 = (
omode
 & 
O_WRONLY
Ë|| (omodê& 
O_RDWR
);

332  
fd
;

333 
	}
}

336 
	$sys_mkdú
()

338 *
∑th
;

339 
öode
 *
ù
;

341 
	`begö_›
();

342 if(
	`¨g°r
(0, &
∑th
Ë< 0 || (
ù
 = 
	`¸óã
’©h, 
T_DIR
, 0, 0)) == 0){

343 
	`íd_›
();

346 
	`iu∆ockput
(
ù
);

347 
	`íd_›
();

349 
	}
}

352 
	$sys_mknod
()

354 
öode
 *
ù
;

355 *
∑th
;

356 
maj‹
, 
mö‹
;

358 
	`begö_›
();

359 if((
	`¨g°r
(0, &
∑th
)) < 0 ||

360 
	`¨göt
(1, &
maj‹
) < 0 ||

361 
	`¨göt
(2, &
mö‹
) < 0 ||

362 (
ù
 = 
	`¸óã
(
∑th
, 
T_DEV
, 
maj‹
, 
mö‹
)) == 0){

363 
	`íd_›
();

366 
	`iu∆ockput
(
ù
);

367 
	`íd_›
();

369 
	}
}

372 
	$sys_chdú
()

374 *
∑th
;

375 
öode
 *
ù
;

376 
¥oc
 *
cuΩroc
 = 
	`my¥oc
();

378 
	`begö_›
();

379 if(
	`¨g°r
(0, &
∑th
Ë< 0 || (
ù
 = 
	`«mei
(path)) == 0){

380 
	`íd_›
();

383 
	`ûock
(
ù
);

384 if(
ù
->
ty≥
 !
T_DIR
){

385 
	`iu∆ockput
(
ù
);

386 
	`íd_›
();

389 
	`iu∆ock
(
ù
);

390 
	`ùut
(
cuΩroc
->
cwd
);

391 
	`íd_›
();

392 
cuΩroc
->
cwd
 = 
ù
;

394 
	}
}

397 
	$sys_exec
()

399 *
∑th
, *
¨gv
[
MAXARG
];

400 
i
;

401 
uöt
 
u¨gv
, 
u¨g
;

403 if(
	`¨g°r
(0, &
∑th
Ë< 0 || 
	`¨göt
(1, (*)&
u¨gv
) < 0){

406 
	`mem£t
(
¨gv
, 0, (argv));

407 
i
=0;; i++){

408 if(
i
 >
	`NELEM
(
¨gv
))

410 if(
	`„tchöt
(
u¨gv
+4*
i
, (*)&
u¨g
) < 0)

412 if(
u¨g
 == 0){

413 
¨gv
[
i
] = 0;

416 if(
	`„tch°r
(
u¨g
, &
¨gv
[
i
]) < 0)

419  
	`exec
(
∑th
, 
¨gv
);

420 
	}
}

423 
	$sys_pùe
()

425 *
fd
;

426 
fûe
 *
rf
, *
wf
;

427 
fd0
, 
fd1
;

429 if(
	`¨g±r
(0, (*)&
fd
, 2*(fd[0])) < 0)

431 if(
	`pùóŒoc
(&
rf
, &
wf
) < 0)

433 
fd0
 = -1;

434 if((
fd0
 = 
	`fdÆloc
(
rf
)Ë< 0 || (
fd1
 = fdÆloc(
wf
)) < 0){

435 if(
fd0
 >= 0)

436 
	`my¥oc
()->
ofûe
[
fd0
] = 0;

437 
	`fûe˛o£
(
rf
);

438 
	`fûe˛o£
(
wf
);

441 
fd
[0] = 
fd0
;

442 
fd
[1] = 
fd1
;

444 
	}
}

	@sysproc.c

1 
	~"ty≥s.h
"

2 
	~"x86.h
"

3 
	~"defs.h
"

4 
	~"d©e.h
"

5 
	~"∑øm.h
"

6 
	~"memœyout.h
"

7 
	~"mmu.h
"

8 
	~"¥oc.h
"

11 
	$sys_f‹k
()

13  
	`f‹k
();

14 
	}
}

17 
	$sys_exô
()

19 
	`exô
();

21 
	}
}

24 
	$sys_waô
()

26  
	`waô
();

27 
	}
}

30 
	$sys_kûl
()

32 
pid
;

34 if(
	`¨göt
(0, &
pid
) < 0)

36  
	`kûl
(
pid
);

37 
	}
}

40 
	$sys_gëpid
()

42  
	`my¥oc
()->
pid
;

43 
	}
}

46 
	$sys_sbrk
()

48 
addr
;

49 
n
;

51 if(
	`¨göt
(0, &
n
) < 0)

53 
addr
 = 
	`my¥oc
()->
sz
;

54 if(
	`grow¥oc
(
n
) < 0)

56  
addr
;

57 
	}
}

60 
	$sys_¶ìp
()

62 
n
;

63 
uöt
 
ticks0
;

65 if(
	`¨göt
(0, &
n
) < 0)

67 
	`acquúe
(&
tick¶ock
);

68 
ticks0
 = 
ticks
;

69 
ticks
 - 
ticks0
 < 
n
){

70 if(
	`my¥oc
()->
kûÀd
){

71 
	`ªÀa£
(&
tick¶ock
);

74 
	`¶ìp
(&
ticks
, &
tick¶ock
);

76 
	`ªÀa£
(&
tick¶ock
);

78 
	}
}

83 
	$sys_u±ime
()

85 
uöt
 
xticks
;

87 
	`acquúe
(&
tick¶ock
);

88 
xticks
 = 
ticks
;

89 
	`ªÀa£
(&
tick¶ock
);

90  
xticks
;

91 
	}
}

	@trap.c

1 
	~"ty≥s.h
"

2 
	~"defs.h
"

3 
	~"∑øm.h
"

4 
	~"memœyout.h
"

5 
	~"mmu.h
"

6 
	~"¥oc.h
"

7 
	~"x86.h
"

8 
	~"å≠s.h
"

9 
	~"•ölock.h
"

12 
g©edesc
 
	gidt
[256];

13 
uöt
 
ve˘‹s
[];

14 
•ölock
 
	gtick¶ock
;

15 
uöt
 
	gticks
;

18 
	$tvöô
()

20 
i
;

22 
i
 = 0; i < 256; i++)

23 
	`SETGATE
(
idt
[
i
], 0, 
SEG_KCODE
<<3, 
ve˘‹s
[i], 0);

24 
	`SETGATE
(
idt
[
T_SYSCALL
], 1, 
SEG_KCODE
<<3, 
ve˘‹s
[T_SYSCALL], 
DPL_USER
);

26 
	`öôlock
(&
tick¶ock
, "time");

27 
	}
}

30 
	$idtöô
()

32 
	`lidt
(
idt
, (idt));

33 
	}
}

37 
	$å≠
(
å≠‰ame
 *
tf
)

39 if(
tf
->
å≠no
 =
T_SYSCALL
){

40 if(
	`my¥oc
()->
kûÀd
)

41 
	`exô
();

42 
	`my¥oc
()->
tf
 =Åf;

43 
	`sysˇŒ
();

44 if(
	`my¥oc
()->
kûÀd
)

45 
	`exô
();

49 
tf
->
å≠no
){

50 
T_IRQ0
 + 
IRQ_TIMER
:

51 if(
	`˝uid
() == 0){

52 
	`acquúe
(&
tick¶ock
);

53 
ticks
++;

54 
	`wakeup
(&
ticks
);

55 
	`ªÀa£
(&
tick¶ock
);

57 
	`œpi˚oi
();

59 
T_IRQ0
 + 
IRQ_IDE
:

60 
	`ideöå
();

61 
	`œpi˚oi
();

63 
T_IRQ0
 + 
IRQ_IDE
+1:

66 
T_IRQ0
 + 
IRQ_KBD
:

67 
	`kbdöå
();

68 
	`œpi˚oi
();

70 
T_IRQ0
 + 
IRQ_COM1
:

71 
	`u¨töå
();

72 
	`œpi˚oi
();

74 
T_IRQ0
 + 7:

75 
T_IRQ0
 + 
IRQ_SPURIOUS
:

76 
	`˝rötf
("cpu%d: spurious interruptát %x:%x\n",

77 
	`˝uid
(), 
tf
->
cs
,Åf->
eù
);

78 
	`œpi˚oi
();

83 if(
	`my¥oc
(Ë=0 || (
tf
->
cs
&3) == 0){

85 
	`˝rötf
("unexpectedÅrap %d from cpu %dÉip %x (cr2=0x%x)\n",

86 
tf
->
å≠no
, 
	`˝uid
(),Åf->
eù
, 
	`r¸2
());

87 
	`∑nic
("trap");

90 
	`˝rötf
("pid %d %s:Årap %dÉrr %d on cpu %d "

92 
	`my¥oc
()->
pid
, my¥oc()->
«me
, 
tf
->
å≠no
,

93 
tf
->
îr
, 
	`˝uid
(),Åf->
eù
, 
	`r¸2
());

94 
	`my¥oc
()->
kûÀd
 = 1;

100 if(
	`my¥oc
(Ë&& my¥oc()->
kûÀd
 && (
tf
->
cs
&3Ë=
DPL_USER
)

101 
	`exô
();

105 if(
	`my¥oc
(Ë&& my¥oc()->
°©e
 =
RUNNING
 &&

106 
tf
->
å≠no
 =
T_IRQ0
+
IRQ_TIMER
)

107 
	`yõld
();

110 if(
	`my¥oc
(Ë&& my¥oc()->
kûÀd
 && (
tf
->
cs
&3Ë=
DPL_USER
)

111 
	`exô
();

112 
	}
}

	@traps.h

4 
	#T_DIVIDE
 0

5 
	#T_DEBUG
 1

6 
	#T_NMI
 2

7 
	#T_BRKPT
 3

8 
	#T_OFLOW
 4

9 
	#T_BOUND
 5

10 
	#T_ILLOP
 6

11 
	#T_DEVICE
 7

12 
	#T_DBLFLT
 8

14 
	#T_TSS
 10

15 
	#T_SEGNP
 11

16 
	#T_STACK
 12

17 
	#T_GPFLT
 13

18 
	#T_PGFLT
 14

20 
	#T_FPERR
 16

21 
	#T_ALIGN
 17

22 
	#T_MCHK
 18

23 
	#T_SIMDERR
 19

24 

	)

27 
	#T_SYSCALL
 64

28 
	#T_DEFAULT
 500

29 

	)

30 
	#T_IRQ0
 32

31 

	)

32 
	#IRQ_TIMER
 0

	)

33 
	#IRQ_KBD
 1

	)

34 
	#IRQ_COM1
 4

	)

35 
	#IRQ_IDE
 14

	)

36 
	#IRQ_ERROR
 19

	)

37 
	#IRQ_SPURIOUS
 31

	)

	@types.h

1 
	tuöt
;

2 
	tush‹t
;

3 
	tuch¨
;

4 
uöt
 
	tpde_t
;

	@uart.c

3 
	~"ty≥s.h
"

4 
	~"defs.h
"

5 
	~"∑øm.h
"

6 
	~"å≠s.h
"

7 
	~"•ölock.h
"

8 
	~"¶ì∂ock.h
"

9 
	~"fs.h
"

10 
	~"fûe.h
"

11 
	~"mmu.h
"

12 
	~"¥oc.h
"

13 
	~"x86.h
"

15 
	#COM1
 0x3f8

	)

17 
	gu¨t
;

20 
	$u¨töô
()

22 *
p
;

25 
	`outb
(
COM1
+2, 0);

28 
	`outb
(
COM1
+3, 0x80);

29 
	`outb
(
COM1
+0, 115200/9600);

30 
	`outb
(
COM1
+1, 0);

31 
	`outb
(
COM1
+3, 0x03);

32 
	`outb
(
COM1
+4, 0);

33 
	`outb
(
COM1
+1, 0x01);

36 if(
	`öb
(
COM1
+5) == 0xFF)

38 
u¨t
 = 1;

42 
	`öb
(
COM1
+2);

43 
	`öb
(
COM1
+0);

44 
	`iﬂpi˚«bÀ
(
IRQ_COM1
, 0);

47 
p
="xv6...\n"; *p;Ö++)

48 
	`u¨çutc
(*
p
);

49 
	}
}

52 
	$u¨çutc
(
c
)

54 
i
;

56 if(!
u¨t
)

58 
i
 = 0; i < 128 && !(
	`öb
(
COM1
+5) & 0x20); i++)

59 
	`mi¸odñay
(10);

60 
	`outb
(
COM1
+0, 
c
);

61 
	}
}

64 
	$u¨tgëc
()

66 if(!
u¨t
)

68 if(!(
	`öb
(
COM1
+5) & 0x01))

70  
	`öb
(
COM1
+0);

71 
	}
}

74 
	$u¨töå
()

76 
	`c⁄sﬁeöå
(
u¨tgëc
);

77 
	}
}

	@ulib.c

1 
	~"ty≥s.h
"

2 
	~"°©.h
"

3 
	~"f˙é.h
"

4 
	~"u£r.h
"

5 
	~"x86.h
"

8 
	$°r˝y
(*
s
, c⁄° *
t
)

10 *
os
;

12 
os
 = 
s
;

13 (*
s
++ = *
t
++) != 0)

15  
os
;

16 
	}
}

19 
	$°rcmp
(c⁄° *
p
, c⁄° *
q
)

21 *
p
 && *∞=*
q
)

22 
p
++, 
q
++;

23  (
uch¨
)*
p
 - (uch¨)*
q
;

24 
	}
}

26 
uöt


27 
	$°æí
(c⁄° *
s
)

29 
n
;

31 
n
 = 0; 
s
[n];Ç++)

33  
n
;

34 
	}
}

37 
	$mem£t
(*
d°
, 
c
, 
uöt
 
n
)

39 
	`°osb
(
d°
, 
c
, 
n
);

40  
d°
;

41 
	}
}

44 
	$°rchr
(c⁄° *
s
, 
c
)

46 ; *
s
; s++)

47 if(*
s
 =
c
)

48  (*)
s
;

50 
	}
}

53 
	$gës
(*
buf
, 
max
)

55 
i
, 
cc
;

56 
c
;

58 
i
=0; i+1 < 
max
; ){

59 
cc
 = 
	`ªad
(0, &
c
, 1);

60 if(
cc
 < 1)

62 
buf
[
i
++] = 
c
;

63 if(
c
 == '\n' || c == '\r')

66 
buf
[
i
] = '\0';

67  
buf
;

68 
	}
}

71 
	$°©
(c⁄° *
n
, 
°©
 *
°
)

73 
fd
;

74 
r
;

76 
fd
 = 
	`›í
(
n
, 
O_RDONLY
);

77 if(
fd
 < 0)

79 
r
 = 
	`f°©
(
fd
, 
°
);

80 
	`˛o£
(
fd
);

81  
r
;

82 
	}
}

85 
	$©oi
(c⁄° *
s
)

87 
n
;

89 
n
 = 0;

90 '0' <*
s
 && *s <= '9')

91 
n
 =Ç*10 + *
s
++ - '0';

92  
n
;

93 
	}
}

96 
	$memmove
(*
vd°
, c⁄° *
v§c
, 
n
)

98 *
d°
;

99 c⁄° *
§c
;

101 
d°
 = 
vd°
;

102 
§c
 = 
v§c
;

103 
n
-- > 0)

104 *
d°
++ = *
§c
++;

105  
vd°
;

106 
	}
}

	@umalloc.c

1 
	~"ty≥s.h
"

2 
	~"°©.h
"

3 
	~"u£r.h
"

4 
	~"∑øm.h
"

9 
	tAlign
;

11 
	uhódî
 {

13 
hódî
 *
	m±r
;

14 
uöt
 
	msize
;

15 } 
	ms
;

16 
Align
 
	mx
;

19 
hódî
 
	tHódî
;

21 
Hódî
 
	gba£
;

22 
Hódî
 *
	g‰ìp
;

25 
	$‰ì
(*
≠
)

27 
Hódî
 *
bp
, *
p
;

29 
bp
 = (
Hódî
*)
≠
 - 1;

30 
p
 = 
‰ìp
; !(
bp
 >Ö && b∞<Ö->
s
.
±r
);Ö =Ö->s.ptr)

31 if(
p
 >p->
s
.
±r
 && (
bp
 >Ö || bp <Ö->s.ptr))

33 if(
bp
 + bp->
s
.
size
 =
p
->s.
±r
){

34 
bp
->
s
.
size
 +
p
->s.
±r
->s.size;

35 
bp
->
s
.
±r
 = 
p
->s.ptr->s.ptr;

37 
bp
->
s
.
±r
 = 
p
->s.ptr;

38 if(
p
 +Ö->
s
.
size
 =
bp
){

39 
p
->
s
.
size
 +
bp
->s.size;

40 
p
->
s
.
±r
 = 
bp
->s.ptr;

42 
p
->
s
.
±r
 = 
bp
;

43 
‰ìp
 = 
p
;

44 
	}
}

46 
Hódî
*

47 
	$m‹ec‹e
(
uöt
 
nu
)

49 *
p
;

50 
Hódî
 *
hp
;

52 if(
nu
 < 4096)

53 
nu
 = 4096;

54 
p
 = 
	`sbrk
(
nu
 * (
Hódî
));

55 if(
p
 == (*)-1)

57 
hp
 = (
Hódî
*)
p
;

58 
hp
->
s
.
size
 = 
nu
;

59 
	`‰ì
((*)(
hp
 + 1));

60  
‰ìp
;

61 
	}
}

64 
	$mÆloc
(
uöt
 
nbyãs
)

66 
Hódî
 *
p
, *
¥evp
;

67 
uöt
 
nunôs
;

69 
nunôs
 = (
nbyãs
 + (
Hódî
) - 1)/(Header) + 1;

70 if((
¥evp
 = 
‰ìp
) == 0){

71 
ba£
.
s
.
±r
 = 
‰ìp
 = 
¥evp
 = &base;

72 
ba£
.
s
.
size
 = 0;

74 
p
 = 
¥evp
->
s
.
±r
; ;Örevp =Ö,Ö =Ö->s.ptr){

75 if(
p
->
s
.
size
 >
nunôs
){

76 if(
p
->
s
.
size
 =
nunôs
)

77 
¥evp
->
s
.
±r
 = 
p
->s.ptr;

79 
p
->
s
.
size
 -
nunôs
;

80 
p
 +p->
s
.
size
;

81 
p
->
s
.
size
 = 
nunôs
;

83 
‰ìp
 = 
¥evp
;

84  (*)(
p
 + 1);

86 if(
p
 =
‰ìp
)

87 if((
p
 = 
	`m‹ec‹e
(
nunôs
)) == 0)

90 
	}
}

	@user.h

1 
	g°©
;

2 
	gπcd©e
;

5 
f‹k
();

6 
	$exô
(Ë
	`__©åibuã__
((
n‹ëu∫
));

7 
	`waô
();

8 
	`pùe
(*);

9 
	`wrôe
(, const *, );

10 
	`ªad
(, *, );

11 
	`˛o£
();

12 
	`kûl
();

13 
	`exec
(*, **);

14 
	`›í
(const *, );

15 
	`mknod
(const *, , );

16 
	`u∆ök
(const *);

17 
	`f°©
(
fd
, 
°©
*);

18 
	`lök
(const *, const *);

19 
	`mkdú
(const *);

20 
	`chdú
(const *);

21 
	`dup
();

22 
	`gëpid
();

23 * 
	`sbrk
();

24 
	`¶ìp
();

25 
	`u±ime
();

28 
	`°©
(c⁄° *, 
°©
*);

29 * 
	`°r˝y
(*, const *);

30 *
	`memmove
(*, const *, );

31 * 
	`°rchr
(c⁄° *, 
c
);

32 
	`°rcmp
(const *, const *);

33 
	`¥ötf
(, const *, ...);

34 * 
	`gës
(*, 
max
);

35 
uöt
 
	`°æí
(const *);

36 * 
	`mem£t
(*, , 
uöt
);

37 * 
	`mÆloc
(
uöt
);

38 
	`‰ì
(*);

39 
	`©oi
(const *);

	@vm.c

1 
	~"∑øm.h
"

2 
	~"ty≥s.h
"

3 
	~"defs.h
"

4 
	~"x86.h
"

5 
	~"memœyout.h
"

6 
	~"mmu.h
"

7 
	~"¥oc.h
"

8 
	~"ñf.h
"

10 
d©a
[];

11 
pde_t
 *
	gkpgdú
;

16 
	$£göô
()

18 
˝u
 *
c
;

24 
c
 = &
˝us
[
	`˝uid
()];

25 
c
->
gdt
[
SEG_KCODE
] = 
	`SEG
(
STA_X
|
STA_R
, 0, 0xffffffff, 0);

26 
c
->
gdt
[
SEG_KDATA
] = 
	`SEG
(
STA_W
, 0, 0xffffffff, 0);

27 
c
->
gdt
[
SEG_UCODE
] = 
	`SEG
(
STA_X
|
STA_R
, 0, 0xffffffff, 
DPL_USER
);

28 
c
->
gdt
[
SEG_UDATA
] = 
	`SEG
(
STA_W
, 0, 0xffffffff, 
DPL_USER
);

29 
	`lgdt
(
c
->
gdt
, (c->gdt));

30 
	}
}

35 
±e_t
 *

36 
	$wÆkpgdú
(
pde_t
 *
pgdú
, c⁄° *
va
, 
Æloc
)

38 
pde_t
 *
pde
;

39 
±e_t
 *
pgèb
;

41 
pde
 = &
pgdú
[
	`PDX
(
va
)];

42 if(*
pde
 & 
PTE_P
){

43 
pgèb
 = (
±e_t
*)
	`P2V
(
	`PTE_ADDR
(*
pde
));

45 if(!
Æloc
 || (
pgèb
 = (
±e_t
*)
	`kÆloc
()) == 0)

48 
	`mem£t
(
pgèb
, 0, 
PGSIZE
);

52 *
pde
 = 
	`V2P
(
pgèb
Ë| 
PTE_P
 | 
PTE_W
 | 
PTE_U
;

54  &
pgèb
[
	`PTX
(
va
)];

55 
	}
}

61 
	$m≠∑ges
(
pde_t
 *
pgdú
, *
va
, 
uöt
 
size
, uöà
∑
, 
≥rm
)

63 *
a
, *
œ°
;

64 
±e_t
 *
±e
;

66 
a
 = (*)
	`PGROUNDDOWN
((
uöt
)
va
);

67 
œ°
 = (*)
	`PGROUNDDOWN
(((
uöt
)
va
Ë+ 
size
 - 1);

69 if((
±e
 = 
	`wÆkpgdú
(
pgdú
, 
a
, 1)) == 0)

71 if(*
±e
 & 
PTE_P
)

72 
	`∑nic
("remap");

73 *
±e
 = 
∑
 | 
≥rm
 | 
PTE_P
;

74 if(
a
 =
œ°
)

76 
a
 +
PGSIZE
;

77 
∑
 +
PGSIZE
;

80 
	}
}

105 
	skm≠
 {

106 *
	mvút
;

107 
uöt
 
	mphys_°¨t
;

108 
uöt
 
	mphys_íd
;

109 
	m≥rm
;

110 } 
	gkm≠
[] = {

111 { (*)
KERNBASE
, 0, 
EXTMEM
, 
PTE_W
},

112 { (*)
KERNLINK
, 
V2P
(KERNLINK), V2P(
d©a
), 0},

113 { (*)
d©a
, 
V2P
(d©a), 
PHYSTOP
, 
PTE_W
},

114 { (*)
DEVSPACE
, DEVSPACE, 0, 
PTE_W
},

118 
pde_t
*

119 
	$£tupkvm
()

121 
pde_t
 *
pgdú
;

122 
km≠
 *
k
;

124 if((
pgdú
 = (
pde_t
*)
	`kÆloc
()) == 0)

126 
	`mem£t
(
pgdú
, 0, 
PGSIZE
);

127 i‡(
	`P2V
(
PHYSTOP
Ë> (*)
DEVSPACE
)

128 
	`∑nic
("PHYSTOPÅoo high");

129 
k
 = 
km≠
; k < &km≠[
	`NELEM
(kmap)]; k++)

130 if(
	`m≠∑ges
(
pgdú
, 
k
->
vút
, k->
phys_íd
 - k->
phys_°¨t
,

131 (
uöt
)
k
->
phys_°¨t
, k->
≥rm
) < 0) {

132 
	`‰ìvm
(
pgdú
);

135  
pgdú
;

136 
	}
}

141 
	$kvmÆloc
()

143 
kpgdú
 = 
	`£tupkvm
();

144 
	`swôchkvm
();

145 
	}
}

150 
	$swôchkvm
()

152 
	`l¸3
(
	`V2P
(
kpgdú
));

153 
	}
}

157 
	$swôchuvm
(
¥oc
 *
p
)

159 if(
p
 == 0)

160 
	`∑nic
("switchuvm:ÇoÖrocess");

161 if(
p
->
k°ack
 == 0)

162 
	`∑nic
("switchuvm:Ço kstack");

163 if(
p
->
pgdú
 == 0)

164 
	`∑nic
("switchuvm:ÇoÖgdir");

166 
	`push˛i
();

167 
	`my˝u
()->
gdt
[
SEG_TSS
] = 
	`SEG16
(
STS_T32A
, &my˝u()->
ts
,

168 (
	`my˝u
()->
ts
)-1, 0);

169 
	`my˝u
()->
gdt
[
SEG_TSS
].
s
 = 0;

170 
	`my˝u
()->
ts
.
ss0
 = 
SEG_KDATA
 << 3;

171 
	`my˝u
()->
ts
.
e•0
 = (
uöt
)
p
->
k°ack
 + 
KSTACKSIZE
;

174 
	`my˝u
()->
ts
.
iomb
 = (
ush‹t
) 0xFFFF;

175 
	`…r
(
SEG_TSS
 << 3);

176 
	`l¸3
(
	`V2P
(
p
->
pgdú
));

177 
	`p›˛i
();

178 
	}
}

183 
	$öôuvm
(
pde_t
 *
pgdú
, *
öô
, 
uöt
 
sz
)

185 *
mem
;

187 if(
sz
 >
PGSIZE
)

188 
	`∑nic
("inituvm: moreÅhanáÖage");

189 
mem
 = 
	`kÆloc
();

190 
	`mem£t
(
mem
, 0, 
PGSIZE
);

191 
	`m≠∑ges
(
pgdú
, 0, 
PGSIZE
, 
	`V2P
(
mem
), 
PTE_W
|
PTE_U
);

192 
	`memmove
(
mem
, 
öô
, 
sz
);

193 
	}
}

198 
	$lﬂduvm
(
pde_t
 *
pgdú
, *
addr
, 
öode
 *
ù
, 
uöt
 
off£t
, uöà
sz
)

200 
uöt
 
i
, 
∑
, 
n
;

201 
±e_t
 *
±e
;

203 if((
uöt
Ë
addr
 % 
PGSIZE
 != 0)

204 
	`∑nic
("loaduvm:áddr must beÖageáligned");

205 
i
 = 0; i < 
sz
; i +
PGSIZE
){

206 if((
±e
 = 
	`wÆkpgdú
(
pgdú
, 
addr
+
i
, 0)) == 0)

207 
	`∑nic
("loaduvm:áddress shouldÉxist");

208 
∑
 = 
	`PTE_ADDR
(*
±e
);

209 if(
sz
 - 
i
 < 
PGSIZE
)

210 
n
 = 
sz
 - 
i
;

212 
n
 = 
PGSIZE
;

213 if(
	`ªadi
(
ù
, 
	`P2V
(
∑
), 
off£t
+
i
, 
n
) !=Ç)

217 
	}
}

222 
	$Ælocuvm
(
pde_t
 *
pgdú
, 
uöt
 
ﬁdsz
, uöà
√wsz
)

224 *
mem
;

225 
uöt
 
a
;

227 if(
√wsz
 >
KERNBASE
)

229 if(
√wsz
 < 
ﬁdsz
)

230  
ﬁdsz
;

232 
a
 = 
	`PGROUNDUP
(
ﬁdsz
);

233 ; 
a
 < 
√wsz
;á +
PGSIZE
){

234 
mem
 = 
	`kÆloc
();

235 if(
mem
 == 0){

236 
	`˝rötf
("allocuvm out of memory\n");

237 
	`dóŒocuvm
(
pgdú
, 
√wsz
, 
ﬁdsz
);

240 
	`mem£t
(
mem
, 0, 
PGSIZE
);

241 if(
	`m≠∑ges
(
pgdú
, (*)
a
, 
PGSIZE
, 
	`V2P
(
mem
), 
PTE_W
|
PTE_U
) < 0){

242 
	`˝rötf
("allocuvm out of memory (2)\n");

243 
	`dóŒocuvm
(
pgdú
, 
√wsz
, 
ﬁdsz
);

244 
	`k‰ì
(
mem
);

248  
√wsz
;

249 
	}
}

256 
	$dóŒocuvm
(
pde_t
 *
pgdú
, 
uöt
 
ﬁdsz
, uöà
√wsz
)

258 
±e_t
 *
±e
;

259 
uöt
 
a
, 
∑
;

261 if(
√wsz
 >
ﬁdsz
)

262  
ﬁdsz
;

264 
a
 = 
	`PGROUNDUP
(
√wsz
);

265 ; 
a
 < 
ﬁdsz
;á +
PGSIZE
){

266 
±e
 = 
	`wÆkpgdú
(
pgdú
, (*)
a
, 0);

267 if(!
±e
)

268 
a
 = 
	`PGADDR
(
	`PDX
◊Ë+ 1, 0, 0Ë- 
PGSIZE
;

269 if((*
±e
 & 
PTE_P
) != 0){

270 
∑
 = 
	`PTE_ADDR
(*
±e
);

271 if(
∑
 == 0)

272 
	`∑nic
("kfree");

273 *
v
 = 
	`P2V
(
∑
);

274 
	`k‰ì
(
v
);

275 *
±e
 = 0;

278  
√wsz
;

279 
	}
}

284 
	$‰ìvm
(
pde_t
 *
pgdú
)

286 
uöt
 
i
;

288 if(
pgdú
 == 0)

289 
	`∑nic
("freevm:ÇoÖgdir");

290 
	`dóŒocuvm
(
pgdú
, 
KERNBASE
, 0);

291 
i
 = 0; i < 
NPDENTRIES
; i++){

292 if(
pgdú
[
i
] & 
PTE_P
){

293 * 
v
 = 
	`P2V
(
	`PTE_ADDR
(
pgdú
[
i
]));

294 
	`k‰ì
(
v
);

297 
	`k‰ì
((*)
pgdú
);

298 
	}
}

303 
	$˛óΩãu
(
pde_t
 *
pgdú
, *
uva
)

305 
±e_t
 *
±e
;

307 
±e
 = 
	`wÆkpgdú
(
pgdú
, 
uva
, 0);

308 if(
±e
 == 0)

309 
	`∑nic
("clearpteu");

310 *
±e
 &~
PTE_U
;

311 
	}
}

315 
pde_t
*

316 
	$c›yuvm
(
pde_t
 *
pgdú
, 
uöt
 
sz
)

318 
pde_t
 *
d
;

319 
±e_t
 *
±e
;

320 
uöt
 
∑
, 
i
, 
Êags
;

321 *
mem
;

323 if((
d
 = 
	`£tupkvm
()) == 0)

325 
i
 = 0; i < 
sz
; i +
PGSIZE
){

326 if((
±e
 = 
	`wÆkpgdú
(
pgdú
, (*Ë
i
, 0)) == 0)

327 
	`∑nic
("copyuvm:Öte shouldÉxist");

328 if(!(*
±e
 & 
PTE_P
))

329 
	`∑nic
("copyuvm:ÖageÇotÖresent");

330 
∑
 = 
	`PTE_ADDR
(*
±e
);

331 
Êags
 = 
	`PTE_FLAGS
(*
±e
);

332 if((
mem
 = 
	`kÆloc
()) == 0)

333 
bad
;

334 
	`memmove
(
mem
, (*)
	`P2V
(
∑
), 
PGSIZE
);

335 if(
	`m≠∑ges
(
d
, (*)
i
, 
PGSIZE
, 
	`V2P
(
mem
), 
Êags
) < 0) {

336 
	`k‰ì
(
mem
);

337 
bad
;

340  
d
;

342 
bad
:

343 
	`‰ìvm
(
d
);

345 
	}
}

350 
	$uva2ka
(
pde_t
 *
pgdú
, *
uva
)

352 
±e_t
 *
±e
;

354 
±e
 = 
	`wÆkpgdú
(
pgdú
, 
uva
, 0);

355 if((*
±e
 & 
PTE_P
) == 0)

357 if((*
±e
 & 
PTE_U
) == 0)

359  (*)
	`P2V
(
	`PTE_ADDR
(*
±e
));

360 
	}
}

366 
	$c›yout
(
pde_t
 *
pgdú
, 
uöt
 
va
, *
p
, uöà
Àn
)

368 *
buf
, *
∑0
;

369 
uöt
 
n
, 
va0
;

371 
buf
 = (*)
p
;

372 
Àn
 > 0){

373 
va0
 = (
uöt
)
	`PGROUNDDOWN
(
va
);

374 
∑0
 = 
	`uva2ka
(
pgdú
, (*)
va0
);

375 if(
∑0
 == 0)

377 
n
 = 
PGSIZE
 - (
va
 - 
va0
);

378 if(
n
 > 
Àn
)

379 
n
 = 
Àn
;

380 
	`memmove
(
∑0
 + (
va
 - 
va0
), 
buf
, 
n
);

381 
Àn
 -
n
;

382 
buf
 +
n
;

383 
va
 = 
va0
 + 
PGSIZE
;

386 
	}
}

	@x86.h

3 
ölöe
 
uch¨


4 
	$öb
(
ush‹t
 
p‹t
)

6 
uch¨
 
d©a
;

8 
asm
 vﬁ©ûe("ö %1,%0" : "˜" (
d©a
Ë: "d" (
p‹t
));

9  
d©a
;

10 
	}
}

12 
ölöe
 

13 
	$ö¶
(
p‹t
, *
addr
, 
˙t
)

15 
asm
 volatile("cld;Ñep insl" :

16 "=D" (
addr
), "=c" (
˙t
) :

17 "d" (
p‹t
), "0" (
addr
), "1" (
˙t
) :

19 
	}
}

21 
ölöe
 

22 
	$outb
(
ush‹t
 
p‹t
, 
uch¨
 
d©a
)

24 
asm
 vﬁ©ûe("ouà%0,%1" : : "a" (
d©a
), "d" (
p‹t
));

25 
	}
}

27 
ölöe
 

28 
	$outw
(
ush‹t
 
p‹t
, ush‹à
d©a
)

30 
asm
 vﬁ©ûe("ouà%0,%1" : : "a" (
d©a
), "d" (
p‹t
));

31 
	}
}

33 
ölöe
 

34 
	$out¶
(
p‹t
, c⁄° *
addr
, 
˙t
)

36 
asm
 volatile("cld;Ñep outsl" :

37 "=S" (
addr
), "=c" (
˙t
) :

38 "d" (
p‹t
), "0" (
addr
), "1" (
˙t
) :

40 
	}
}

42 
ölöe
 

43 
	$°osb
(*
addr
, 
d©a
, 
˙t
)

45 
asm
 volatile("cld;Ñep stosb" :

46 "=D" (
addr
), "=c" (
˙t
) :

47 "0" (
addr
), "1" (
˙t
), "a" (
d©a
) :

49 
	}
}

51 
ölöe
 

52 
	$°o¶
(*
addr
, 
d©a
, 
˙t
)

54 
asm
 volatile("cld;Ñep stosl" :

55 "=D" (
addr
), "=c" (
˙t
) :

56 "0" (
addr
), "1" (
˙t
), "a" (
d©a
) :

58 
	}
}

60 
	g£gdesc
;

62 
ölöe
 

63 
	$lgdt
(
£gdesc
 *
p
, 
size
)

65 vﬁ©ûê
ush‹t
 
pd
[3];

67 
pd
[0] = 
size
-1;

68 
pd
[1] = (
uöt
)
p
;

69 
pd
[2] = (
uöt
)
p
 >> 16;

71 
asm
 vﬁ©ûe("lgdà(%0)" : : "r" (
pd
));

72 
	}
}

74 
	gg©edesc
;

76 
ölöe
 

77 
	$lidt
(
g©edesc
 *
p
, 
size
)

79 vﬁ©ûê
ush‹t
 
pd
[3];

81 
pd
[0] = 
size
-1;

82 
pd
[1] = (
uöt
)
p
;

83 
pd
[2] = (
uöt
)
p
 >> 16;

85 
asm
 vﬁ©ûe("lidà(%0)" : : "r" (
pd
));

86 
	}
}

88 
ölöe
 

89 
	$…r
(
ush‹t
 
£l
)

91 
asm
 vﬁ©ûe("…∏%0" : : "r" (
£l
));

92 
	}
}

94 
ölöe
 
uöt


95 
	$ªadeÊags
()

97 
uöt
 
eÊags
;

98 
asm
 vﬁ©ûe("pushÊ;Ö›»%0" : "Ù" (
eÊags
));

99  
eÊags
;

100 
	}
}

102 
ölöe
 

103 
	$lﬂdgs
(
ush‹t
 
v
)

105 
asm
 vﬁ©ûe("movw %0, %%gs" : : "r" (
v
));

106 
	}
}

108 
ölöe
 

109 
	$˛i
()

111 
asm
 volatile("cli");

112 
	}
}

114 
ölöe
 

115 
	$°i
()

117 
asm
 volatile("sti");

118 
	}
}

120 
ölöe
 
uöt


121 
	$xchg
(vﬁ©ûê
uöt
 *
addr
, uöà
√wvÆ
)

123 
uöt
 
ªsu…
;

126 
asm
 volatile("lock; xchgl %0, %1" :

127 "+m" (*
addr
), "˜" (
ªsu…
) :

128 "1" (
√wvÆ
) :

130  
ªsu…
;

131 
	}
}

133 
ölöe
 
uöt


134 
	$r¸2
()

136 
uöt
 
vÆ
;

137 
asm
 vﬁ©ûe("mov»%%¸2,%0" : "Ù" (
vÆ
));

138  
vÆ
;

139 
	}
}

141 
ölöe
 

142 
	$l¸3
(
uöt
 
vÆ
)

144 
asm
 vﬁ©ûe("mov»%0,%%¸3" : : "r" (
vÆ
));

145 
	}
}

150 
	så≠‰ame
 {

152 
uöt
 
	medi
;

153 
uöt
 
	mesi
;

154 
uöt
 
	mebp
;

155 
uöt
 
	m€•
;

156 
uöt
 
	mebx
;

157 
uöt
 
	medx
;

158 
uöt
 
	mecx
;

159 
uöt
 
	móx
;

162 
ush‹t
 
	mgs
;

163 
ush‹t
 
	m∑ddög1
;

164 
ush‹t
 
	mfs
;

165 
ush‹t
 
	m∑ddög2
;

166 
ush‹t
 
	mes
;

167 
ush‹t
 
	m∑ddög3
;

168 
ush‹t
 
	mds
;

169 
ush‹t
 
	m∑ddög4
;

170 
uöt
 
	må≠no
;

173 
uöt
 
	mîr
;

174 
uöt
 
	meù
;

175 
ush‹t
 
	mcs
;

176 
ush‹t
 
	m∑ddög5
;

177 
uöt
 
	meÊags
;

180 
uöt
 
	me•
;

181 
ush‹t
 
	mss
;

182 
ush‹t
 
	m∑ddög6
;

	@/usr/include/assert.h

22 #ifdef 
_ASSERT_H


24 #unde‡
_ASSERT_H


25 #unde‡
as£π


26 #unde‡
__ASSERT_VOID_CAST


28 #ifdef 
__USE_GNU


29 #unde‡
as£π_≥º‹


34 
	#_ASSERT_H
 1

	)

35 
	~<„©uªs.h
>

37 #i‡
deföed
 
__˝lu•lus
 && 
__GNUC_PREREQ
 (2,95)

38 
	#__ASSERT_VOID_CAST
 
°©ic_ˇ°
<>

	)

40 
	#__ASSERT_VOID_CAST
 ()

	)

48 #ifdef 
NDEBUG


50 
	#as£π
(
ex¥
Ë(
	`__ASSERT_VOID_CAST
 (0))

	)

58 #ifdef 
__USE_GNU


59 
	#as£π_≥º‹
(
î∫um
Ë(
	`__ASSERT_VOID_CAST
 (0))

	)

64 #i‚de‡
_ASSERT_H_DECLS


65 
	#_ASSERT_H_DECLS


	)

66 
__BEGIN_DECLS


69 
	$__as£π_Áû
 (c⁄° *
__as£πi⁄
, c⁄° *
__fûe
,

70 
__löe
, c⁄° *
__fun˘i⁄
)

71 
__THROW
 
	`__©åibuã__
 ((
__n‹ëu∫__
));

74 
	$__as£π_≥º‹_Áû
 (
__î∫um
, c⁄° *
__fûe
,

75 
__löe
, c⁄° *
__fun˘i⁄
)

76 
__THROW
 
	`__©åibuã__
 ((
__n‹ëu∫__
));

81 
	$__as£π
 (c⁄° *
__as£πi⁄
, c⁄° *
__fûe
, 
__löe
)

82 
__THROW
 
	`__©åibuã__
 ((
__n‹ëu∫__
));

85 
__END_DECLS


91 #i‡
deföed
 
__˝lu•lus


92 
	#as£π
(
ex¥
) \

93 (
°©ic_ˇ°
 <
boﬁ
> (
ex¥
) \

95 : 
	`__as£π_Áû
 (#ex¥, 
__FILE__
, 
__LINE__
, 
__ASSERT_FUNCTION
))

	)

96 #ñi‡!
deföed
 
__GNUC__
 || deföed 
__STRICT_ANSI__


97 
	#as£π
(
ex¥
) \

98 ((
ex¥
) \

99 ? 
	`__ASSERT_VOID_CAST
 (0) \

100 : 
	`__as£π_Áû
 (#ex¥, 
__FILE__
, 
__LINE__
, 
__ASSERT_FUNCTION
))

	)

107 
	#as£π
(
ex¥
) \

108 ((Ë ((
ex¥
Ë? 1 : 0), 
	`__exãnsi⁄__
 ({ \

109 i‡(
ex¥
) \

112 
	`__as£π_Áû
 (#ex¥, 
__FILE__
, 
__LINE__
, 
__ASSERT_FUNCTION
); \

113 
	}
}))

	)

116 #ifdef 
__USE_GNU


117 
	#as£π_≥º‹
(
î∫um
) \

118 (!(
î∫um
) \

119 ? 
	`__ASSERT_VOID_CAST
 (0) \

120 : 
	`__as£π_≥º‹_Áû
 ((
î∫um
), 
__FILE__
, 
__LINE__
, 
__ASSERT_FUNCTION
))

	)

128 #i‡
deföed
 
__˝lu•lus
 ? 
__GNUC_PREREQ
 (2, 6) : __GNUC_PREREQ (2, 4)

129 
	#__ASSERT_FUNCTION
 
__exãnsi⁄__
 
__PRETTY_FUNCTION__


	)

131 #i‡
deföed
 
__STDC_VERSION__
 && __STDC_VERSION__ >= 199901L

132 
	#__ASSERT_FUNCTION
 
__func__


	)

134 
	#__ASSERT_FUNCTION
 ((c⁄° *Ë0)

	)

141 #i‡
deföed
 
__USE_ISOC11
 && !deföed 
__˝lu•lus


142 #unde‡
°©ic_as£π


143 
	#°©ic_as£π
 
_Sètic_as£π


	)

	@/usr/include/stdio.h

23 #i‚de‡
_STDIO_H


24 
	#_STDIO_H
 1

	)

26 
	#__GLIBC_INTERNAL_STARTING_HEADER_IMPLEMENTATION


	)

27 
	~<bôs/libc-hódî-°¨t.h
>

29 
	g__BEGIN_DECLS


31 
	#__√ed_size_t


	)

32 
	#__√ed_NULL


	)

33 
	~<°ddef.h
>

35 
	~<bôs/ty≥s.h
>

36 
	~<bôs/ty≥s/__FILE.h
>

37 
	~<bôs/ty≥s/FILE.h
>

39 
	#_STDIO_USES_IOSTREAM


	)

41 
	~<bôs/libio.h
>

43 #i‡
deföed
 
__USE_XOPEN
 || deföed 
__USE_XOPEN2K8


44 #ifde‡
__GNUC__


45 #i‚de‡
_VA_LIST_DEFINED


46 
_G_va_li°
 
	tva_li°
;

47 
	#_VA_LIST_DEFINED


	)

50 
	~<°d¨g.h
>

54 #i‡
deföed
 
__USE_UNIX98
 || deföed 
__USE_XOPEN2K


55 #i‚de‡
__off_t_deföed


56 #i‚de‡
__USE_FILE_OFFSET64


57 
__off_t
 
	toff_t
;

59 
__off64_t
 
	toff_t
;

61 
	#__off_t_deföed


	)

63 #i‡
deföed
 
__USE_LARGEFILE64
 && !deföed 
__off64_t_deföed


64 
__off64_t
 
	toff64_t
;

65 
	#__off64_t_deföed


	)

69 #ifde‡
__USE_XOPEN2K8


70 #i‚de‡
__ssize_t_deföed


71 
__ssize_t
 
	tssize_t
;

72 
	#__ssize_t_deföed


	)

77 #i‚de‡
__USE_FILE_OFFSET64


78 
_G_Âos_t
 
	tÂos_t
;

80 
_G_Âos64_t
 
	tÂos_t
;

82 #ifde‡
__USE_LARGEFILE64


83 
_G_Âos64_t
 
	tÂos64_t
;

87 
	#_IOFBF
 0

	)

88 
	#_IOLBF
 1

	)

89 
	#_IONBF
 2

	)

93 #i‚de‡
BUFSIZ


94 
	#BUFSIZ
 
_IO_BUFSIZ


	)

100 #i‚de‡
EOF


101 
	#EOF
 (-1)

	)

107 
	#SEEK_SET
 0

	)

108 
	#SEEK_CUR
 1

	)

109 
	#SEEK_END
 2

	)

110 #ifde‡
__USE_GNU


111 
	#SEEK_DATA
 3

	)

112 
	#SEEK_HOLE
 4

	)

116 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_XOPEN


118 
	#P_tmpdú
 "/tmp"

	)

131 
	~<bôs/°dio_lim.h
>

135 
_IO_FILE
 *
°dö
;

136 
_IO_FILE
 *
°dout
;

137 
_IO_FILE
 *
°dîr
;

139 
	#°dö
 
°dö


	)

140 
	#°dout
 
°dout


	)

141 
	#°dîr
 
°dîr


	)

144 
	$ªmove
 (c⁄° *
__fûíame
Ë
__THROW
;

146 
	$ª«me
 (c⁄° *
__ﬁd
, c⁄° *
__√w
Ë
__THROW
;

148 #ifde‡
__USE_ATFILE


150 
	$ª«mót
 (
__ﬁdfd
, c⁄° *
__ﬁd
, 
__√wfd
,

151 c⁄° *
__√w
Ë
__THROW
;

158 #i‚de‡
__USE_FILE_OFFSET64


159 
FILE
 *
	$tmpfûe
 (Ë
__wur
;

161 #ifde‡
__REDIRECT


162 
FILE
 *
	`__REDIRECT
 (
tmpfûe
, (), 
tmpfûe64
Ë
__wur
;

164 
	#tmpfûe
 
tmpfûe64


	)

168 #ifde‡
__USE_LARGEFILE64


169 
FILE
 *
	$tmpfûe64
 (Ë
__wur
;

173 *
	$tm≤am
 (*
__s
Ë
__THROW
 
__wur
;

175 #ifde‡
__USE_MISC


178 *
	$tm≤am_r
 (*
__s
Ë
__THROW
 
__wur
;

182 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_XOPEN


190 *
	$ãm≤am
 (c⁄° *
__dú
, c⁄° *
__pfx
)

191 
__THROW
 
__©åibuã_mÆloc__
 
__wur
;

199 
	`f˛o£
 (
FILE
 *
__°ªam
);

204 
	`fÊush
 (
FILE
 *
__°ªam
);

206 #ifde‡
__USE_MISC


213 
	`fÊush_u∆ocked
 (
FILE
 *
__°ªam
);

216 #ifde‡
__USE_GNU


223 
	`f˛o£Æl
 ();

227 #i‚de‡
__USE_FILE_OFFSET64


232 
FILE
 *
	$f›í
 (c⁄° *
__ª°ri˘
 
__fûíame
,

233 c⁄° *
__ª°ri˘
 
__modes
Ë
__wur
;

238 
FILE
 *
	$‰e›í
 (c⁄° *
__ª°ri˘
 
__fûíame
,

239 c⁄° *
__ª°ri˘
 
__modes
,

240 
FILE
 *
__ª°ri˘
 
__°ªam
Ë
__wur
;

242 #ifde‡
__REDIRECT


243 
FILE
 *
	`__REDIRECT
 (
f›í
, (c⁄° *
__ª°ri˘
 
__fûíame
,

244 c⁄° *
__ª°ri˘
 
__modes
), 
f›í64
)

245 
__wur
;

246 
FILE
 *
	`__REDIRECT
 (
‰e›í
, (c⁄° *
__ª°ri˘
 
__fûíame
,

247 c⁄° *
__ª°ri˘
 
__modes
,

248 
FILE
 *
__ª°ri˘
 
__°ªam
), 
‰e›í64
)

249 
__wur
;

251 
	#f›í
 
f›í64


	)

252 
	#‰e›í
 
‰e›í64


	)

255 #ifde‡
__USE_LARGEFILE64


256 
FILE
 *
	$f›í64
 (c⁄° *
__ª°ri˘
 
__fûíame
,

257 c⁄° *
__ª°ri˘
 
__modes
Ë
__wur
;

258 
FILE
 *
	$‰e›í64
 (c⁄° *
__ª°ri˘
 
__fûíame
,

259 c⁄° *
__ª°ri˘
 
__modes
,

260 
FILE
 *
__ª°ri˘
 
__°ªam
Ë
__wur
;

263 #ifdef 
__USE_POSIX


265 
FILE
 *
	$fd›í
 (
__fd
, c⁄° *
__modes
Ë
__THROW
 
__wur
;

268 #ifdef 
__USE_GNU


271 
FILE
 *
	$f›ícookõ
 (*
__ª°ri˘
 
__magic_cookõ
,

272 c⁄° *
__ª°ri˘
 
__modes
,

273 
_IO_cookõ_io_fun˘i⁄s_t
 
__io_funcs
Ë
__THROW
 
__wur
;

276 #i‡
deföed
 
__USE_XOPEN2K8
 || 
	`__GLIBC_USE
 (
LIB_EXT2
)

278 
FILE
 *
	$fmem›í
 (*
__s
, 
size_t
 
__Àn
, c⁄° *
__modes
)

279 
__THROW
 
__wur
;

284 
FILE
 *
	$›í_mem°ªam
 (**
__buÊoc
, 
size_t
 *
__sizñoc
Ë
__THROW
 
__wur
;

290 
	$£tbuf
 (
FILE
 *
__ª°ri˘
 
__°ªam
, *__ª°ri˘ 
__buf
Ë
__THROW
;

294 
	$£tvbuf
 (
FILE
 *
__ª°ri˘
 
__°ªam
, *__ª°ri˘ 
__buf
,

295 
__modes
, 
size_t
 
__n
Ë
__THROW
;

297 #ifdef 
__USE_MISC


300 
	$£tbuf„r
 (
FILE
 *
__ª°ri˘
 
__°ªam
, *__ª°ri˘ 
__buf
,

301 
size_t
 
__size
Ë
__THROW
;

304 
	$£éöebuf
 (
FILE
 *
__°ªam
Ë
__THROW
;

312 
	`Ârötf
 (
FILE
 *
__ª°ri˘
 
__°ªam
,

313 c⁄° *
__ª°ri˘
 
__f‹m©
, ...);

318 
	`¥ötf
 (c⁄° *
__ª°ri˘
 
__f‹m©
, ...);

320 
	$•rötf
 (*
__ª°ri˘
 
__s
,

321 c⁄° *
__ª°ri˘
 
__f‹m©
, ...Ë
__THROWNL
;

327 
	`vÂrötf
 (
FILE
 *
__ª°ri˘
 
__s
, c⁄° *__ª°ri˘ 
__f‹m©
,

328 
_G_va_li°
 
__¨g
);

333 
	`v¥ötf
 (c⁄° *
__ª°ri˘
 
__f‹m©
, 
_G_va_li°
 
__¨g
);

335 
	$v•rötf
 (*
__ª°ri˘
 
__s
, c⁄° *__ª°ri˘ 
__f‹m©
,

336 
_G_va_li°
 
__¨g
Ë
__THROWNL
;

338 #i‡
deföed
 
__USE_ISOC99
 || deföed 
__USE_UNIX98


340 
	$¢¥ötf
 (*
__ª°ri˘
 
__s
, 
size_t
 
__maxÀn
,

341 c⁄° *
__ª°ri˘
 
__f‹m©
, ...)

342 
__THROWNL
 
	`__©åibuã__
 ((
	`__f‹m©__
 (
__¥ötf__
, 3, 4)));

344 
	$v¢¥ötf
 (*
__ª°ri˘
 
__s
, 
size_t
 
__maxÀn
,

345 c⁄° *
__ª°ri˘
 
__f‹m©
, 
_G_va_li°
 
__¨g
)

346 
__THROWNL
 
	`__©åibuã__
 ((
	`__f‹m©__
 (
__¥ötf__
, 3, 0)));

349 #i‡
	`__GLIBC_USE
 (
LIB_EXT2
)

352 
	$va•rötf
 (**
__ª°ri˘
 
__±r
, c⁄° *__ª°ri˘ 
__f
,

353 
_G_va_li°
 
__¨g
)

354 
__THROWNL
 
	`__©åibuã__
 ((
	$__f‹m©__
 (
__¥ötf__
, 2, 0))Ë
__wur
;

355 
	$__a•rötf
 (**
__ª°ri˘
 
__±r
,

356 c⁄° *
__ª°ri˘
 
__fmt
, ...)

357 
__THROWNL
 
	`__©åibuã__
 ((
	$__f‹m©__
 (
__¥ötf__
, 2, 3))Ë
__wur
;

358 
	$a•rötf
 (**
__ª°ri˘
 
__±r
,

359 c⁄° *
__ª°ri˘
 
__fmt
, ...)

360 
__THROWNL
 
	`__©åibuã__
 ((
	$__f‹m©__
 (
__¥ötf__
, 2, 3))Ë
__wur
;

363 #ifde‡
__USE_XOPEN2K8


365 
	$vd¥ötf
 (
__fd
, c⁄° *
__ª°ri˘
 
__fmt
,

366 
_G_va_li°
 
__¨g
)

367 
	`__©åibuã__
 ((
	`__f‹m©__
 (
__¥ötf__
, 2, 0)));

368 
	$d¥ötf
 (
__fd
, c⁄° *
__ª°ri˘
 
__fmt
, ...)

369 
	`__©åibuã__
 ((
	`__f‹m©__
 (
__¥ötf__
, 2, 3)));

377 
	$fsˇnf
 (
FILE
 *
__ª°ri˘
 
__°ªam
,

378 c⁄° *
__ª°ri˘
 
__f‹m©
, ...Ë
__wur
;

383 
	$sˇnf
 (c⁄° *
__ª°ri˘
 
__f‹m©
, ...Ë
__wur
;

385 
	$ssˇnf
 (c⁄° *
__ª°ri˘
 
__s
,

386 c⁄° *
__ª°ri˘
 
__f‹m©
, ...Ë
__THROW
;

388 #i‡
deföed
 
__USE_ISOC99
 && !deföed 
__USE_GNU
 \

389 && (!
deföed
 
__LDBL_COMPAT
 || !deföed 
__REDIRECT
) \

390 && (
deföed
 
__STRICT_ANSI__
 || deföed 
__USE_XOPEN2K
)

391 #ifde‡
__REDIRECT


395 
	`__REDIRECT
 (
fsˇnf
, (
FILE
 *
__ª°ri˘
 
__°ªam
,

396 c⁄° *
__ª°ri˘
 
__f‹m©
, ...),

397 
__isoc99_fsˇnf
Ë
__wur
;

398 
	`__REDIRECT
 (
sˇnf
, (c⁄° *
__ª°ri˘
 
__f‹m©
, ...),

399 
__isoc99_sˇnf
Ë
__wur
;

400 
	`__REDIRECT_NTH
 (
ssˇnf
, (c⁄° *
__ª°ri˘
 
__s
,

401 c⁄° *
__ª°ri˘
 
__f‹m©
, ...),

402 
__isoc99_ssˇnf
);

404 
	$__isoc99_fsˇnf
 (
FILE
 *
__ª°ri˘
 
__°ªam
,

405 c⁄° *
__ª°ri˘
 
__f‹m©
, ...Ë
__wur
;

406 
	$__isoc99_sˇnf
 (c⁄° *
__ª°ri˘
 
__f‹m©
, ...Ë
__wur
;

407 
	$__isoc99_ssˇnf
 (c⁄° *
__ª°ri˘
 
__s
,

408 c⁄° *
__ª°ri˘
 
__f‹m©
, ...Ë
__THROW
;

409 
	#fsˇnf
 
__isoc99_fsˇnf


	)

410 
	#sˇnf
 
__isoc99_sˇnf


	)

411 
	#ssˇnf
 
__isoc99_ssˇnf


	)

415 #ifdef 
__USE_ISOC99


420 
	$vfsˇnf
 (
FILE
 *
__ª°ri˘
 
__s
, c⁄° *__ª°ri˘ 
__f‹m©
,

421 
_G_va_li°
 
__¨g
)

422 
	`__©åibuã__
 ((
	$__f‹m©__
 (
__sˇnf__
, 2, 0))Ë
__wur
;

428 
	$vsˇnf
 (c⁄° *
__ª°ri˘
 
__f‹m©
, 
_G_va_li°
 
__¨g
)

429 
	`__©åibuã__
 ((
	$__f‹m©__
 (
__sˇnf__
, 1, 0))Ë
__wur
;

432 
	$vssˇnf
 (c⁄° *
__ª°ri˘
 
__s
,

433 c⁄° *
__ª°ri˘
 
__f‹m©
, 
_G_va_li°
 
__¨g
)

434 
__THROW
 
	`__©åibuã__
 ((
	`__f‹m©__
 (
__sˇnf__
, 2, 0)));

436 #i‡!
deföed
 
__USE_GNU
 \

437 && (!
deföed
 
__LDBL_COMPAT
 || !deföed 
__REDIRECT
) \

438 && (
deföed
 
__STRICT_ANSI__
 || deföed 
__USE_XOPEN2K
)

439 #ifde‡
__REDIRECT


443 
	`__REDIRECT
 (
vfsˇnf
,

444 (
FILE
 *
__ª°ri˘
 
__s
,

445 c⁄° *
__ª°ri˘
 
__f‹m©
, 
_G_va_li°
 
__¨g
),

446 
__isoc99_vfsˇnf
)

447 
	`__©åibuã__
 ((
	$__f‹m©__
 (
__sˇnf__
, 2, 0))Ë
__wur
;

448 
	`__REDIRECT
 (
vsˇnf
, (c⁄° *
__ª°ri˘
 
__f‹m©
,

449 
_G_va_li°
 
__¨g
), 
__isoc99_vsˇnf
)

450 
	`__©åibuã__
 ((
	$__f‹m©__
 (
__sˇnf__
, 1, 0))Ë
__wur
;

451 
	`__REDIRECT_NTH
 (
vssˇnf
,

452 (c⁄° *
__ª°ri˘
 
__s
,

453 c⁄° *
__ª°ri˘
 
__f‹m©
,

454 
_G_va_li°
 
__¨g
), 
__isoc99_vssˇnf
)

455 
	`__©åibuã__
 ((
	`__f‹m©__
 (
__sˇnf__
, 2, 0)));

457 
	$__isoc99_vfsˇnf
 (
FILE
 *
__ª°ri˘
 
__s
,

458 c⁄° *
__ª°ri˘
 
__f‹m©
,

459 
_G_va_li°
 
__¨g
Ë
__wur
;

460 
	$__isoc99_vsˇnf
 (c⁄° *
__ª°ri˘
 
__f‹m©
,

461 
_G_va_li°
 
__¨g
Ë
__wur
;

462 
	$__isoc99_vssˇnf
 (c⁄° *
__ª°ri˘
 
__s
,

463 c⁄° *
__ª°ri˘
 
__f‹m©
,

464 
_G_va_li°
 
__¨g
Ë
__THROW
;

465 
	#vfsˇnf
 
__isoc99_vfsˇnf


	)

466 
	#vsˇnf
 
__isoc99_vsˇnf


	)

467 
	#vssˇnf
 
__isoc99_vssˇnf


	)

477 
	`fgëc
 (
FILE
 *
__°ªam
);

478 
	`gëc
 (
FILE
 *
__°ªam
);

484 
	`gëch¨
 ();

488 
	#gëc
(
_Â
Ë
	`_IO_gëc
 (_Â)

	)

490 #ifde‡
__USE_POSIX199506


495 
	`gëc_u∆ocked
 (
FILE
 *
__°ªam
);

496 
	`gëch¨_u∆ocked
 ();

499 #ifde‡
__USE_MISC


506 
	`fgëc_u∆ocked
 (
FILE
 *
__°ªam
);

517 
	`Âutc
 (
__c
, 
FILE
 *
__°ªam
);

518 
	`putc
 (
__c
, 
FILE
 *
__°ªam
);

524 
	`putch¨
 (
__c
);

528 
	#putc
(
_ch
, 
_Â
Ë
	`_IO_putc
 (_ch, _Â)

	)

530 #ifde‡
__USE_MISC


537 
	`Âutc_u∆ocked
 (
__c
, 
FILE
 *
__°ªam
);

540 #ifde‡
__USE_POSIX199506


545 
	`putc_u∆ocked
 (
__c
, 
FILE
 *
__°ªam
);

546 
	`putch¨_u∆ocked
 (
__c
);

550 #i‡
deföed
 
__USE_MISC
 \

551 || (
deföed
 
__USE_XOPEN
 && !deföed 
__USE_XOPEN2K
)

553 
	`gëw
 (
FILE
 *
__°ªam
);

556 
	`putw
 (
__w
, 
FILE
 *
__°ªam
);

564 *
	$fgës
 (*
__ª°ri˘
 
__s
, 
__n
, 
FILE
 *__ª°ri˘ 
__°ªam
)

565 
__wur
;

567 #i‡
	`__GLIBC_USE
 (
DEPRECATED_GETS
)

577 *
	$gës
 (*
__s
Ë
__wur
 
__©åibuã_dïªˇãd__
;

580 #ifde‡
__USE_GNU


587 *
	$fgës_u∆ocked
 (*
__ª°ri˘
 
__s
, 
__n
,

588 
FILE
 *
__ª°ri˘
 
__°ªam
Ë
__wur
;

592 #i‡
deföed
 
__USE_XOPEN2K8
 || 
	`__GLIBC_USE
 (
LIB_EXT2
)

603 
_IO_ssize_t
 
	$__gëdñim
 (**
__ª°ri˘
 
__löïå
,

604 
size_t
 *
__ª°ri˘
 
__n
, 
__dñimôî
,

605 
FILE
 *
__ª°ri˘
 
__°ªam
Ë
__wur
;

606 
_IO_ssize_t
 
	$gëdñim
 (**
__ª°ri˘
 
__löïå
,

607 
size_t
 *
__ª°ri˘
 
__n
, 
__dñimôî
,

608 
FILE
 *
__ª°ri˘
 
__°ªam
Ë
__wur
;

616 
_IO_ssize_t
 
	$gëlöe
 (**
__ª°ri˘
 
__löïå
,

617 
size_t
 *
__ª°ri˘
 
__n
,

618 
FILE
 *
__ª°ri˘
 
__°ªam
Ë
__wur
;

626 
	`Âuts
 (c⁄° *
__ª°ri˘
 
__s
, 
FILE
 *__ª°ri˘ 
__°ªam
);

632 
	`puts
 (c⁄° *
__s
);

639 
	`ungëc
 (
__c
, 
FILE
 *
__°ªam
);

646 
size_t
 
	$‰ód
 (*
__ª°ri˘
 
__±r
, 
size_t
 
__size
,

647 
size_t
 
__n
, 
FILE
 *
__ª°ri˘
 
__°ªam
Ë
__wur
;

652 
size_t
 
	`fwrôe
 (c⁄° *
__ª°ri˘
 
__±r
, size_à
__size
,

653 
size_t
 
__n
, 
FILE
 *
__ª°ri˘
 
__s
);

655 #ifde‡
__USE_GNU


662 
	`Âuts_u∆ocked
 (c⁄° *
__ª°ri˘
 
__s
,

663 
FILE
 *
__ª°ri˘
 
__°ªam
);

666 #ifde‡
__USE_MISC


673 
size_t
 
	$‰ód_u∆ocked
 (*
__ª°ri˘
 
__±r
, 
size_t
 
__size
,

674 
size_t
 
__n
, 
FILE
 *
__ª°ri˘
 
__°ªam
Ë
__wur
;

675 
size_t
 
	`fwrôe_u∆ocked
 (c⁄° *
__ª°ri˘
 
__±r
, size_à
__size
,

676 
size_t
 
__n
, 
FILE
 *
__ª°ri˘
 
__°ªam
);

684 
	`f£ek
 (
FILE
 *
__°ªam
, 
__off
, 
__whí˚
);

689 
	$·ñl
 (
FILE
 *
__°ªam
Ë
__wur
;

694 
	`ªwöd
 (
FILE
 *
__°ªam
);

701 #i‡
deföed
 
__USE_LARGEFILE
 || deföed 
__USE_XOPEN2K


702 #i‚de‡
__USE_FILE_OFFSET64


707 
	`f£eko
 (
FILE
 *
__°ªam
, 
__off_t
 
__off
, 
__whí˚
);

712 
__off_t
 
	$·ñlo
 (
FILE
 *
__°ªam
Ë
__wur
;

714 #ifde‡
__REDIRECT


715 
	`__REDIRECT
 (
f£eko
,

716 (
FILE
 *
__°ªam
, 
__off64_t
 
__off
, 
__whí˚
),

717 
f£eko64
);

718 
__off64_t
 
	`__REDIRECT
 (
·ñlo
, (
FILE
 *
__°ªam
), 
·ñlo64
);

720 
	#f£eko
 
f£eko64


	)

721 
	#·ñlo
 
·ñlo64


	)

726 #i‚de‡
__USE_FILE_OFFSET64


731 
	`fgëpos
 (
FILE
 *
__ª°ri˘
 
__°ªam
, 
Âos_t
 *__ª°ri˘ 
__pos
);

736 
	`f£ços
 (
FILE
 *
__°ªam
, c⁄° 
Âos_t
 *
__pos
);

738 #ifde‡
__REDIRECT


739 
	`__REDIRECT
 (
fgëpos
, (
FILE
 *
__ª°ri˘
 
__°ªam
,

740 
Âos_t
 *
__ª°ri˘
 
__pos
), 
fgëpos64
);

741 
	`__REDIRECT
 (
f£ços
,

742 (
FILE
 *
__°ªam
, c⁄° 
Âos_t
 *
__pos
), 
f£ços64
);

744 
	#fgëpos
 
fgëpos64


	)

745 
	#f£ços
 
f£ços64


	)

749 #ifde‡
__USE_LARGEFILE64


750 
	`f£eko64
 (
FILE
 *
__°ªam
, 
__off64_t
 
__off
, 
__whí˚
);

751 
__off64_t
 
	$·ñlo64
 (
FILE
 *
__°ªam
Ë
__wur
;

752 
	`fgëpos64
 (
FILE
 *
__ª°ri˘
 
__°ªam
, 
Âos64_t
 *__ª°ri˘ 
__pos
);

753 
	`f£ços64
 (
FILE
 *
__°ªam
, c⁄° 
Âos64_t
 *
__pos
);

757 
	$˛óªº
 (
FILE
 *
__°ªam
Ë
__THROW
;

759 
	$„of
 (
FILE
 *
__°ªam
Ë
__THROW
 
__wur
;

761 
	$„º‹
 (
FILE
 *
__°ªam
Ë
__THROW
 
__wur
;

763 #ifde‡
__USE_MISC


765 
	$˛óªº_u∆ocked
 (
FILE
 *
__°ªam
Ë
__THROW
;

766 
	$„of_u∆ocked
 (
FILE
 *
__°ªam
Ë
__THROW
 
__wur
;

767 
	$„º‹_u∆ocked
 (
FILE
 *
__°ªam
Ë
__THROW
 
__wur
;

775 
	`≥º‹
 (c⁄° *
__s
);

781 
	~<bôs/sys_îæi°.h
>

784 #ifdef 
__USE_POSIX


786 
	$fûío
 (
FILE
 *
__°ªam
Ë
__THROW
 
__wur
;

789 #ifde‡
__USE_MISC


791 
	$fûío_u∆ocked
 (
FILE
 *
__°ªam
Ë
__THROW
 
__wur
;

795 #ifde‡
__USE_POSIX2


800 
FILE
 *
	$p›í
 (c⁄° *
__comm™d
, c⁄° *
__modes
Ë
__wur
;

806 
	`p˛o£
 (
FILE
 *
__°ªam
);

810 #ifdef 
__USE_POSIX


812 *
	$˘îmid
 (*
__s
Ë
__THROW
;

816 #i‡(
deföed
 
__USE_XOPEN
 && !deföed 
__USE_XOPEN2K
Ë|| deföed 
__USE_GNU


818 *
	`cu£rid
 (*
__s
);

822 #ifdef 
__USE_GNU


823 
ob°ack
;

826 
	$ob°ack_¥ötf
 (
ob°ack
 *
__ª°ri˘
 
__ob°ack
,

827 c⁄° *
__ª°ri˘
 
__f‹m©
, ...)

828 
__THROWNL
 
	`__©åibuã__
 ((
	`__f‹m©__
 (
__¥ötf__
, 2, 3)));

829 
	$ob°ack_v¥ötf
 (
ob°ack
 *
__ª°ri˘
 
__ob°ack
,

830 c⁄° *
__ª°ri˘
 
__f‹m©
,

831 
_G_va_li°
 
__¨gs
)

832 
__THROWNL
 
	`__©åibuã__
 ((
	`__f‹m©__
 (
__¥ötf__
, 2, 0)));

836 #ifde‡
__USE_POSIX199506


840 
	$Êockfûe
 (
FILE
 *
__°ªam
Ë
__THROW
;

844 
	$·rylockfûe
 (
FILE
 *
__°ªam
Ë
__THROW
 
__wur
;

847 
	$fu∆ockfûe
 (
FILE
 *
__°ªam
Ë
__THROW
;

850 #i‡
deföed
 
__USE_XOPEN
 && !deföed 
__USE_XOPEN2K
 && !deföed 
__USE_GNU


853 
	~<bôs/gë›t_posix.h
>

858 #ifde‡
__USE_EXTERN_INLINES


859 
	~<bôs/°dio.h
>

861 #i‡
__USE_FORTIFY_LEVEL
 > 0 && 
deföed
 
__f‹tify_fun˘i⁄


862 
	~<bôs/°dio2.h
>

864 #ifde‡
__LDBL_COMPAT


865 
	~<bôs/°dio-ldbl.h
>

868 
__END_DECLS


	@/usr/include/stdlib.h

22 #i‚def 
_STDLIB_H


24 
	#__GLIBC_INTERNAL_STARTING_HEADER_IMPLEMENTATION


	)

25 
	~<bôs/libc-hódî-°¨t.h
>

28 
	#__√ed_size_t


	)

29 
	#__√ed_wch¨_t


	)

30 
	#__√ed_NULL


	)

31 
	~<°ddef.h
>

33 
	g__BEGIN_DECLS


35 
	#_STDLIB_H
 1

	)

37 #i‡(
deföed
 
__USE_XOPEN
 || deföed 
__USE_XOPEN2K8
Ë&& !deföed 
_SYS_WAIT_H


39 
	~<bôs/waôÊags.h
>

40 
	~<bôs/waô°©us.h
>

43 
	#WEXITSTATUS
(
°©us
Ë
	`__WEXITSTATUS
 (°©us)

	)

44 
	#WTERMSIG
(
°©us
Ë
	`__WTERMSIG
 (°©us)

	)

45 
	#WSTOPSIG
(
°©us
Ë
	`__WSTOPSIG
 (°©us)

	)

46 
	#WIFEXITED
(
°©us
Ë
	`__WIFEXITED
 (°©us)

	)

47 
	#WIFSIGNALED
(
°©us
Ë
	`__WIFSIGNALED
 (°©us)

	)

48 
	#WIFSTOPPED
(
°©us
Ë
	`__WIFSTOPPED
 (°©us)

	)

49 #ifde‡
__WIFCONTINUED


50 
	#WIFCONTINUED
(
°©us
Ë
	`__WIFCONTINUED
 (°©us)

	)

55 
	~<bôs/Êﬂä.h
>

60 
	mquŸ
;

61 
	mªm
;

62 } 
	tdiv_t
;

65 #i‚de‡
__ldiv_t_deföed


68 
	mquŸ
;

69 
	mªm
;

70 } 
	tldiv_t
;

71 
	#__ldiv_t_deföed
 1

	)

74 #i‡
deföed
 
__USE_ISOC99
 && !deföed 
__Œdiv_t_deföed


76 
__exãnsi⁄__
 struct

78 
	mquŸ
;

79 
	mªm
;

80 } 
	tŒdiv_t
;

81 
	#__Œdiv_t_deföed
 1

	)

86 
	#RAND_MAX
 2147483647

	)

91 
	#EXIT_FAILURE
 1

	)

92 
	#EXIT_SUCCESS
 0

	)

96 
	#MB_CUR_MAX
 (
	`__˘y≥_gë_mb_cur_max
 ())

	)

97 
size_t
 
	$__˘y≥_gë_mb_cur_max
 (Ë
__THROW
 
__wur
;

101 
	$©of
 (c⁄° *
__≈å
)

102 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

104 
	$©oi
 (c⁄° *
__≈å
)

105 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

107 
	$©ﬁ
 (c⁄° *
__≈å
)

108 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

110 #ifde‡
__USE_ISOC99


112 
__exãnsi⁄__
 
	$©ﬁl
 (c⁄° *
__≈å
)

113 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

117 
	$°πod
 (c⁄° *
__ª°ri˘
 
__≈å
,

118 **
__ª°ri˘
 
__íd±r
)

119 
__THROW
 
	`__n⁄nuŒ
 ((1));

121 #ifdef 
__USE_ISOC99


123 
	$°πof
 (c⁄° *
__ª°ri˘
 
__≈å
,

124 **
__ª°ri˘
 
__íd±r
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

126 
	$°πﬁd
 (c⁄° *
__ª°ri˘
 
__≈å
,

127 **
__ª°ri˘
 
__íd±r
)

128 
__THROW
 
	`__n⁄nuŒ
 ((1));

133 #i‡
__HAVE_FLOAT16
 && 
	`__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

134 
_Flﬂt16
 
	$°πof16
 (c⁄° *
__ª°ri˘
 
__≈å
,

135 **
__ª°ri˘
 
__íd±r
)

136 
__THROW
 
	`__n⁄nuŒ
 ((1));

139 #i‡
__HAVE_FLOAT32
 && 
	`__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

140 
_Flﬂt32
 
	$°πof32
 (c⁄° *
__ª°ri˘
 
__≈å
,

141 **
__ª°ri˘
 
__íd±r
)

142 
__THROW
 
	`__n⁄nuŒ
 ((1));

145 #i‡
__HAVE_FLOAT64
 && 
	`__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

146 
_Flﬂt64
 
	$°πof64
 (c⁄° *
__ª°ri˘
 
__≈å
,

147 **
__ª°ri˘
 
__íd±r
)

148 
__THROW
 
	`__n⁄nuŒ
 ((1));

151 #i‡
__HAVE_FLOAT128
 && 
	`__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

152 
_Flﬂt128
 
	$°πof128
 (c⁄° *
__ª°ri˘
 
__≈å
,

153 **
__ª°ri˘
 
__íd±r
)

154 
__THROW
 
	`__n⁄nuŒ
 ((1));

157 #i‡
__HAVE_FLOAT32X
 && 
	`__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

158 
_Flﬂt32x
 
	$°πof32x
 (c⁄° *
__ª°ri˘
 
__≈å
,

159 **
__ª°ri˘
 
__íd±r
)

160 
__THROW
 
	`__n⁄nuŒ
 ((1));

163 #i‡
__HAVE_FLOAT64X
 && 
	`__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

164 
_Flﬂt64x
 
	$°πof64x
 (c⁄° *
__ª°ri˘
 
__≈å
,

165 **
__ª°ri˘
 
__íd±r
)

166 
__THROW
 
	`__n⁄nuŒ
 ((1));

169 #i‡
__HAVE_FLOAT128X
 && 
	`__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

170 
_Flﬂt128x
 
	$°πof128x
 (c⁄° *
__ª°ri˘
 
__≈å
,

171 **
__ª°ri˘
 
__íd±r
)

172 
__THROW
 
	`__n⁄nuŒ
 ((1));

176 
	$°πﬁ
 (c⁄° *
__ª°ri˘
 
__≈å
,

177 **
__ª°ri˘
 
__íd±r
, 
__ba£
)

178 
__THROW
 
	`__n⁄nuŒ
 ((1));

180 
	$°πoul
 (c⁄° *
__ª°ri˘
 
__≈å
,

181 **
__ª°ri˘
 
__íd±r
, 
__ba£
)

182 
__THROW
 
	`__n⁄nuŒ
 ((1));

184 #ifde‡
__USE_MISC


186 
__exãnsi⁄__


187 
	$°πoq
 (c⁄° *
__ª°ri˘
 
__≈å
,

188 **
__ª°ri˘
 
__íd±r
, 
__ba£
)

189 
__THROW
 
	`__n⁄nuŒ
 ((1));

191 
__exãnsi⁄__


192 
	$°πouq
 (c⁄° *
__ª°ri˘
 
__≈å
,

193 **
__ª°ri˘
 
__íd±r
, 
__ba£
)

194 
__THROW
 
	`__n⁄nuŒ
 ((1));

197 #ifde‡
__USE_ISOC99


199 
__exãnsi⁄__


200 
	$°πﬁl
 (c⁄° *
__ª°ri˘
 
__≈å
,

201 **
__ª°ri˘
 
__íd±r
, 
__ba£
)

202 
__THROW
 
	`__n⁄nuŒ
 ((1));

204 
__exãnsi⁄__


205 
	$°πouŒ
 (c⁄° *
__ª°ri˘
 
__≈å
,

206 **
__ª°ri˘
 
__íd±r
, 
__ba£
)

207 
__THROW
 
	`__n⁄nuŒ
 ((1));

211 #i‡
	`__GLIBC_USE
 (
IEC_60559_BFP_EXT
)

212 
	$°r‰omd
 (*
__de°
, 
size_t
 
__size
, c⁄° *
__f‹m©
,

213 
__f
)

214 
__THROW
 
	`__n⁄nuŒ
 ((3));

216 
	$°r‰omf
 (*
__de°
, 
size_t
 
__size
, c⁄° *
__f‹m©
,

217 
__f
)

218 
__THROW
 
	`__n⁄nuŒ
 ((3));

220 
	$°r‰oml
 (*
__de°
, 
size_t
 
__size
, c⁄° *
__f‹m©
,

221 
__f
)

222 
__THROW
 
	`__n⁄nuŒ
 ((3));

225 #i‡
__HAVE_FLOAT16
 && 
	`__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

226 
	$°r‰omf16
 (*
__de°
, 
size_t
 
__size
, c⁄° * 
__f‹m©
,

227 
_Flﬂt16
 
__f
)

228 
__THROW
 
	`__n⁄nuŒ
 ((3));

231 #i‡
__HAVE_FLOAT32
 && 
	`__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

232 
	$°r‰omf32
 (*
__de°
, 
size_t
 
__size
, c⁄° * 
__f‹m©
,

233 
_Flﬂt32
 
__f
)

234 
__THROW
 
	`__n⁄nuŒ
 ((3));

237 #i‡
__HAVE_FLOAT64
 && 
	`__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

238 
	$°r‰omf64
 (*
__de°
, 
size_t
 
__size
, c⁄° * 
__f‹m©
,

239 
_Flﬂt64
 
__f
)

240 
__THROW
 
	`__n⁄nuŒ
 ((3));

243 #i‡
__HAVE_FLOAT128
 && 
	`__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

244 
	$°r‰omf128
 (*
__de°
, 
size_t
 
__size
, c⁄° * 
__f‹m©
,

245 
_Flﬂt128
 
__f
)

246 
__THROW
 
	`__n⁄nuŒ
 ((3));

249 #i‡
__HAVE_FLOAT32X
 && 
	`__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

250 
	$°r‰omf32x
 (*
__de°
, 
size_t
 
__size
, c⁄° * 
__f‹m©
,

251 
_Flﬂt32x
 
__f
)

252 
__THROW
 
	`__n⁄nuŒ
 ((3));

255 #i‡
__HAVE_FLOAT64X
 && 
	`__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

256 
	$°r‰omf64x
 (*
__de°
, 
size_t
 
__size
, c⁄° * 
__f‹m©
,

257 
_Flﬂt64x
 
__f
)

258 
__THROW
 
	`__n⁄nuŒ
 ((3));

261 #i‡
__HAVE_FLOAT128X
 && 
	`__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

262 
	$°r‰omf128x
 (*
__de°
, 
size_t
 
__size
, c⁄° * 
__f‹m©
,

263 
_Flﬂt128x
 
__f
)

264 
__THROW
 
	`__n⁄nuŒ
 ((3));

268 #ifde‡
__USE_GNU


272 
	~<bôs/ty≥s/loˇÀ_t.h
>

274 
	$°πﬁ_l
 (c⁄° *
__ª°ri˘
 
__≈å
,

275 **
__ª°ri˘
 
__íd±r
, 
__ba£
,

276 
loˇÀ_t
 
__loc
Ë
__THROW
 
	`__n⁄nuŒ
 ((1, 4));

278 
	$°πoul_l
 (c⁄° *
__ª°ri˘
 
__≈å
,

279 **
__ª°ri˘
 
__íd±r
,

280 
__ba£
, 
loˇÀ_t
 
__loc
)

281 
__THROW
 
	`__n⁄nuŒ
 ((1, 4));

283 
__exãnsi⁄__


284 
	$°πﬁl_l
 (c⁄° *
__ª°ri˘
 
__≈å
,

285 **
__ª°ri˘
 
__íd±r
, 
__ba£
,

286 
loˇÀ_t
 
__loc
)

287 
__THROW
 
	`__n⁄nuŒ
 ((1, 4));

289 
__exãnsi⁄__


290 
	$°πouŒ_l
 (c⁄° *
__ª°ri˘
 
__≈å
,

291 **
__ª°ri˘
 
__íd±r
,

292 
__ba£
, 
loˇÀ_t
 
__loc
)

293 
__THROW
 
	`__n⁄nuŒ
 ((1, 4));

295 
	$°πod_l
 (c⁄° *
__ª°ri˘
 
__≈å
,

296 **
__ª°ri˘
 
__íd±r
, 
loˇÀ_t
 
__loc
)

297 
__THROW
 
	`__n⁄nuŒ
 ((1, 3));

299 
	$°πof_l
 (c⁄° *
__ª°ri˘
 
__≈å
,

300 **
__ª°ri˘
 
__íd±r
, 
loˇÀ_t
 
__loc
)

301 
__THROW
 
	`__n⁄nuŒ
 ((1, 3));

303 
	$°πﬁd_l
 (c⁄° *
__ª°ri˘
 
__≈å
,

304 **
__ª°ri˘
 
__íd±r
,

305 
loˇÀ_t
 
__loc
)

306 
__THROW
 
	`__n⁄nuŒ
 ((1, 3));

308 #i‡
__HAVE_FLOAT16


309 
_Flﬂt16
 
	$°πof16_l
 (c⁄° *
__ª°ri˘
 
__≈å
,

310 **
__ª°ri˘
 
__íd±r
,

311 
loˇÀ_t
 
__loc
)

312 
__THROW
 
	`__n⁄nuŒ
 ((1, 3));

315 #i‡
__HAVE_FLOAT32


316 
_Flﬂt32
 
	$°πof32_l
 (c⁄° *
__ª°ri˘
 
__≈å
,

317 **
__ª°ri˘
 
__íd±r
,

318 
loˇÀ_t
 
__loc
)

319 
__THROW
 
	`__n⁄nuŒ
 ((1, 3));

322 #i‡
__HAVE_FLOAT64


323 
_Flﬂt64
 
	$°πof64_l
 (c⁄° *
__ª°ri˘
 
__≈å
,

324 **
__ª°ri˘
 
__íd±r
,

325 
loˇÀ_t
 
__loc
)

326 
__THROW
 
	`__n⁄nuŒ
 ((1, 3));

329 #i‡
__HAVE_FLOAT128


330 
_Flﬂt128
 
	$°πof128_l
 (c⁄° *
__ª°ri˘
 
__≈å
,

331 **
__ª°ri˘
 
__íd±r
,

332 
loˇÀ_t
 
__loc
)

333 
__THROW
 
	`__n⁄nuŒ
 ((1, 3));

336 #i‡
__HAVE_FLOAT32X


337 
_Flﬂt32x
 
	$°πof32x_l
 (c⁄° *
__ª°ri˘
 
__≈å
,

338 **
__ª°ri˘
 
__íd±r
,

339 
loˇÀ_t
 
__loc
)

340 
__THROW
 
	`__n⁄nuŒ
 ((1, 3));

343 #i‡
__HAVE_FLOAT64X


344 
_Flﬂt64x
 
	$°πof64x_l
 (c⁄° *
__ª°ri˘
 
__≈å
,

345 **
__ª°ri˘
 
__íd±r
,

346 
loˇÀ_t
 
__loc
)

347 
__THROW
 
	`__n⁄nuŒ
 ((1, 3));

350 #i‡
__HAVE_FLOAT128X


351 
_Flﬂt128x
 
	$°πof128x_l
 (c⁄° *
__ª°ri˘
 
__≈å
,

352 **
__ª°ri˘
 
__íd±r
,

353 
loˇÀ_t
 
__loc
)

354 
__THROW
 
	`__n⁄nuŒ
 ((1, 3));

359 #ifde‡
__USE_EXTERN_INLINES


360 
__exã∫_ölöe
 

361 
	`__NTH
 (
	$©oi
 (c⁄° *
__≈å
))

363  (Ë
	`°πﬁ
 (
__≈å
, (**Ë
NULL
, 10);

364 
	}
}

365 
__exã∫_ölöe
 

366 
__NTH
 (
	$©ﬁ
 (c⁄° *
__≈å
))

368  
	`°πﬁ
 (
__≈å
, (**Ë
NULL
, 10);

369 
	}
}

371 #ifde‡
__USE_ISOC99


372 
__exãnsi⁄__
 
__exã∫_ölöe
 

373 
__NTH
 (
	$©ﬁl
 (c⁄° *
__≈å
))

375  
	`°πﬁl
 (
__≈å
, (**Ë
NULL
, 10);

376 
	}
}

381 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_XOPEN_EXTENDED


385 *
	$l64a
 (
__n
Ë
__THROW
 
__wur
;

388 
	$a64l
 (c⁄° *
__s
)

389 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

393 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_XOPEN_EXTENDED


394 
	~<sys/ty≥s.h
>

401 
	$øndom
 (Ë
__THROW
;

404 
	$§™dom
 (
__£ed
Ë
__THROW
;

410 *
	$öô°©e
 (
__£ed
, *
__°©ebuf
,

411 
size_t
 
__°©ñí
Ë
__THROW
 
	`__n⁄nuŒ
 ((2));

415 *
	$£t°©e
 (*
__°©ebuf
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

418 #ifde‡
__USE_MISC


423 
	søndom_d©a


425 
öt32_t
 *
Âå
;

426 
öt32_t
 *
Ωå
;

427 
öt32_t
 *
°©e
;

428 
ønd_ty≥
;

429 
ønd_deg
;

430 
ønd_£p
;

431 
öt32_t
 *
íd_±r
;

434 
	$øndom_r
 (
øndom_d©a
 *
__ª°ri˘
 
__buf
,

435 
öt32_t
 *
__ª°ri˘
 
__ªsu…
Ë
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

437 
	$§™dom_r
 (
__£ed
, 
øndom_d©a
 *
__buf
)

438 
__THROW
 
	`__n⁄nuŒ
 ((2));

440 
	$öô°©e_r
 (
__£ed
, *
__ª°ri˘
 
__°©ebuf
,

441 
size_t
 
__°©ñí
,

442 
øndom_d©a
 *
__ª°ri˘
 
__buf
)

443 
__THROW
 
	`__n⁄nuŒ
 ((2, 4));

445 
	$£t°©e_r
 (*
__ª°ri˘
 
__°©ebuf
,

446 
øndom_d©a
 *
__ª°ri˘
 
__buf
)

447 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

453 
	$ønd
 (Ë
__THROW
;

455 
	$§™d
 (
__£ed
Ë
__THROW
;

457 #ifde‡
__USE_POSIX199506


459 
	$ønd_r
 (*
__£ed
Ë
__THROW
;

463 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_XOPEN


467 
	$dønd48
 (Ë
__THROW
;

468 
	$î™d48
 (
__xsubi
[3]Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

471 
	$Ã™d48
 (Ë
__THROW
;

472 
	$ƒ™d48
 (
__xsubi
[3])

473 
__THROW
 
	`__n⁄nuŒ
 ((1));

476 
	$mønd48
 (Ë
__THROW
;

477 
	$jønd48
 (
__xsubi
[3])

478 
__THROW
 
	`__n⁄nuŒ
 ((1));

481 
	$§™d48
 (
__£edvÆ
Ë
__THROW
;

482 *
	$£ed48
 (
__£ed16v
[3])

483 
__THROW
 
	`__n⁄nuŒ
 ((1));

484 
	$lc⁄g48
 (
__∑øm
[7]Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

486 #ifde‡
__USE_MISC


490 
	sdønd48_d©a


492 
__x
[3];

493 
__ﬁd_x
[3];

494 
__c
;

495 
__öô
;

496 
__exãnsi⁄__
 
__a
;

501 
	$dønd48_r
 (
dønd48_d©a
 *
__ª°ri˘
 
__buf„r
,

502 *
__ª°ri˘
 
__ªsu…
Ë
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

503 
	$î™d48_r
 (
__xsubi
[3],

504 
dønd48_d©a
 *
__ª°ri˘
 
__buf„r
,

505 *
__ª°ri˘
 
__ªsu…
Ë
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

508 
	$Ã™d48_r
 (
dønd48_d©a
 *
__ª°ri˘
 
__buf„r
,

509 *
__ª°ri˘
 
__ªsu…
)

510 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

511 
	$ƒ™d48_r
 (
__xsubi
[3],

512 
dønd48_d©a
 *
__ª°ri˘
 
__buf„r
,

513 *
__ª°ri˘
 
__ªsu…
)

514 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

517 
	$mønd48_r
 (
dønd48_d©a
 *
__ª°ri˘
 
__buf„r
,

518 *
__ª°ri˘
 
__ªsu…
)

519 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

520 
	$jønd48_r
 (
__xsubi
[3],

521 
dønd48_d©a
 *
__ª°ri˘
 
__buf„r
,

522 *
__ª°ri˘
 
__ªsu…
)

523 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

526 
	$§™d48_r
 (
__£edvÆ
, 
dønd48_d©a
 *
__buf„r
)

527 
__THROW
 
	`__n⁄nuŒ
 ((2));

529 
	$£ed48_r
 (
__£ed16v
[3],

530 
dønd48_d©a
 *
__buf„r
Ë
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

532 
	$lc⁄g48_r
 (
__∑øm
[7],

533 
dønd48_d©a
 *
__buf„r
)

534 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

539 *
	$mÆloc
 (
size_t
 
__size
Ë
__THROW
 
__©åibuã_mÆloc__
 
__wur
;

541 *
	$ˇŒoc
 (
size_t
 
__nmemb
, size_à
__size
)

542 
__THROW
 
__©åibuã_mÆloc__
 
__wur
;

549 *
	$ªÆloc
 (*
__±r
, 
size_t
 
__size
)

550 
__THROW
 
__©åibuã_w¨n_unu£d_ªsu…__
;

552 #ifde‡
__USE_GNU


558 *
	$ªÆloˇºay
 (*
__±r
, 
size_t
 
__nmemb
, size_à
__size
)

559 
__THROW
 
__©åibuã_w¨n_unu£d_ªsu…__
;

563 
	$‰ì
 (*
__±r
Ë
__THROW
;

565 #ifde‡
__USE_MISC


566 
	~<Æloˇ.h
>

569 #i‡(
deföed
 
__USE_XOPEN_EXTENDED
 && !deföed 
__USE_XOPEN2K
) \

570 || 
deföed
 
__USE_MISC


572 *
	$vÆloc
 (
size_t
 
__size
Ë
__THROW
 
__©åibuã_mÆloc__
 
__wur
;

575 #ifde‡
__USE_XOPEN2K


577 
	$posix_memÆign
 (**
__mem±r
, 
size_t
 
__Æignmít
, size_à
__size
)

578 
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

581 #ifde‡
__USE_ISOC11


583 *
	$Æig√d_Æloc
 (
size_t
 
__Æignmít
, size_à
__size
)

584 
__THROW
 
__©åibuã_mÆloc__
 
	`__©åibuã_Æloc_size__
 ((2)Ë
__wur
;

588 
	$ab‹t
 (Ë
__THROW
 
	`__©åibuã__
 ((
__n‹ëu∫__
));

592 
	$©exô
 ((*
__func
Ë()Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

594 #i‡
deföed
 
__USE_ISOC11
 || deföed 
__USE_ISOCXX11


596 #ifde‡
__˝lu•lus


597 "C++" 
	$©_quick_exô
 ((*
__func
) ())

598 
__THROW
 
	`__asm
 ("©_quick_exô"Ë
	`__n⁄nuŒ
 ((1));

600 
	$©_quick_exô
 ((*
__func
Ë()Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

604 #ifdef 
__USE_MISC


607 
	$⁄_exô
 ((*
__func
Ë(
__°©us
, *
__¨g
), *__arg)

608 
__THROW
 
	`__n⁄nuŒ
 ((1));

614 
	$exô
 (
__°©us
Ë
__THROW
 
	`__©åibuã__
 ((
__n‹ëu∫__
));

616 #i‡
deföed
 
__USE_ISOC11
 || deföed 
__USE_ISOCXX11


620 
	$quick_exô
 (
__°©us
Ë
__THROW
 
	`__©åibuã__
 ((
__n‹ëu∫__
));

623 #ifde‡
__USE_ISOC99


626 
	$_Exô
 (
__°©us
Ë
__THROW
 
	`__©åibuã__
 ((
__n‹ëu∫__
));

631 *
	$gëív
 (c⁄° *
__«me
Ë
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

633 #ifde‡
__USE_GNU


636 *
	$£cuª_gëív
 (c⁄° *
__«me
)

637 
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

640 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_XOPEN


644 
	$puãnv
 (*
__°rög
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

647 #ifde‡
__USE_XOPEN2K


650 
	$£ãnv
 (c⁄° *
__«me
, c⁄° *
__vÆue
, 
__ª∂a˚
)

651 
__THROW
 
	`__n⁄nuŒ
 ((2));

654 
	$un£ãnv
 (c⁄° *
__«me
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

657 #ifdef 
__USE_MISC


661 
	$˛óªnv
 (Ë
__THROW
;

665 #i‡
deföed
 
__USE_MISC
 \

666 || (
deföed
 
__USE_XOPEN_EXTENDED
 && !deföed 
__USE_XOPEN2K8
)

672 *
	$mkãmp
 (*
__ãm∂©e
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

675 #i‡
deföed
 
__USE_XOPEN_EXTENDED
 || deföed 
__USE_XOPEN2K8


684 #i‚de‡
__USE_FILE_OFFSET64


685 
	$mk°emp
 (*
__ãm∂©e
Ë
	`__n⁄nuŒ
 ((1)Ë
__wur
;

687 #ifde‡
__REDIRECT


688 
	`__REDIRECT
 (
mk°emp
, (*
__ãm∂©e
), 
mk°emp64
)

689 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

691 
	#mk°emp
 
mk°emp64


	)

694 #ifde‡
__USE_LARGEFILE64


695 
	$mk°emp64
 (*
__ãm∂©e
Ë
	`__n⁄nuŒ
 ((1)Ë
__wur
;

699 #ifde‡
__USE_MISC


706 #i‚de‡
__USE_FILE_OFFSET64


707 
	$mk°emps
 (*
__ãm∂©e
, 
__suffixÀn
Ë
	`__n⁄nuŒ
 ((1)Ë
__wur
;

709 #ifde‡
__REDIRECT


710 
	`__REDIRECT
 (
mk°emps
, (*
__ãm∂©e
, 
__suffixÀn
),

711 
mk°emps64
Ë
	`__n⁄nuŒ
 ((1)Ë
__wur
;

713 
	#mk°emps
 
mk°emps64


	)

716 #ifde‡
__USE_LARGEFILE64


717 
	$mk°emps64
 (*
__ãm∂©e
, 
__suffixÀn
)

718 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

722 #ifde‡
__USE_XOPEN2K8


728 *
	$mkdãmp
 (*
__ãm∂©e
Ë
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

731 #ifde‡
__USE_GNU


738 #i‚de‡
__USE_FILE_OFFSET64


739 
	$mko°emp
 (*
__ãm∂©e
, 
__Êags
Ë
	`__n⁄nuŒ
 ((1)Ë
__wur
;

741 #ifde‡
__REDIRECT


742 
	`__REDIRECT
 (
mko°emp
, (*
__ãm∂©e
, 
__Êags
), 
mko°emp64
)

743 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

745 
	#mko°emp
 
mko°emp64


	)

748 #ifde‡
__USE_LARGEFILE64


749 
	$mko°emp64
 (*
__ãm∂©e
, 
__Êags
Ë
	`__n⁄nuŒ
 ((1)Ë
__wur
;

758 #i‚de‡
__USE_FILE_OFFSET64


759 
	$mko°emps
 (*
__ãm∂©e
, 
__suffixÀn
, 
__Êags
)

760 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

762 #ifde‡
__REDIRECT


763 
	`__REDIRECT
 (
mko°emps
, (*
__ãm∂©e
, 
__suffixÀn
,

764 
__Êags
), 
mko°emps64
)

765 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

767 
	#mko°emps
 
mko°emps64


	)

770 #ifde‡
__USE_LARGEFILE64


771 
	$mko°emps64
 (*
__ãm∂©e
, 
__suffixÀn
, 
__Êags
)

772 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

781 
	$sy°em
 (c⁄° *
__comm™d
Ë
__wur
;

784 #ifdef 
__USE_GNU


787 *
	$ˇn⁄iˇlize_fûe_«me
 (c⁄° *
__«me
)

788 
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

791 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_XOPEN_EXTENDED


797 *
	$ªÆ∑th
 (c⁄° *
__ª°ri˘
 
__«me
,

798 *
__ª°ri˘
 
__ªsﬁved
Ë
__THROW
 
__wur
;

803 #i‚de‡
__COMPAR_FN_T


804 
	#__COMPAR_FN_T


	)

805 (*
	t__com∑r_‚_t
) (const *, const *);

807 #ifdef 
__USE_GNU


808 
__com∑r_‚_t
 
	tcom∑ris⁄_‚_t
;

811 #ifde‡
__USE_GNU


812 (*
	t__com∑r_d_‚_t
) (const *, const *, *);

817 *
	$b£¨ch
 (c⁄° *
__key
, c⁄° *
__ba£
,

818 
size_t
 
__nmemb
, size_à
__size
, 
__com∑r_‚_t
 
__com∑r
)

819 
	`__n⁄nuŒ
 ((1, 2, 5)Ë
__wur
;

821 #ifde‡
__USE_EXTERN_INLINES


822 
	~<bôs/°dlib-b£¨ch.h
>

827 
	$qs‹t
 (*
__ba£
, 
size_t
 
__nmemb
, size_à
__size
,

828 
__com∑r_‚_t
 
__com∑r
Ë
	`__n⁄nuŒ
 ((1, 4));

829 #ifde‡
__USE_GNU


830 
	$qs‹t_r
 (*
__ba£
, 
size_t
 
__nmemb
, size_à
__size
,

831 
__com∑r_d_‚_t
 
__com∑r
, *
__¨g
)

832 
	`__n⁄nuŒ
 ((1, 4));

837 
	$abs
 (
__x
Ë
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
)Ë
__wur
;

838 
	$œbs
 (
__x
Ë
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
)Ë
__wur
;

840 #ifde‡
__USE_ISOC99


841 
__exãnsi⁄__
 
	$Œabs
 (
__x
)

842 
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
)Ë
__wur
;

849 
div_t
 
	$div
 (
__numî
, 
__díom
)

850 
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
)Ë
__wur
;

851 
ldiv_t
 
	$ldiv
 (
__numî
, 
__díom
)

852 
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
)Ë
__wur
;

854 #ifde‡
__USE_ISOC99


855 
__exãnsi⁄__
 
Œdiv_t
 
	$Œdiv
 (
__numî
,

856 
__díom
)

857 
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
)Ë
__wur
;

861 #i‡(
deföed
 
__USE_XOPEN_EXTENDED
 && !deföed 
__USE_XOPEN2K8
) \

862 || 
deföed
 
__USE_MISC


869 *
	$ecvt
 (
__vÆue
, 
__ndigô
, *
__ª°ri˘
 
__de˝t
,

870 *
__ª°ri˘
 
__sign
Ë
__THROW
 
	`__n⁄nuŒ
 ((3, 4)Ë
__wur
;

875 *
	$fcvt
 (
__vÆue
, 
__ndigô
, *
__ª°ri˘
 
__de˝t
,

876 *
__ª°ri˘
 
__sign
Ë
__THROW
 
	`__n⁄nuŒ
 ((3, 4)Ë
__wur
;

881 *
	$gcvt
 (
__vÆue
, 
__ndigô
, *
__buf
)

882 
__THROW
 
	`__n⁄nuŒ
 ((3)Ë
__wur
;

885 #ifde‡
__USE_MISC


887 *
	$qecvt
 (
__vÆue
, 
__ndigô
,

888 *
__ª°ri˘
 
__de˝t
, *__ª°ri˘ 
__sign
)

889 
__THROW
 
	`__n⁄nuŒ
 ((3, 4)Ë
__wur
;

890 *
	$qfcvt
 (
__vÆue
, 
__ndigô
,

891 *
__ª°ri˘
 
__de˝t
, *__ª°ri˘ 
__sign
)

892 
__THROW
 
	`__n⁄nuŒ
 ((3, 4)Ë
__wur
;

893 *
	$qgcvt
 (
__vÆue
, 
__ndigô
, *
__buf
)

894 
__THROW
 
	`__n⁄nuŒ
 ((3)Ë
__wur
;

899 
	$ecvt_r
 (
__vÆue
, 
__ndigô
, *
__ª°ri˘
 
__de˝t
,

900 *
__ª°ri˘
 
__sign
, *__ª°ri˘ 
__buf
,

901 
size_t
 
__Àn
Ë
__THROW
 
	`__n⁄nuŒ
 ((3, 4, 5));

902 
	$fcvt_r
 (
__vÆue
, 
__ndigô
, *
__ª°ri˘
 
__de˝t
,

903 *
__ª°ri˘
 
__sign
, *__ª°ri˘ 
__buf
,

904 
size_t
 
__Àn
Ë
__THROW
 
	`__n⁄nuŒ
 ((3, 4, 5));

906 
	$qecvt_r
 (
__vÆue
, 
__ndigô
,

907 *
__ª°ri˘
 
__de˝t
, *__ª°ri˘ 
__sign
,

908 *
__ª°ri˘
 
__buf
, 
size_t
 
__Àn
)

909 
__THROW
 
	`__n⁄nuŒ
 ((3, 4, 5));

910 
	$qfcvt_r
 (
__vÆue
, 
__ndigô
,

911 *
__ª°ri˘
 
__de˝t
, *__ª°ri˘ 
__sign
,

912 *
__ª°ri˘
 
__buf
, 
size_t
 
__Àn
)

913 
__THROW
 
	`__n⁄nuŒ
 ((3, 4, 5));

919 
	$mbÀn
 (c⁄° *
__s
, 
size_t
 
__n
Ë
__THROW
;

922 
	$mbtowc
 (
wch¨_t
 *
__ª°ri˘
 
__pwc
,

923 c⁄° *
__ª°ri˘
 
__s
, 
size_t
 
__n
Ë
__THROW
;

926 
	$w˘omb
 (*
__s
, 
wch¨_t
 
__wch¨
Ë
__THROW
;

930 
size_t
 
	$mb°owcs
 (
wch¨_t
 *
__ª°ri˘
 
__pwcs
,

931 c⁄° *
__ª°ri˘
 
__s
, 
size_t
 
__n
Ë
__THROW
;

933 
size_t
 
	$wc°ombs
 (*
__ª°ri˘
 
__s
,

934 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__pwcs
, 
size_t
 
__n
)

935 
__THROW
;

938 #ifde‡
__USE_MISC


943 
	$Ωm©ch
 (c⁄° *
__ª•⁄£
Ë
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

947 #i‡
deföed
 
__USE_XOPEN_EXTENDED
 || deföed 
__USE_XOPEN2K8


954 
	$gësub›t
 (**
__ª°ri˘
 
__›ti⁄p
,

955 *c⁄° *
__ª°ri˘
 
__tokís
,

956 **
__ª°ri˘
 
__vÆuï
)

957 
__THROW
 
	`__n⁄nuŒ
 ((1, 2, 3)Ë
__wur
;

961 #ifde‡
__USE_XOPEN


963 
	$£tkey
 (c⁄° *
__key
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

969 #ifde‡
__USE_XOPEN2KXSI


971 
	$posix_›í±
 (
__oÊag
Ë
__wur
;

974 #ifde‡
__USE_XOPEN_EXTENDED


979 
	$gø¡±
 (
__fd
Ë
__THROW
;

983 
	$u∆ock±
 (
__fd
Ë
__THROW
;

988 *
	$±¢ame
 (
__fd
Ë
__THROW
 
__wur
;

991 #ifde‡
__USE_GNU


995 
	$±¢ame_r
 (
__fd
, *
__buf
, 
size_t
 
__buÊí
)

996 
__THROW
 
	`__n⁄nuŒ
 ((2));

999 
	`gë±
 ();

1002 #ifde‡
__USE_MISC


1006 
	$gëlﬂdavg
 (
__lﬂdavg
[], 
__√Àm
)

1007 
__THROW
 
	`__n⁄nuŒ
 ((1));

1010 #i‡
deföed
 
__USE_XOPEN_EXTENDED
 && !deföed 
__USE_XOPEN2K


1013 
	$ây¶Ÿ
 (Ë
__THROW
;

1016 
	~<bôs/°dlib-Êﬂt.h
>

1019 #i‡
__USE_FORTIFY_LEVEL
 > 0 && 
deföed
 
__f‹tify_fun˘i⁄


1020 
	~<bôs/°dlib.h
>

1022 #ifde‡
__LDBL_COMPAT


1023 
	~<bôs/°dlib-ldbl.h
>

1026 
__END_DECLS


	@/usr/include/string.h

22 #i‚def 
_STRING_H


23 
	#_STRING_H
 1

	)

25 
	#__GLIBC_INTERNAL_STARTING_HEADER_IMPLEMENTATION


	)

26 
	~<bôs/libc-hódî-°¨t.h
>

28 
	g__BEGIN_DECLS


31 
	#__√ed_size_t


	)

32 
	#__√ed_NULL


	)

33 
	~<°ddef.h
>

36 #i‡
deföed
 
__˝lu•lus
 && 
__GNUC_PREREQ
 (4, 4)

37 
	#__CORRECT_ISO_CPP_STRING_H_PROTO


	)

42 *
	$mem˝y
 (*
__ª°ri˘
 
__de°
, c⁄° *__ª°ri˘ 
__§c
,

43 
size_t
 
__n
Ë
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

46 *
	$memmove
 (*
__de°
, c⁄° *
__§c
, 
size_t
 
__n
)

47 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

52 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_XOPEN


53 *
	$memc˝y
 (*
__ª°ri˘
 
__de°
, c⁄° *__ª°ri˘ 
__§c
,

54 
__c
, 
size_t
 
__n
)

55 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

60 *
	$mem£t
 (*
__s
, 
__c
, 
size_t
 
__n
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

63 
	$memcmp
 (c⁄° *
__s1
, c⁄° *
__s2
, 
size_t
 
__n
)

64 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

67 #ifde‡
__CORRECT_ISO_CPP_STRING_H_PROTO


70 *
	`memchr
 (*
__s
, 
__c
, 
size_t
 
__n
)

71 
__THROW
 
	`__asm
 ("memchr"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

72 c⁄° *
	`memchr
 (c⁄° *
__s
, 
__c
, 
size_t
 
__n
)

73 
__THROW
 
	`__asm
 ("memchr"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

75 #ifde‡
__OPTIMIZE__


76 
__exã∫_Æways_ölöe
 *

77 
	`memchr
 (*
__s
, 
__c
, 
size_t
 
__n
Ë
__THROW


79  
	`__buûtö_memchr
 (
__s
, 
__c
, 
__n
);

82 
__exã∫_Æways_ölöe
 const *

83 
	`memchr
 (c⁄° *
__s
, 
__c
, 
size_t
 
__n
Ë
__THROW


85  
	`__buûtö_memchr
 (
__s
, 
__c
, 
__n
);

88 
	}
}

90 *
	$memchr
 (c⁄° *
__s
, 
__c
, 
size_t
 
__n
)

91 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

94 #ifde‡
__USE_GNU


97 #ifde‡
__CORRECT_ISO_CPP_STRING_H_PROTO


98 "C++" *
	$øwmemchr
 (*
__s
, 
__c
)

99 
__THROW
 
	`__asm
 ("øwmemchr"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

100 "C++" c⁄° *
	$øwmemchr
 (c⁄° *
__s
, 
__c
)

101 
__THROW
 
	`__asm
 ("øwmemchr"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

103 *
	$øwmemchr
 (c⁄° *
__s
, 
__c
)

104 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

108 #ifde‡
__CORRECT_ISO_CPP_STRING_H_PROTO


109 "C++" *
	$memrchr
 (*
__s
, 
__c
, 
size_t
 
__n
)

110 
__THROW
 
	`__asm
 ("memrchr"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

111 "C++" c⁄° *
	$memrchr
 (c⁄° *
__s
, 
__c
, 
size_t
 
__n
)

112 
__THROW
 
	`__asm
 ("memrchr"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

114 *
	$memrchr
 (c⁄° *
__s
, 
__c
, 
size_t
 
__n
)

115 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

121 *
	$°r˝y
 (*
__ª°ri˘
 
__de°
, c⁄° *__ª°ri˘ 
__§c
)

122 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

124 *
	$°∫˝y
 (*
__ª°ri˘
 
__de°
,

125 c⁄° *
__ª°ri˘
 
__§c
, 
size_t
 
__n
)

126 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

129 *
	$°rˇt
 (*
__ª°ri˘
 
__de°
, c⁄° *__ª°ri˘ 
__§c
)

130 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

132 *
	$°∫ˇt
 (*
__ª°ri˘
 
__de°
, c⁄° *__ª°ri˘ 
__§c
,

133 
size_t
 
__n
Ë
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

136 
	$°rcmp
 (c⁄° *
__s1
, c⁄° *
__s2
)

137 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

139 
	$°∫cmp
 (c⁄° *
__s1
, c⁄° *
__s2
, 
size_t
 
__n
)

140 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

143 
	$°rcﬁl
 (c⁄° *
__s1
, c⁄° *
__s2
)

144 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

146 
size_t
 
	$°rx‰m
 (*
__ª°ri˘
 
__de°
,

147 c⁄° *
__ª°ri˘
 
__§c
, 
size_t
 
__n
)

148 
__THROW
 
	`__n⁄nuŒ
 ((2));

150 #ifde‡
__USE_XOPEN2K8


152 
	~<bôs/ty≥s/loˇÀ_t.h
>

155 
	$°rcﬁl_l
 (c⁄° *
__s1
, c⁄° *
__s2
, 
loˇÀ_t
 
__l
)

156 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2, 3));

159 
size_t
 
	$°rx‰m_l
 (*
__de°
, c⁄° *
__§c
, 
size_t
 
__n
,

160 
loˇÀ_t
 
__l
Ë
__THROW
 
	`__n⁄nuŒ
 ((2, 4));

163 #i‡(
deföed
 
__USE_XOPEN_EXTENDED
 || deföed 
__USE_XOPEN2K8
 \

164 || 
	$__GLIBC_USE
 (
LIB_EXT2
))

166 *
	$°rdup
 (c⁄° *
__s
)

167 
__THROW
 
__©åibuã_mÆloc__
 
	`__n⁄nuŒ
 ((1));

173 #i‡
deföed
 
__USE_XOPEN2K8
 || 
	`__GLIBC_USE
 (
LIB_EXT2
)

174 *
	$°∫dup
 (c⁄° *
__°rög
, 
size_t
 
__n
)

175 
__THROW
 
__©åibuã_mÆloc__
 
	`__n⁄nuŒ
 ((1));

178 #i‡
deföed
 
__USE_GNU
 && deföed 
__GNUC__


180 
	#°rdu∑
(
s
) \

181 (
__exãnsi⁄__
 \

183 c⁄° *
__ﬁd
 = (
s
); \

184 
size_t
 
__Àn
 = 
	`°æí
 (
__ﬁd
) + 1; \

185 *
__√w
 = (*Ë
	`__buûtö_Æloˇ
 (
__Àn
); \

186 (*Ë
	`mem˝y
 (
__√w
, 
__ﬁd
, 
__Àn
); \

187 
	}
}))

	)

190 
	#°∫du∑
(
s
, 
n
) \

191 (
__exãnsi⁄__
 \

193 c⁄° *
__ﬁd
 = (
s
); \

194 
size_t
 
__Àn
 = 
	`°∫Àn
 (
__ﬁd
, (
n
)); \

195 *
__√w
 = (*Ë
	`__buûtö_Æloˇ
 (
__Àn
 + 1); \

196 
__√w
[
__Àn
] = '\0'; \

197 (*Ë
	`mem˝y
 (
__√w
, 
__ﬁd
, 
__Àn
); \

198 }))

	)

202 #ifde‡
__CORRECT_ISO_CPP_STRING_H_PROTO


205 *
°rchr
 (*
__s
, 
__c
)

206 
__THROW
 
__asm
 ("°rchr"Ë
__©åibuã_puª__
 
__n⁄nuŒ
 ((1));

207 c⁄° *
°rchr
 (c⁄° *
__s
, 
__c
)

208 
__THROW
 
__asm
 ("°rchr"Ë
__©åibuã_puª__
 
__n⁄nuŒ
 ((1));

210 #ifde‡
__OPTIMIZE__


211 
__exã∫_Æways_ölöe
 *

212 
°rchr
 (*
__s
, 
__c
Ë
	g__THROW


214  
__buûtö_°rchr
 (
__s
, 
__c
);

217 
__exã∫_Æways_ölöe
 const *

218 
°rchr
 (c⁄° *
__s
, 
__c
Ë
	g__THROW


220  
__buûtö_°rchr
 (
__s
, 
__c
);

225 *
	$°rchr
 (c⁄° *
__s
, 
__c
)

226 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

229 #ifde‡
__CORRECT_ISO_CPP_STRING_H_PROTO


232 *
	`°ºchr
 (*
__s
, 
__c
)

233 
__THROW
 
	`__asm
 ("°ºchr"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

234 c⁄° *
	`°ºchr
 (c⁄° *
__s
, 
__c
)

235 
__THROW
 
	`__asm
 ("°ºchr"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

237 #ifde‡
__OPTIMIZE__


238 
__exã∫_Æways_ölöe
 *

239 
	`°ºchr
 (*
__s
, 
__c
Ë
__THROW


241  
	`__buûtö_°ºchr
 (
__s
, 
__c
);

244 
__exã∫_Æways_ölöe
 const *

245 
	`°ºchr
 (c⁄° *
__s
, 
__c
Ë
__THROW


247  
	`__buûtö_°ºchr
 (
__s
, 
__c
);

250 
	}
}

252 *
	$°ºchr
 (c⁄° *
__s
, 
__c
)

253 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

256 #ifde‡
__USE_GNU


259 #ifde‡
__CORRECT_ISO_CPP_STRING_H_PROTO


260 "C++" *
	$°rch∫ul
 (*
__s
, 
__c
)

261 
__THROW
 
	`__asm
 ("°rch∫ul"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

262 "C++" c⁄° *
	$°rch∫ul
 (c⁄° *
__s
, 
__c
)

263 
__THROW
 
	`__asm
 ("°rch∫ul"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

265 *
	$°rch∫ul
 (c⁄° *
__s
, 
__c
)

266 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

272 
size_t
 
	$°rc•n
 (c⁄° *
__s
, c⁄° *
__ªje˘
)

273 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

276 
size_t
 
	$°r•n
 (c⁄° *
__s
, c⁄° *
__ac˚±
)

277 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

279 #ifde‡
__CORRECT_ISO_CPP_STRING_H_PROTO


282 *
	`°Ωbrk
 (*
__s
, c⁄° *
__ac˚±
)

283 
__THROW
 
	`__asm
 ("°Ωbrk"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

284 c⁄° *
	`°Ωbrk
 (c⁄° *
__s
, c⁄° *
__ac˚±
)

285 
__THROW
 
	`__asm
 ("°Ωbrk"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

287 #ifde‡
__OPTIMIZE__


288 
__exã∫_Æways_ölöe
 *

289 
	`°Ωbrk
 (*
__s
, c⁄° *
__ac˚±
Ë
__THROW


291  
	`__buûtö_°Ωbrk
 (
__s
, 
__ac˚±
);

294 
__exã∫_Æways_ölöe
 const *

295 
	`°Ωbrk
 (c⁄° *
__s
, c⁄° *
__ac˚±
Ë
__THROW


297  
	`__buûtö_°Ωbrk
 (
__s
, 
__ac˚±
);

300 
	}
}

302 *
	$°Ωbrk
 (c⁄° *
__s
, c⁄° *
__ac˚±
)

303 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

306 #ifde‡
__CORRECT_ISO_CPP_STRING_H_PROTO


309 *
	`°r°r
 (*
__hay°ack
, c⁄° *
__√edÀ
)

310 
__THROW
 
	`__asm
 ("°r°r"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

311 c⁄° *
	`°r°r
 (c⁄° *
__hay°ack
, c⁄° *
__√edÀ
)

312 
__THROW
 
	`__asm
 ("°r°r"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

314 #ifde‡
__OPTIMIZE__


315 
__exã∫_Æways_ölöe
 *

316 
	`°r°r
 (*
__hay°ack
, c⁄° *
__√edÀ
Ë
__THROW


318  
	`__buûtö_°r°r
 (
__hay°ack
, 
__√edÀ
);

321 
__exã∫_Æways_ölöe
 const *

322 
	`°r°r
 (c⁄° *
__hay°ack
, c⁄° *
__√edÀ
Ë
__THROW


324  
	`__buûtö_°r°r
 (
__hay°ack
, 
__√edÀ
);

327 
	}
}

329 *
	$°r°r
 (c⁄° *
__hay°ack
, c⁄° *
__√edÀ
)

330 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

335 *
	$°πok
 (*
__ª°ri˘
 
__s
, c⁄° *__ª°ri˘ 
__dñim
)

336 
__THROW
 
	`__n⁄nuŒ
 ((2));

340 *
	$__°πok_r
 (*
__ª°ri˘
 
__s
,

341 c⁄° *
__ª°ri˘
 
__dñim
,

342 **
__ª°ri˘
 
__ßve_±r
)

343 
__THROW
 
	`__n⁄nuŒ
 ((2, 3));

344 #ifde‡
__USE_POSIX


345 *
	$°πok_r
 (*
__ª°ri˘
 
__s
, c⁄° *__ª°ri˘ 
__dñim
,

346 **
__ª°ri˘
 
__ßve_±r
)

347 
__THROW
 
	`__n⁄nuŒ
 ((2, 3));

350 #ifde‡
__USE_GNU


352 #ifde‡
__CORRECT_ISO_CPP_STRING_H_PROTO


353 "C++" *
	$°rˇ£°r
 (*
__hay°ack
, c⁄° *
__√edÀ
)

354 
__THROW
 
	`__asm
 ("°rˇ£°r"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

355 "C++" c⁄° *
	$°rˇ£°r
 (c⁄° *
__hay°ack
,

356 c⁄° *
__√edÀ
)

357 
__THROW
 
	`__asm
 ("°rˇ£°r"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

359 *
	$°rˇ£°r
 (c⁄° *
__hay°ack
, c⁄° *
__√edÀ
)

360 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

364 #ifde‡
__USE_GNU


368 *
	$memmem
 (c⁄° *
__hay°ack
, 
size_t
 
__hay°ackÀn
,

369 c⁄° *
__√edÀ
, 
size_t
 
__√edÀÀn
)

370 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 3));

374 *
	$__memp˝y
 (*
__ª°ri˘
 
__de°
,

375 c⁄° *
__ª°ri˘
 
__§c
, 
size_t
 
__n
)

376 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

377 *
	$memp˝y
 (*
__ª°ri˘
 
__de°
,

378 c⁄° *
__ª°ri˘
 
__§c
, 
size_t
 
__n
)

379 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

384 
size_t
 
	$°æí
 (c⁄° *
__s
)

385 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

387 #ifdef 
__USE_XOPEN2K8


390 
size_t
 
	$°∫Àn
 (c⁄° *
__°rög
, 
size_t
 
__maxÀn
)

391 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

396 *
	$°ªº‹
 (
__î∫um
Ë
__THROW
;

397 #ifde‡
__USE_XOPEN2K


405 #i‡
deföed
 
__USE_XOPEN2K
 && !deföed 
__USE_GNU


408 #ifde‡
__REDIRECT_NTH


409 
	`__REDIRECT_NTH
 (
°ªº‹_r
,

410 (
__î∫um
, *
__buf
, 
size_t
 
__buÊí
),

411 
__xpg_°ªº‹_r
Ë
	`__n⁄nuŒ
 ((2));

413 
	$__xpg_°ªº‹_r
 (
__î∫um
, *
__buf
, 
size_t
 
__buÊí
)

414 
__THROW
 
	`__n⁄nuŒ
 ((2));

415 
	#°ªº‹_r
 
__xpg_°ªº‹_r


	)

420 *
	$°ªº‹_r
 (
__î∫um
, *
__buf
, 
size_t
 
__buÊí
)

421 
__THROW
 
	`__n⁄nuŒ
 ((2)Ë
__wur
;

425 #ifde‡
__USE_XOPEN2K8


427 *
	$°ªº‹_l
 (
__î∫um
, 
loˇÀ_t
 
__l
Ë
__THROW
;

430 #ifde‡
__USE_MISC


431 
	~<°rögs.h
>

435 
	$ex∂icô_bzîo
 (*
__s
, 
size_t
 
__n
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

439 *
	$°r£p
 (**
__ª°ri˘
 
__°rögp
,

440 c⁄° *
__ª°ri˘
 
__dñim
)

441 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

444 #ifdef 
__USE_XOPEN2K8


446 *
	$°rsig«l
 (
__sig
Ë
__THROW
;

449 *
	$__°p˝y
 (*
__ª°ri˘
 
__de°
, c⁄° *__ª°ri˘ 
__§c
)

450 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

451 *
	$°p˝y
 (*
__ª°ri˘
 
__de°
, c⁄° *__ª°ri˘ 
__§c
)

452 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

456 *
	$__°≤˝y
 (*
__ª°ri˘
 
__de°
,

457 c⁄° *
__ª°ri˘
 
__§c
, 
size_t
 
__n
)

458 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

459 *
	$°≤˝y
 (*
__ª°ri˘
 
__de°
,

460 c⁄° *
__ª°ri˘
 
__§c
, 
size_t
 
__n
)

461 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

464 #ifdef 
__USE_GNU


466 
	$°rvîscmp
 (c⁄° *
__s1
, c⁄° *
__s2
)

467 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

470 *
	$°r‰y
 (*
__°rög
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

473 *
	$mem‰ob
 (*
__s
, 
size_t
 
__n
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

475 #i‚de‡
ba£«me


480 #ifde‡
__CORRECT_ISO_CPP_STRING_H_PROTO


481 "C++" *
	$ba£«me
 (*
__fûíame
)

482 
__THROW
 
	`__asm
 ("ba£«me"Ë
	`__n⁄nuŒ
 ((1));

483 "C++" c⁄° *
	$ba£«me
 (c⁄° *
__fûíame
)

484 
__THROW
 
	`__asm
 ("ba£«me"Ë
	`__n⁄nuŒ
 ((1));

486 *
	$ba£«me
 (c⁄° *
__fûíame
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

491 #i‡
	`__GNUC_PREREQ
 (3,4)

492 #i‡
__USE_FORTIFY_LEVEL
 > 0 && 
deföed
 
__f‹tify_fun˘i⁄


494 
	~<bôs/°rög_f‹tifõd.h
>

498 
__END_DECLS


	@/usr/include/unistd.h

22 #i‚def 
_UNISTD_H


23 
	#_UNISTD_H
 1

	)

25 
	~<„©uªs.h
>

27 
	g__BEGIN_DECLS


32 #ifde‡
__USE_XOPEN2K8


34 
	#_POSIX_VERSION
 200809L

	)

35 #ñi‡
deföed
 
__USE_XOPEN2K


37 
	#_POSIX_VERSION
 200112L

	)

38 #ñi‡
deföed
 
__USE_POSIX199506


40 
	#_POSIX_VERSION
 199506L

	)

41 #ñi‡
deföed
 
__USE_POSIX199309


43 
	#_POSIX_VERSION
 199309L

	)

46 
	#_POSIX_VERSION
 199009L

	)

52 #ifde‡
__USE_XOPEN2K8


53 
	#__POSIX2_THIS_VERSION
 200809L

	)

55 #ñi‡
deföed
 
__USE_XOPEN2K


57 
	#__POSIX2_THIS_VERSION
 200112L

	)

58 #ñi‡
deföed
 
__USE_POSIX199506


60 
	#__POSIX2_THIS_VERSION
 199506L

	)

63 
	#__POSIX2_THIS_VERSION
 199209L

	)

67 
	#_POSIX2_VERSION
 
__POSIX2_THIS_VERSION


	)

70 
	#_POSIX2_C_VERSION
 
__POSIX2_THIS_VERSION


	)

74 
	#_POSIX2_C_BIND
 
__POSIX2_THIS_VERSION


	)

78 
	#_POSIX2_C_DEV
 
__POSIX2_THIS_VERSION


	)

82 
	#_POSIX2_SW_DEV
 
__POSIX2_THIS_VERSION


	)

86 
	#_POSIX2_LOCALEDEF
 
__POSIX2_THIS_VERSION


	)

89 #ifde‡
__USE_XOPEN2K8


90 
	#_XOPEN_VERSION
 700

	)

91 #ñi‡
deföed
 
__USE_XOPEN2K


92 
	#_XOPEN_VERSION
 600

	)

93 #ñi‡
deföed
 
__USE_UNIX98


94 
	#_XOPEN_VERSION
 500

	)

96 
	#_XOPEN_VERSION
 4

	)

100 
	#_XOPEN_XCU_VERSION
 4

	)

103 
	#_XOPEN_XPG2
 1

	)

104 
	#_XOPEN_XPG3
 1

	)

105 
	#_XOPEN_XPG4
 1

	)

108 
	#_XOPEN_UNIX
 1

	)

111 
	#_XOPEN_CRYPT
 1

	)

115 
	#_XOPEN_ENH_I18N
 1

	)

118 
	#_XOPEN_LEGACY
 1

	)

205 
	~<bôs/posix_›t.h
>

208 #i‡
deföed
 
__USE_UNIX98
 || deföed 
__USE_XOPEN2K


209 
	~<bôs/ívú⁄míts.h
>

213 
	#STDIN_FILENO
 0

	)

214 
	#STDOUT_FILENO
 1

	)

215 
	#STDERR_FILENO
 2

	)

220 
	~<bôs/ty≥s.h
>

222 #i‚def 
__ssize_t_deföed


223 
__ssize_t
 
	tssize_t
;

224 
	#__ssize_t_deföed


	)

227 
	#__√ed_size_t


	)

228 
	#__√ed_NULL


	)

229 
	~<°ddef.h
>

231 #i‡
deföed
 
__USE_XOPEN
 || deföed 
__USE_XOPEN2K


234 #i‚de‡
__gid_t_deföed


235 
__gid_t
 
	tgid_t
;

236 
	#__gid_t_deföed


	)

239 #i‚de‡
__uid_t_deföed


240 
__uid_t
 
	tuid_t
;

241 
	#__uid_t_deföed


	)

244 #i‚de‡
__off_t_deföed


245 #i‚de‡
__USE_FILE_OFFSET64


246 
__off_t
 
	toff_t
;

248 
__off64_t
 
	toff_t
;

250 
	#__off_t_deföed


	)

252 #i‡
deföed
 
__USE_LARGEFILE64
 && !deföed 
__off64_t_deföed


253 
__off64_t
 
	toff64_t
;

254 
	#__off64_t_deföed


	)

257 #i‚de‡
__u£c⁄ds_t_deföed


258 
__u£c⁄ds_t
 
	tu£c⁄ds_t
;

259 
	#__u£c⁄ds_t_deföed


	)

262 #i‚de‡
__pid_t_deföed


263 
__pid_t
 
	tpid_t
;

264 
	#__pid_t_deföed


	)

268 #i‡
deföed
 
__USE_XOPEN_EXTENDED
 || deföed 
__USE_XOPEN2K


269 #i‚de‡
__öçå_t_deföed


270 
__öçå_t
 
	töçå_t
;

271 
	#__öçå_t_deföed


	)

275 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_XOPEN


276 #i‚de‡
__sockÀn_t_deföed


277 
__sockÀn_t
 
	tsockÀn_t
;

278 
	#__sockÀn_t_deföed


	)

284 
	#R_OK
 4

	)

285 
	#W_OK
 2

	)

286 
	#X_OK
 1

	)

287 
	#F_OK
 0

	)

290 
	$ac˚ss
 (c⁄° *
__«me
, 
__ty≥
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

292 #ifde‡
__USE_GNU


295 
	$euidac˚ss
 (c⁄° *
__«me
, 
__ty≥
)

296 
__THROW
 
	`__n⁄nuŒ
 ((1));

299 
	$óc˚ss
 (c⁄° *
__«me
, 
__ty≥
)

300 
__THROW
 
	`__n⁄nuŒ
 ((1));

303 #ifde‡
__USE_ATFILE


307 
	$Ác˚sßt
 (
__fd
, c⁄° *
__fûe
, 
__ty≥
, 
__Êag
)

308 
__THROW
 
	`__n⁄nuŒ
 ((2)Ë
__wur
;

313 #i‚def 
_STDIO_H


314 
	#SEEK_SET
 0

	)

315 
	#SEEK_CUR
 1

	)

316 
	#SEEK_END
 2

	)

317 #ifde‡
__USE_GNU


318 
	#SEEK_DATA
 3

	)

319 
	#SEEK_HOLE
 4

	)

323 #i‡
deföed
 
__USE_MISC
 && !deföed 
L_SET


325 
	#L_SET
 
SEEK_SET


	)

326 
	#L_INCR
 
SEEK_CUR


	)

327 
	#L_XTND
 
SEEK_END


	)

336 #i‚de‡
__USE_FILE_OFFSET64


337 
__off_t
 
	$l£ek
 (
__fd
, 
__off_t
 
__off£t
, 
__whí˚
Ë
__THROW
;

339 #ifde‡
__REDIRECT_NTH


340 
__off64_t
 
	`__REDIRECT_NTH
 (
l£ek
,

341 (
__fd
, 
__off64_t
 
__off£t
, 
__whí˚
),

342 
l£ek64
);

344 
	#l£ek
 
l£ek64


	)

347 #ifde‡
__USE_LARGEFILE64


348 
__off64_t
 
	$l£ek64
 (
__fd
, 
__off64_t
 
__off£t
, 
__whí˚
)

349 
__THROW
;

356 
	`˛o£
 (
__fd
);

363 
ssize_t
 
	$ªad
 (
__fd
, *
__buf
, 
size_t
 
__nbyãs
Ë
__wur
;

369 
ssize_t
 
	$wrôe
 (
__fd
, c⁄° *
__buf
, 
size_t
 
__n
Ë
__wur
;

371 #i‡
deföed
 
__USE_UNIX98
 || deföed 
__USE_XOPEN2K8


372 #i‚de‡
__USE_FILE_OFFSET64


379 
ssize_t
 
	$¥ód
 (
__fd
, *
__buf
, 
size_t
 
__nbyãs
,

380 
__off_t
 
__off£t
Ë
__wur
;

387 
ssize_t
 
	$pwrôe
 (
__fd
, c⁄° *
__buf
, 
size_t
 
__n
,

388 
__off_t
 
__off£t
Ë
__wur
;

390 #ifde‡
__REDIRECT


391 
ssize_t
 
	`__REDIRECT
 (
¥ód
, (
__fd
, *
__buf
, 
size_t
 
__nbyãs
,

392 
__off64_t
 
__off£t
),

393 
¥ód64
Ë
__wur
;

394 
ssize_t
 
	`__REDIRECT
 (
pwrôe
, (
__fd
, c⁄° *
__buf
,

395 
size_t
 
__nbyãs
, 
__off64_t
 
__off£t
),

396 
pwrôe64
Ë
__wur
;

398 
	#¥ód
 
¥ód64


	)

399 
	#pwrôe
 
pwrôe64


	)

403 #ifde‡
__USE_LARGEFILE64


407 
ssize_t
 
	$¥ód64
 (
__fd
, *
__buf
, 
size_t
 
__nbyãs
,

408 
__off64_t
 
__off£t
Ë
__wur
;

411 
ssize_t
 
	$pwrôe64
 (
__fd
, c⁄° *
__buf
, 
size_t
 
__n
,

412 
__off64_t
 
__off£t
Ë
__wur
;

420 
	$pùe
 (
__pùedes
[2]Ë
__THROW
 
__wur
;

422 #ifde‡
__USE_GNU


425 
	$pùe2
 (
__pùedes
[2], 
__Êags
Ë
__THROW
 
__wur
;

435 
	$Æ¨m
 (
__£c⁄ds
Ë
__THROW
;

447 
	`¶ìp
 (
__£c⁄ds
);

449 #i‡(
deföed
 
__USE_XOPEN_EXTENDED
 && !deföed 
__USE_XOPEN2K8
) \

450 || 
deföed
 
__USE_MISC


455 
__u£c⁄ds_t
 
	$uÆ¨m
 (
__u£c⁄ds_t
 
__vÆue
, __u£c⁄ds_à
__öãrvÆ
)

456 
__THROW
;

463 
	`u¶ìp
 (
__u£c⁄ds_t
 
__u£c⁄ds
);

472 
	`∑u£
 ();

476 
	$chown
 (c⁄° *
__fûe
, 
__uid_t
 
__ow√r
, 
__gid_t
 
__group
)

477 
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

479 #i‡
deföed
 
__USE_XOPEN_EXTENDED
 || deföed 
__USE_XOPEN2K8


481 
	$fchown
 (
__fd
, 
__uid_t
 
__ow√r
, 
__gid_t
 
__group
Ë
__THROW
 
__wur
;

486 
	$lchown
 (c⁄° *
__fûe
, 
__uid_t
 
__ow√r
, 
__gid_t
 
__group
)

487 
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

491 #ifde‡
__USE_ATFILE


494 
	$fchow«t
 (
__fd
, c⁄° *
__fûe
, 
__uid_t
 
__ow√r
,

495 
__gid_t
 
__group
, 
__Êag
)

496 
__THROW
 
	`__n⁄nuŒ
 ((2)Ë
__wur
;

500 
	$chdú
 (c⁄° *
__∑th
Ë
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

502 #i‡
deföed
 
__USE_XOPEN_EXTENDED
 || deföed 
__USE_XOPEN2K8


504 
	$fchdú
 (
__fd
Ë
__THROW
 
__wur
;

514 *
	$gëcwd
 (*
__buf
, 
size_t
 
__size
Ë
__THROW
 
__wur
;

516 #ifdef 
__USE_GNU


520 *
	$gë_cuºít_dú_«me
 (Ë
__THROW
;

523 #i‡(
deföed
 
__USE_XOPEN_EXTENDED
 && !deföed 
__USE_XOPEN2K8
) \

524 || 
deföed
 
__USE_MISC


528 *
	$gëwd
 (*
__buf
)

529 
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__©åibuã_dïªˇãd__
 
__wur
;

534 
	$dup
 (
__fd
Ë
__THROW
 
__wur
;

537 
	$dup2
 (
__fd
, 
__fd2
Ë
__THROW
;

539 #ifde‡
__USE_GNU


542 
	$dup3
 (
__fd
, 
__fd2
, 
__Êags
Ë
__THROW
;

546 **
__ívú⁄
;

547 #ifde‡
__USE_GNU


548 **
ívú⁄
;

554 
	$execve
 (c⁄° *
__∑th
, *c⁄° 
__¨gv
[],

555 *c⁄° 
__ívp
[]Ë
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

557 #ifde‡
__USE_XOPEN2K8


560 
	$„xecve
 (
__fd
, *c⁄° 
__¨gv
[], *c⁄° 
__ívp
[])

561 
__THROW
 
	`__n⁄nuŒ
 ((2));

566 
	$execv
 (c⁄° *
__∑th
, *c⁄° 
__¨gv
[])

567 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

571 
	$exe˛e
 (c⁄° *
__∑th
, c⁄° *
__¨g
, ...)

572 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

576 
	$exe˛
 (c⁄° *
__∑th
, c⁄° *
__¨g
, ...)

577 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

581 
	$execvp
 (c⁄° *
__fûe
, *c⁄° 
__¨gv
[])

582 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

587 
	$exe˛p
 (c⁄° *
__fûe
, c⁄° *
__¨g
, ...)

588 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

590 #ifde‡
__USE_GNU


593 
	$execv≥
 (c⁄° *
__fûe
, *c⁄° 
__¨gv
[],

594 *c⁄° 
__ívp
[])

595 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

599 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_XOPEN


601 
	$ni˚
 (
__öc
Ë
__THROW
 
__wur
;

606 
	$_exô
 (
__°©us
Ë
	`__©åibuã__
 ((
__n‹ëu∫__
));

612 
	~<bôs/c⁄‚ame.h
>

615 
	$∑thc⁄f
 (c⁄° *
__∑th
, 
__«me
)

616 
__THROW
 
	`__n⁄nuŒ
 ((1));

619 
	$Â©hc⁄f
 (
__fd
, 
__«me
Ë
__THROW
;

622 
	$sysc⁄f
 (
__«me
Ë
__THROW
;

624 #ifdef 
__USE_POSIX2


626 
size_t
 
	$c⁄f°r
 (
__«me
, *
__buf
, 
size_t
 
__Àn
Ë
__THROW
;

631 
__pid_t
 
	$gëpid
 (Ë
__THROW
;

634 
__pid_t
 
	$gëµid
 (Ë
__THROW
;

637 
__pid_t
 
	$gëpgΩ
 (Ë
__THROW
;

640 
__pid_t
 
	$__gëpgid
 (
__pid_t
 
__pid
Ë
__THROW
;

641 #i‡
deföed
 
__USE_XOPEN_EXTENDED
 || deföed 
__USE_XOPEN2K8


642 
__pid_t
 
	$gëpgid
 (
__pid_t
 
__pid
Ë
__THROW
;

649 
	$£çgid
 (
__pid_t
 
__pid
, __pid_à
__pgid
Ë
__THROW
;

651 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_XOPEN_EXTENDED


663 
	$£çgΩ
 (Ë
__THROW
;

670 
__pid_t
 
	$£tsid
 (Ë
__THROW
;

672 #i‡
deföed
 
__USE_XOPEN_EXTENDED
 || deföed 
__USE_XOPEN2K8


674 
__pid_t
 
	$gësid
 (
__pid_t
 
__pid
Ë
__THROW
;

678 
__uid_t
 
	$gëuid
 (Ë
__THROW
;

681 
__uid_t
 
	$gëeuid
 (Ë
__THROW
;

684 
__gid_t
 
	$gëgid
 (Ë
__THROW
;

687 
__gid_t
 
	$gëegid
 (Ë
__THROW
;

692 
	$gëgroups
 (
__size
, 
__gid_t
 
__li°
[]Ë
__THROW
 
__wur
;

694 #ifdef 
__USE_GNU


696 
	$group_membî
 (
__gid_t
 
__gid
Ë
__THROW
;

703 
	$£tuid
 (
__uid_t
 
__uid
Ë
__THROW
 
__wur
;

705 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_XOPEN_EXTENDED


708 
	$£åeuid
 (
__uid_t
 
__ruid
, __uid_à
__euid
Ë
__THROW
 
__wur
;

711 #ifde‡
__USE_XOPEN2K


713 
	$£ãuid
 (
__uid_t
 
__uid
Ë
__THROW
 
__wur
;

720 
	$£tgid
 (
__gid_t
 
__gid
Ë
__THROW
 
__wur
;

722 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_XOPEN_EXTENDED


725 
	$£åegid
 (
__gid_t
 
__rgid
, __gid_à
__egid
Ë
__THROW
 
__wur
;

728 #ifde‡
__USE_XOPEN2K


730 
	$£ãgid
 (
__gid_t
 
__gid
Ë
__THROW
 
__wur
;

733 #ifde‡
__USE_GNU


736 
	$gëªsuid
 (
__uid_t
 *
__ruid
, __uid_à*
__euid
, __uid_à*
__suid
)

737 
__THROW
;

741 
	$gëªsgid
 (
__gid_t
 *
__rgid
, __gid_à*
__egid
, __gid_à*
__sgid
)

742 
__THROW
;

746 
	$£åesuid
 (
__uid_t
 
__ruid
, __uid_à
__euid
, __uid_à
__suid
)

747 
__THROW
 
__wur
;

751 
	$£åesgid
 (
__gid_t
 
__rgid
, __gid_à
__egid
, __gid_à
__sgid
)

752 
__THROW
 
__wur
;

759 
__pid_t
 
	$f‹k
 (Ë
__THROWNL
;

761 #i‡(
deföed
 
__USE_XOPEN_EXTENDED
 && !deföed 
__USE_XOPEN2K8
) \

762 || 
deföed
 
__USE_MISC


767 
__pid_t
 
	$vf‹k
 (Ë
__THROW
;

773 *
	$ây«me
 (
__fd
Ë
__THROW
;

777 
	$ây«me_r
 (
__fd
, *
__buf
, 
size_t
 
__buÊí
)

778 
__THROW
 
	`__n⁄nuŒ
 ((2)Ë
__wur
;

782 
	$ißây
 (
__fd
Ë
__THROW
;

784 #ifde‡
__USE_MISC


787 
	$ây¶Ÿ
 (Ë
__THROW
;

792 
	$lök
 (c⁄° *
__‰om
, c⁄° *
__to
)

793 
__THROW
 
	`__n⁄nuŒ
 ((1, 2)Ë
__wur
;

795 #ifde‡
__USE_ATFILE


798 
	$lök©
 (
__‰omfd
, c⁄° *
__‰om
, 
__tofd
,

799 c⁄° *
__to
, 
__Êags
)

800 
__THROW
 
	`__n⁄nuŒ
 ((2, 4)Ë
__wur
;

803 #i‡
deföed
 
__USE_XOPEN_EXTENDED
 || deföed 
__USE_XOPEN2K


805 
	$symlök
 (c⁄° *
__‰om
, c⁄° *
__to
)

806 
__THROW
 
	`__n⁄nuŒ
 ((1, 2)Ë
__wur
;

811 
ssize_t
 
	$ªadlök
 (c⁄° *
__ª°ri˘
 
__∑th
,

812 *
__ª°ri˘
 
__buf
, 
size_t
 
__Àn
)

813 
__THROW
 
	`__n⁄nuŒ
 ((1, 2)Ë
__wur
;

816 #ifde‡
__USE_ATFILE


818 
	$symlök©
 (c⁄° *
__‰om
, 
__tofd
,

819 c⁄° *
__to
Ë
__THROW
 
	`__n⁄nuŒ
 ((1, 3)Ë
__wur
;

822 
ssize_t
 
	$ªadlök©
 (
__fd
, c⁄° *
__ª°ri˘
 
__∑th
,

823 *
__ª°ri˘
 
__buf
, 
size_t
 
__Àn
)

824 
__THROW
 
	`__n⁄nuŒ
 ((2, 3)Ë
__wur
;

828 
	$u∆ök
 (c⁄° *
__«me
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

830 #ifde‡
__USE_ATFILE


832 
	$u∆ök©
 (
__fd
, c⁄° *
__«me
, 
__Êag
)

833 
__THROW
 
	`__n⁄nuŒ
 ((2));

837 
	$rmdú
 (c⁄° *
__∑th
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

841 
__pid_t
 
	$tcgëpgΩ
 (
__fd
Ë
__THROW
;

844 
	$tc£çgΩ
 (
__fd
, 
__pid_t
 
__pgΩ_id
Ë
__THROW
;

851 *
	`gëlogö
 ();

852 #ifde‡
__USE_POSIX199506


859 
	$gëlogö_r
 (*
__«me
, 
size_t
 
__«me_Àn
Ë
	`__n⁄nuŒ
 ((1));

862 #ifdef 
__USE_MISC


864 
	$£éogö
 (c⁄° *
__«me
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

868 #ifdef 
__USE_POSIX2


872 
	~<bôs/gë›t_posix.h
>

876 #i‡
deföed
 
__USE_XOPEN_EXTENDED
 || deföed 
__USE_XOPEN2K


880 
	$gëho°«me
 (*
__«me
, 
size_t
 
__Àn
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

884 #i‡
deföed
 
__USE_MISC


887 
	$£tho°«me
 (c⁄° *
__«me
, 
size_t
 
__Àn
)

888 
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

892 
	$£tho°id
 (
__id
Ë
__THROW
 
__wur
;

898 
	$gëdomaö«me
 (*
__«me
, 
size_t
 
__Àn
)

899 
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

900 
	$£tdomaö«me
 (c⁄° *
__«me
, 
size_t
 
__Àn
)

901 
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

907 
	$vh™gup
 (Ë
__THROW
;

910 
	$ªvoke
 (c⁄° *
__fûe
Ë
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

918 
	$¥ofû
 (*
__ßm∂e_buf„r
, 
size_t
 
__size
,

919 
size_t
 
__off£t
, 
__sˇÀ
)

920 
__THROW
 
	`__n⁄nuŒ
 ((1));

926 
	$ac˘
 (c⁄° *
__«me
Ë
__THROW
;

930 *
	$gëu£rshñl
 (Ë
__THROW
;

931 
	$ídu£rshñl
 (Ë
__THROW
;

932 
	$£tu£rshñl
 (Ë
__THROW
;

938 
	$d´m⁄
 (
__nochdú
, 
__no˛o£
Ë
__THROW
 
__wur
;

942 #i‡
deföed
 
__USE_MISC
 || (deföed 
__USE_XOPEN
 && !deföed 
__USE_XOPEN2K
)

945 
	$chroŸ
 (c⁄° *
__∑th
Ë
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

949 *
	$gë∑ss
 (c⁄° *
__¥om±
Ë
	`__n⁄nuŒ
 ((1));

957 
	`fsync
 (
__fd
);

960 #ifde‡
__USE_GNU


963 
	$syncfs
 (
__fd
Ë
__THROW
;

967 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_XOPEN_EXTENDED


970 
	`gëho°id
 ();

973 
	$sync
 (Ë
__THROW
;

976 #i‡
deföed
 
__USE_MISC
 || !deföed 
__USE_XOPEN2K


979 
	$gë∑gesize
 (Ë
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
));

984 
	$gëdèbÀsize
 (Ë
__THROW
;

990 #i‡
deföed
 
__USE_XOPEN_EXTENDED
 || deföed 
__USE_XOPEN2K8


993 #i‚de‡
__USE_FILE_OFFSET64


994 
	$åunˇã
 (c⁄° *
__fûe
, 
__off_t
 
__Àngth
)

995 
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

997 #ifde‡
__REDIRECT_NTH


998 
	`__REDIRECT_NTH
 (
åunˇã
,

999 (c⁄° *
__fûe
, 
__off64_t
 
__Àngth
),

1000 
åunˇã64
Ë
	`__n⁄nuŒ
 ((1)Ë
__wur
;

1002 
	#åunˇã
 
åunˇã64


	)

1005 #ifde‡
__USE_LARGEFILE64


1006 
	$åunˇã64
 (c⁄° *
__fûe
, 
__off64_t
 
__Àngth
)

1007 
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

1012 #i‡
deföed
 
__USE_POSIX199309
 \

1013 || 
deföed
 
__USE_XOPEN_EXTENDED
 || deföed 
__USE_XOPEN2K


1016 #i‚de‡
__USE_FILE_OFFSET64


1017 
	$·runˇã
 (
__fd
, 
__off_t
 
__Àngth
Ë
__THROW
 
__wur
;

1019 #ifde‡
__REDIRECT_NTH


1020 
	`__REDIRECT_NTH
 (
·runˇã
, (
__fd
, 
__off64_t
 
__Àngth
),

1021 
·runˇã64
Ë
__wur
;

1023 
	#·runˇã
 
·runˇã64


	)

1026 #ifde‡
__USE_LARGEFILE64


1027 
	$·runˇã64
 (
__fd
, 
__off64_t
 
__Àngth
Ë
__THROW
 
__wur
;

1033 #i‡(
deföed
 
__USE_XOPEN_EXTENDED
 && !deföed 
__USE_XOPEN2K
) \

1034 || 
deföed
 
__USE_MISC


1038 
	$brk
 (*
__addr
Ë
__THROW
 
__wur
;

1044 *
	$sbrk
 (
öçå_t
 
__dñè
Ë
__THROW
;

1048 #ifde‡
__USE_MISC


1059 
	$sysˇŒ
 (
__sy¢o
, ...Ë
__THROW
;

1064 #i‡(
deföed
 
__USE_MISC
 || deföed 
__USE_XOPEN_EXTENDED
Ë&& !deföed 
F_LOCK


1076 
	#F_ULOCK
 0

	)

1077 
	#F_LOCK
 1

	)

1078 
	#F_TLOCK
 2

	)

1079 
	#F_TEST
 3

	)

1081 #i‚de‡
__USE_FILE_OFFSET64


1082 
	$lockf
 (
__fd
, 
__cmd
, 
__off_t
 
__Àn
Ë
__wur
;

1084 #ifde‡
__REDIRECT


1085 
	`__REDIRECT
 (
lockf
, (
__fd
, 
__cmd
, 
__off64_t
 
__Àn
),

1086 
lockf64
Ë
__wur
;

1088 
	#lockf
 
lockf64


	)

1091 #ifde‡
__USE_LARGEFILE64


1092 
	$lockf64
 (
__fd
, 
__cmd
, 
__off64_t
 
__Àn
Ë
__wur
;

1097 #ifde‡
__USE_GNU


1102 
	#TEMP_FAILURE_RETRY
(
ex¥essi⁄
) \

1103 (
__exãnsi⁄__
 \

1104 ({ 
__ªsu…
; \

1105 dÿ
__ªsu…
 = (Ë(
ex¥essi⁄
); \

1106 
__ªsu…
 =-1L && 
î∫o
 =
EINTR
); \

1107 
__ªsu…
; 
	}
}))

	)

1110 
ssize_t
 
c›y_fûe_ønge
 (
__öfd
, 
__off64_t
 *
__pöoff
,

1111 
__outfd
, 
__off64_t
 *
__poutoff
,

1112 
size_t
 
__Àngth
, 
__Êags
);

1115 #i‡
deföed
 
__USE_POSIX199309
 || deföed 
__USE_UNIX98


1118 
fd©async
 (
__fûdes
);

1124 #ifdef 
__USE_XOPEN


1126 *
	$¸y±
 (c⁄° *
__key
, c⁄° *
__ß…
)

1127 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

1131 
	$í¸y±
 (*
__glibc_block
, 
__edÊag
)

1132 
__THROW
 
	`__n⁄nuŒ
 ((1));

1139 
	$swab
 (c⁄° *
__ª°ri˘
 
__‰om
, *__ª°ri˘ 
__to
,

1140 
ssize_t
 
__n
Ë
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

1147 #i‡
deföed
 
__USE_XOPEN
 && !deföed 
__USE_XOPEN2K


1149 *
	$˘îmid
 (*
__s
Ë
__THROW
;

1152 *
	`cu£rid
 (*
__s
);

1158 #i‡
deföed
 
__USE_UNIX98
 && !deföed 
__USE_XOPEN2K


1159 
	$±hªad_©f‹k
 ((*
__¥ï¨e
) (),

1160 (*
__∑ª¡
) (),

1161 (*
__chûd
Ë()Ë
__THROW
;

1164 #ifde‡
__USE_MISC


1167 
	$gëíå›y
 (*
__buf„r
, 
size_t
 
__Àngth
Ë
__wur
;

1171 #i‡
__USE_FORTIFY_LEVEL
 > 0 && 
deföed
 
__f‹tify_fun˘i⁄


1172 
	~<bôs/uni°d.h
>

1175 
__END_DECLS


	@/usr/include/alloca.h

18 #i‚def 
_ALLOCA_H


19 
	#_ALLOCA_H
 1

	)

21 
	~<„©uªs.h
>

23 
	#__√ed_size_t


	)

24 
	~<°ddef.h
>

26 
	g__BEGIN_DECLS


29 #unde‡
Æloˇ


32 *
	$Æloˇ
 (
size_t
 
__size
Ë
__THROW
;

34 #ifdef 
__GNUC__


35 
	#Æloˇ
(
size
Ë
	`__buûtö_Æloˇ
 (size)

	)

38 
__END_DECLS


	@/usr/include/features.h

18 #i‚def 
_FEATURES_H


19 
	#_FEATURES_H
 1

	)

119 #unde‡
__USE_ISOC11


120 #unde‡
__USE_ISOC99


121 #unde‡
__USE_ISOC95


122 #unde‡
__USE_ISOCXX11


123 #unde‡
__USE_POSIX


124 #unde‡
__USE_POSIX2


125 #unde‡
__USE_POSIX199309


126 #unde‡
__USE_POSIX199506


127 #unde‡
__USE_XOPEN


128 #unde‡
__USE_XOPEN_EXTENDED


129 #unde‡
__USE_UNIX98


130 #unde‡
__USE_XOPEN2K


131 #unde‡
__USE_XOPEN2KXSI


132 #unde‡
__USE_XOPEN2K8


133 #unde‡
__USE_XOPEN2K8XSI


134 #unde‡
__USE_LARGEFILE


135 #unde‡
__USE_LARGEFILE64


136 #unde‡
__USE_FILE_OFFSET64


137 #unde‡
__USE_MISC


138 #unde‡
__USE_ATFILE


139 #unde‡
__USE_GNU


140 #unde‡
__USE_FORTIFY_LEVEL


141 #unde‡
__KERNEL_STRICT_NAMES


142 #unde‡
__GLIBC_USE_DEPRECATED_GETS


146 #i‚de‡
_LOOSE_KERNEL_NAMES


147 
	#__KERNEL_STRICT_NAMES


	)

157 #i‡
deföed
 
__GNUC__
 && deföed 
__GNUC_MINOR__


158 
	#__GNUC_PREREQ
(
maj
, 
mö
) \

159 ((
__GNUC__
 << 16Ë+ 
__GNUC_MINOR__
 >((
maj
Ë<< 16Ë+ (
mö
))

	)

161 
	#__GNUC_PREREQ
(
maj
, 
mö
Ë0

	)

168 #i‡
deföed
 
__˛™g_maj‹__
 && deföed 
__˛™g_mö‹__


169 
	#__glibc_˛™g_¥îeq
(
maj
, 
mö
) \

170 ((
__˛™g_maj‹__
 << 16Ë+ 
__˛™g_mö‹__
 >((
maj
Ë<< 16Ë+ (
mö
))

	)

172 
	#__glibc_˛™g_¥îeq
(
maj
, 
mö
Ë0

	)

176 
	#__GLIBC_USE
(
F
Ë
__GLIBC_USE_
 ## 
	)
F

182 #i‡(
deföed
 
_BSD_SOURCE
 || deföed 
_SVID_SOURCE
) \

183 && !
deföed
 
	g_DEFAULT_SOURCE


185 #unde‡
_DEFAULT_SOURCE


186 
	#_DEFAULT_SOURCE
 1

	)

190 #ifde‡
_GNU_SOURCE


191 #unde‡
_ISOC95_SOURCE


192 
	#_ISOC95_SOURCE
 1

	)

193 #unde‡
_ISOC99_SOURCE


194 
	#_ISOC99_SOURCE
 1

	)

195 #unde‡
_ISOC11_SOURCE


196 
	#_ISOC11_SOURCE
 1

	)

197 #unde‡
_POSIX_SOURCE


198 
	#_POSIX_SOURCE
 1

	)

199 #unde‡
_POSIX_C_SOURCE


200 
	#_POSIX_C_SOURCE
 200809L

	)

201 #unde‡
_XOPEN_SOURCE


202 
	#_XOPEN_SOURCE
 700

	)

203 #unde‡
_XOPEN_SOURCE_EXTENDED


204 
	#_XOPEN_SOURCE_EXTENDED
 1

	)

205 #unde‡
_LARGEFILE64_SOURCE


206 
	#_LARGEFILE64_SOURCE
 1

	)

207 #unde‡
_DEFAULT_SOURCE


208 
	#_DEFAULT_SOURCE
 1

	)

209 #unde‡
_ATFILE_SOURCE


210 
	#_ATFILE_SOURCE
 1

	)

215 #i‡(
deföed
 
_DEFAULT_SOURCE
 \

216 || (!
deföed
 
	g__STRICT_ANSI__
 \

217 && !
deföed
 
	g_ISOC99_SOURCE
 \

218 && !
deföed
 
	g_POSIX_SOURCE
 && !deföed 
	g_POSIX_C_SOURCE
 \

219 && !
deföed
 
	g_XOPEN_SOURCE
))

220 #unde‡
_DEFAULT_SOURCE


221 
	#_DEFAULT_SOURCE
 1

	)

225 #i‡(
deföed
 
_ISOC11_SOURCE
 \

226 || (
deföed
 
	g__STDC_VERSION__
 && __STDC_VERSION__ >= 201112L))

227 
	#__USE_ISOC11
 1

	)

231 #i‡(
deföed
 
_ISOC99_SOURCE
 || deföed 
_ISOC11_SOURCE
 \

232 || (
deföed
 
__STDC_VERSION__
 && __STDC_VERSION__ >= 199901L))

233 
	#__USE_ISOC99
 1

	)

237 #i‡(
deföed
 
_ISOC99_SOURCE
 || deföed 
_ISOC11_SOURCE
 \

238 || (
deföed
 
__STDC_VERSION__
 && __STDC_VERSION__ >= 199409L))

239 
	#__USE_ISOC95
 1

	)

242 #ifde‡
__˝lu•lus


244 #i‡
__˝lu•lus
 >= 201703L

245 
	#__USE_ISOC11
 1

	)

249 #i‡
__˝lu•lus
 >201103L || 
deföed
 
__GXX_EXPERIMENTAL_CXX0X__


250 
	#__USE_ISOCXX11
 1

	)

251 
	#__USE_ISOC99
 1

	)

258 #ifde‡
_DEFAULT_SOURCE


259 #i‡!
deföed
 
_POSIX_SOURCE
 && !deföed 
_POSIX_C_SOURCE


260 
	#__USE_POSIX_IMPLICITLY
 1

	)

262 #unde‡
_POSIX_SOURCE


263 
	#_POSIX_SOURCE
 1

	)

264 #unde‡
_POSIX_C_SOURCE


265 
	#_POSIX_C_SOURCE
 200809L

	)

268 #i‡((!
deföed
 
__STRICT_ANSI__
 \

269 || (
deföed
 
_XOPEN_SOURCE
 && (_XOPEN_SOURCE - 0) >= 500)) \

270 && !
deföed
 
_POSIX_SOURCE
 && !deföed 
_POSIX_C_SOURCE
)

271 
	#_POSIX_SOURCE
 1

	)

272 #i‡
deföed
 
_XOPEN_SOURCE
 && (_XOPEN_SOURCE - 0) < 500

273 
	#_POSIX_C_SOURCE
 2

	)

274 #ñi‡
deföed
 
_XOPEN_SOURCE
 && (_XOPEN_SOURCE - 0) < 600

275 
	#_POSIX_C_SOURCE
 199506L

	)

276 #ñi‡
deföed
 
_XOPEN_SOURCE
 && (_XOPEN_SOURCE - 0) < 700

277 
	#_POSIX_C_SOURCE
 200112L

	)

279 
	#_POSIX_C_SOURCE
 200809L

	)

281 
	#__USE_POSIX_IMPLICITLY
 1

	)

290 #i‡((!
deföed
 
_POSIX_C_SOURCE
 || (_POSIX_C_SOURCE - 0) < 199506L) \

291 && (
deföed
 
_REENTRANT
 || deföed 
_THREAD_SAFE
))

292 
	#_POSIX_SOURCE
 1

	)

293 #unde‡
_POSIX_C_SOURCE


294 
	#_POSIX_C_SOURCE
 199506L

	)

297 #i‡(
deföed
 
_POSIX_SOURCE
 \

298 || (
deföed
 
_POSIX_C_SOURCE
 && _POSIX_C_SOURCE >= 1) \

299 || 
deföed
 
_XOPEN_SOURCE
)

300 
	#__USE_POSIX
 1

	)

303 #i‡
deföed
 
_POSIX_C_SOURCE
 && _POSIX_C_SOURCE >2 || deföed 
_XOPEN_SOURCE


304 
	#__USE_POSIX2
 1

	)

307 #i‡
deföed
 
_POSIX_C_SOURCE
 && (_POSIX_C_SOURCE - 0) >= 199309L

308 
	#__USE_POSIX199309
 1

	)

311 #i‡
deföed
 
_POSIX_C_SOURCE
 && (_POSIX_C_SOURCE - 0) >= 199506L

312 
	#__USE_POSIX199506
 1

	)

315 #i‡
deföed
 
_POSIX_C_SOURCE
 && (_POSIX_C_SOURCE - 0) >= 200112L

316 
	#__USE_XOPEN2K
 1

	)

317 #unde‡
__USE_ISOC95


318 
	#__USE_ISOC95
 1

	)

319 #unde‡
__USE_ISOC99


320 
	#__USE_ISOC99
 1

	)

323 #i‡
deföed
 
_POSIX_C_SOURCE
 && (_POSIX_C_SOURCE - 0) >= 200809L

324 
	#__USE_XOPEN2K8
 1

	)

325 #unde‡
_ATFILE_SOURCE


326 
	#_ATFILE_SOURCE
 1

	)

329 #ifdef 
_XOPEN_SOURCE


330 
	#__USE_XOPEN
 1

	)

331 #i‡(
_XOPEN_SOURCE
 - 0) >= 500

332 
	#__USE_XOPEN_EXTENDED
 1

	)

333 
	#__USE_UNIX98
 1

	)

334 #unde‡
_LARGEFILE_SOURCE


335 
	#_LARGEFILE_SOURCE
 1

	)

336 #i‡(
_XOPEN_SOURCE
 - 0) >= 600

337 #i‡(
_XOPEN_SOURCE
 - 0) >= 700

338 
	#__USE_XOPEN2K8
 1

	)

339 
	#__USE_XOPEN2K8XSI
 1

	)

341 
	#__USE_XOPEN2K
 1

	)

342 
	#__USE_XOPEN2KXSI
 1

	)

343 #unde‡
__USE_ISOC95


344 
	#__USE_ISOC95
 1

	)

345 #unde‡
__USE_ISOC99


346 
	#__USE_ISOC99
 1

	)

349 #ifde‡
_XOPEN_SOURCE_EXTENDED


350 
	#__USE_XOPEN_EXTENDED
 1

	)

355 #ifde‡
_LARGEFILE_SOURCE


356 
	#__USE_LARGEFILE
 1

	)

359 #ifde‡
_LARGEFILE64_SOURCE


360 
	#__USE_LARGEFILE64
 1

	)

363 #i‡
deföed
 
_FILE_OFFSET_BITS
 && _FILE_OFFSET_BITS == 64

364 
	#__USE_FILE_OFFSET64
 1

	)

367 #i‡
deföed
 
_DEFAULT_SOURCE


368 
	#__USE_MISC
 1

	)

371 #ifdef 
_ATFILE_SOURCE


372 
	#__USE_ATFILE
 1

	)

375 #ifdef 
_GNU_SOURCE


376 
	#__USE_GNU
 1

	)

379 #i‡
deföed
 
_FORTIFY_SOURCE
 && _FORTIFY_SOURCE > 0 \

380 && 
__GNUC_PREREQ
 (4, 1Ë&& 
deföed
 
	g__OPTIMIZE__
 && __OPTIMIZE__ > 0

381 #i‡
_FORTIFY_SOURCE
 > 1

382 
	#__USE_FORTIFY_LEVEL
 2

	)

384 
	#__USE_FORTIFY_LEVEL
 1

	)

387 
	#__USE_FORTIFY_LEVEL
 0

	)

394 #i‡
deföed
 
__˝lu•lus
 ? __˝lu•lu†>201402L : deföed 
__USE_ISOC11


395 
	#__GLIBC_USE_DEPRECATED_GETS
 0

	)

397 
	#__GLIBC_USE_DEPRECATED_GETS
 1

	)

402 
	~<°dc-¥edef.h
>

410 #unde‡
__GNU_LIBRARY__


411 
	#__GNU_LIBRARY__
 6

	)

415 
	#__GLIBC__
 2

	)

416 
	#__GLIBC_MINOR__
 27

	)

418 
	#__GLIBC_PREREQ
(
maj
, 
mö
) \

419 ((
__GLIBC__
 << 16Ë+ 
__GLIBC_MINOR__
 >((
maj
Ë<< 16Ë+ (
mö
))

	)

422 #i‚de‡
__ASSEMBLER__


423 #i‚de‡
_SYS_CDEFS_H


424 
	~<sys/cdefs.h
>

429 #i‡
deföed
 
__USE_FILE_OFFSET64
 && !deföed 
__REDIRECT


430 
	#__USE_LARGEFILE
 1

	)

431 
	#__USE_LARGEFILE64
 1

	)

437 #i‡
__GNUC_PREREQ
 (2, 7Ë&& 
deföed
 
__OPTIMIZE__
 \

438 && !
deföed
 
	g__OPTIMIZE_SIZE__
 && !deföed 
	g__NO_INLINE__
 \

439 && 
deföed
 
	g__exã∫_ölöe


440 
	#__USE_EXTERN_INLINES
 1

	)

448 
	~<gnu/°ubs.h
>

	@/usr/include/strings.h

18 #i‚def 
_STRINGS_H


19 
	#_STRINGS_H
 1

	)

21 
	~<„©uªs.h
>

22 
	#__√ed_size_t


	)

23 
	~<°ddef.h
>

26 #i‡
deföed
 
__˝lu•lus
 && 
__GNUC_PREREQ
 (4, 4)

27 
	#__CORRECT_ISO_CPP_STRINGS_H_PROTO


	)

30 
	g__BEGIN_DECLS


32 #i‡
deföed
 
__USE_MISC
 || !deföed 
__USE_XOPEN2K8


34 
	$bcmp
 (c⁄° *
__s1
, c⁄° *
__s2
, 
size_t
 
__n
)

35 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

38 
	$bc›y
 (c⁄° *
__§c
, *
__de°
, 
size_t
 
__n
)

39 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

42 
	$bzîo
 (*
__s
, 
size_t
 
__n
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

45 #ifde‡
__CORRECT_ISO_CPP_STRINGS_H_PROTO


48 *
	`ödex
 (*
__s
, 
__c
)

49 
__THROW
 
	`__asm
 ("ödex"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

50 c⁄° *
	`ödex
 (c⁄° *
__s
, 
__c
)

51 
__THROW
 
	`__asm
 ("ödex"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

53 #i‡
deföed
 
__OPTIMIZE__


54 
__exã∫_Æways_ölöe
 *

55 
	`ödex
 (*
__s
, 
__c
Ë
__THROW


57  
	`__buûtö_ödex
 (
__s
, 
__c
);

60 
__exã∫_Æways_ölöe
 const *

61 
	`ödex
 (c⁄° *
__s
, 
__c
Ë
__THROW


63  
	`__buûtö_ödex
 (
__s
, 
__c
);

66 
	}
}

68 *
	$ödex
 (c⁄° *
__s
, 
__c
)

69 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

73 #ifde‡
__CORRECT_ISO_CPP_STRINGS_H_PROTO


76 *
	`rödex
 (*
__s
, 
__c
)

77 
__THROW
 
	`__asm
 ("rödex"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

78 c⁄° *
	`rödex
 (c⁄° *
__s
, 
__c
)

79 
__THROW
 
	`__asm
 ("rödex"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

81 #i‡
deföed
 
__OPTIMIZE__


82 
__exã∫_Æways_ölöe
 *

83 
	`rödex
 (*
__s
, 
__c
Ë
__THROW


85  
	`__buûtö_rödex
 (
__s
, 
__c
);

88 
__exã∫_Æways_ölöe
 const *

89 
	`rödex
 (c⁄° *
__s
, 
__c
Ë
__THROW


91  
	`__buûtö_rödex
 (
__s
, 
__c
);

94 
	}
}

96 *
	$rödex
 (c⁄° *
__s
, 
__c
)

97 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

101 #i‡
deföed
 
__USE_MISC
 || !deföed 
__USE_XOPEN2K8
 || deföed 
__USE_XOPEN2K8XSI


104 
	$ffs
 (
__i
Ë
__THROW
 
__©åibuã_c⁄°__
;

109 #ifdef 
__USE_MISC


110 
	$ff¶
 (
__l
Ë
__THROW
 
__©åibuã_c⁄°__
;

111 
__exãnsi⁄__
 
	$ff¶l
 (
__Œ
)

112 
__THROW
 
__©åibuã_c⁄°__
;

116 
	$°rˇ£cmp
 (c⁄° *
__s1
, c⁄° *
__s2
)

117 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

120 
	$°∫ˇ£cmp
 (c⁄° *
__s1
, c⁄° *
__s2
, 
size_t
 
__n
)

121 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

123 #ifdef 
__USE_XOPEN2K8


125 
	~<bôs/ty≥s/loˇÀ_t.h
>

128 
	$°rˇ£cmp_l
 (c⁄° *
__s1
, c⁄° *
__s2
, 
loˇÀ_t
 
__loc
)

129 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2, 3));

133 
	$°∫ˇ£cmp_l
 (c⁄° *
__s1
, c⁄° *
__s2
,

134 
size_t
 
__n
, 
loˇÀ_t
 
__loc
)

135 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2, 4));

138 
__END_DECLS


140 #i‡
	`__GNUC_PREREQ
 (3,4Ë&& 
__USE_FORTIFY_LEVEL
 > 0 \

141 && 
deföed
 
__f‹tify_fun˘i⁄


143 #i‡
deföed
 
__USE_MISC
 || !deföed 
__USE_XOPEN2K8


144 
	~<bôs/°rögs_f‹tifõd.h
>

	@/usr/include/stdc-predef.h

18 #i‚def 
_STDC_PREDEF_H


19 
	#_STDC_PREDEF_H
 1

	)

36 #ifde‡
__GCC_IEC_559


37 #i‡
__GCC_IEC_559
 > 0

38 
	#__STDC_IEC_559__
 1

	)

41 
	#__STDC_IEC_559__
 1

	)

44 #ifde‡
__GCC_IEC_559_COMPLEX


45 #i‡
__GCC_IEC_559_COMPLEX
 > 0

46 
	#__STDC_IEC_559_COMPLEX__
 1

	)

49 
	#__STDC_IEC_559_COMPLEX__
 1

	)

58 
	#__STDC_ISO_10646__
 201706L

	)

61 
	#__STDC_NO_THREADS__
 1

	)

	@
1
.
1
/usr/include
62
618
asm.h
bio.c
bootmain.c
buf.h
console.c
date.h
defs.h
elf.h
exec.c
fcntl.h
file.c
file.h
fs.c
fs.h
ide.c
ioapic.c
kalloc.c
kbd.c
kbd.h
lapic.c
log.c
main.c
memide.c
memlayout.h
mkfs.c
mmu.h
mp.c
mp.h
param.h
picirq.c
pipe.c
printf.c
proc.c
proc.h
sleeplock.c
sleeplock.h
spinlock.c
spinlock.h
stat.h
string.c
syscall.c
syscall.h
sysfile.c
sysproc.c
trap.c
traps.h
types.h
uart.c
ulib.c
umalloc.c
user.h
vm.c
x86.h
/usr/include/assert.h
/usr/include/stdio.h
/usr/include/stdlib.h
/usr/include/string.h
/usr/include/unistd.h
/usr/include/alloca.h
/usr/include/features.h
/usr/include/strings.h
/usr/include/stdc-predef.h
